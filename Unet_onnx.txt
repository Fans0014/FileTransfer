Exported graph: graph(%in_1 : Float(1, 6, 128, 64, strides=[49152, 8192, 64, 1], requires_grad=0, device=cuda:0),
      %in_2 : Float(1, 6, 32, 16, strides=[3072, 512, 16, 1], requires_grad=0, device=cuda:0),
      %in_3 : Float(1, 6, 8, 4, strides=[192, 32, 4, 1], requires_grad=0, device=cuda:0),
      %t : Long(1, strides=[1], requires_grad=0, device=cuda:0),
      %cond : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=1, device=cuda:0),
      %msk : Long(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0),
      %temb_layer1.weight : Float(1024, 256, strides=[256, 1], requires_grad=1, device=cuda:0),
      %temb_layer1.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %temb_layer2.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %temb_layer2.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %cond_layers.scale.0.weight : Float(1024, 256, strides=[256, 1], requires_grad=1, device=cuda:0),
      %cond_layers.scale.0.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %cond_layers.scale.1.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %cond_layers.scale.1.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %conv_in.weight : Float(32, 6, 3, 3, strides=[54, 9, 3, 1], requires_grad=1, device=cuda:0),
      %conv_in.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %conv_out.weight : Float(3, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %conv_out.bias : Float(3, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.0.conv1.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.0.conv1.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.0.time_layer.weight : Float(64, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.0.time_layer.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.0.conv2.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.0.conv2.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.1.conv1.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.1.conv1.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.1.time_layer.weight : Float(64, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.1.time_layer.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.1.conv2.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resnets.1.conv2.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resample.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.0.resample.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.0.conv1.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.0.conv1.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.0.time_layer.weight : Float(64, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.0.time_layer.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.0.conv2.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.0.conv2.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.1.conv1.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.1.conv1.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.1.time_layer.weight : Float(64, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.1.time_layer.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.1.conv2.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resnets.1.conv2.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resample.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.1.resample.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.2.resnets.0.conv1.weight : Float(64, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.2.resnets.0.conv1.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.2.resnets.0.time_layer.weight : Float(128, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %down_blocks.2.resnets.0.time_layer.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.2.resnets.0.conv2.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %down_blocks.2.resnets.0.conv2.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %down_blocks.2.resnets.0.conv3.weight : Float(64, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=1, device=cuda:0),
      %down_blocks.2.resnets.0.conv3.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.0.conv1.weight : Float(64, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.0.conv1.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.0.time_layer.weight : Float(128, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.0.time_layer.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.0.conv2.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.0.conv2.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.0.conv3.weight : Float(64, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.0.conv3.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.1.conv1.weight : Float(64, 96, 3, 3, strides=[864, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.1.conv1.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.1.time_layer.weight : Float(128, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.1.time_layer.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.1.conv2.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.1.conv2.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.1.conv3.weight : Float(64, 96, 1, 1, strides=[96, 1, 1, 1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resnets.1.conv3.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resample.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.0.resample.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.0.conv1.weight : Float(32, 96, 3, 3, strides=[864, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.0.conv1.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.0.time_layer.weight : Float(64, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.0.time_layer.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.0.conv2.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.0.conv2.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.0.conv3.weight : Float(32, 96, 1, 1, strides=[96, 1, 1, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.0.conv3.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.1.conv1.weight : Float(32, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.1.conv1.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.1.time_layer.weight : Float(64, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.1.time_layer.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.1.conv2.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.1.conv2.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.1.conv3.weight : Float(32, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.1.conv3.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.2.conv1.weight : Float(32, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.2.conv1.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.2.time_layer.weight : Float(64, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.2.time_layer.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.2.conv2.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.2.conv2.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.2.conv3.weight : Float(32, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resnets.2.conv3.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resample.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.1.resample.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.0.conv1.weight : Float(32, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.0.conv1.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.0.time_layer.weight : Float(64, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.0.time_layer.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.0.conv2.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.0.conv2.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.0.conv3.weight : Float(32, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.0.conv3.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.1.conv1.weight : Float(32, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.1.conv1.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.1.time_layer.weight : Float(64, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.1.time_layer.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.1.conv2.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.1.conv2.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.1.conv3.weight : Float(32, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.1.conv3.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.2.conv1.weight : Float(32, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.2.conv1.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.2.time_layer.weight : Float(64, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.2.time_layer.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.2.conv2.weight : Float(32, 32, 3, 3, strides=[288, 9, 3, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.2.conv2.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.2.conv3.weight : Float(32, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=1, device=cuda:0),
      %up_blocks.2.resnets.2.conv3.bias : Float(32, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.temb_layer1.weight : Float(1024, 256, strides=[256, 1], requires_grad=1, device=cuda:0),
      %inner_unet.temb_layer1.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.temb_layer2.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.temb_layer2.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.cond_layers.scale.0.weight : Float(1024, 256, strides=[256, 1], requires_grad=1, device=cuda:0),
      %inner_unet.cond_layers.scale.0.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.cond_layers.scale.1.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.cond_layers.scale.1.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.conv_in.weight : Float(64, 6, 3, 3, strides=[54, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.conv_in.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.conv_out.weight : Float(3, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.conv_out.bias : Float(3, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.0.conv1.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.0.conv1.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.0.time_layer.weight : Float(128, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.0.time_layer.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.0.conv2.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.0.conv2.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.1.conv1.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.1.conv1.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.1.time_layer.weight : Float(128, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.1.time_layer.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.1.conv2.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resnets.1.conv2.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resample.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.0.resample.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.0.conv1.weight : Float(128, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.0.conv1.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.0.time_layer.weight : Float(256, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.0.time_layer.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.0.conv2.weight : Float(128, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.0.conv2.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.0.conv3.weight : Float(128, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.0.conv3.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.1.conv1.weight : Float(128, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.1.conv1.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.1.time_layer.weight : Float(256, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.1.time_layer.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.1.conv2.weight : Float(128, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resnets.1.conv2.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resample.weight : Float(128, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.1.resample.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.2.resnets.0.conv1.weight : Float(256, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.2.resnets.0.conv1.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.2.resnets.0.time_layer.weight : Float(512, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.2.resnets.0.time_layer.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.2.resnets.0.conv2.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.2.resnets.0.conv2.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.2.resnets.0.conv3.weight : Float(256, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.down_blocks.2.resnets.0.conv3.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.0.conv1.weight : Float(256, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.0.conv1.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.0.time_layer.weight : Float(512, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.0.time_layer.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.0.conv2.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.0.conv2.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.0.conv3.weight : Float(256, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.0.conv3.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.1.conv1.weight : Float(256, 384, 3, 3, strides=[3456, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.1.conv1.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.1.time_layer.weight : Float(512, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.1.time_layer.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.1.conv2.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.1.conv2.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.1.conv3.weight : Float(256, 384, 1, 1, strides=[384, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resnets.1.conv3.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resample.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.0.resample.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.0.conv1.weight : Float(128, 384, 3, 3, strides=[3456, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.0.conv1.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.0.time_layer.weight : Float(256, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.0.time_layer.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.0.conv2.weight : Float(128, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.0.conv2.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.0.conv3.weight : Float(128, 384, 1, 1, strides=[384, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.0.conv3.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.1.conv1.weight : Float(128, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.1.conv1.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.1.time_layer.weight : Float(256, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.1.time_layer.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.1.conv2.weight : Float(128, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.1.conv2.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.1.conv3.weight : Float(128, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.1.conv3.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.2.conv1.weight : Float(128, 192, 3, 3, strides=[1728, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.2.conv1.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.2.time_layer.weight : Float(256, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.2.time_layer.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.2.conv2.weight : Float(128, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.2.conv2.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.2.conv3.weight : Float(128, 192, 1, 1, strides=[192, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resnets.2.conv3.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resample.weight : Float(128, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.1.resample.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.0.conv1.weight : Float(64, 192, 3, 3, strides=[1728, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.0.conv1.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.0.time_layer.weight : Float(128, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.0.time_layer.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.0.conv2.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.0.conv2.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.0.conv3.weight : Float(64, 192, 1, 1, strides=[192, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.0.conv3.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.1.conv1.weight : Float(64, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.1.conv1.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.1.time_layer.weight : Float(128, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.1.time_layer.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.1.conv2.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.1.conv2.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.1.conv3.weight : Float(64, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.1.conv3.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.2.conv1.weight : Float(64, 128, 3, 3, strides=[1152, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.2.conv1.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.2.time_layer.weight : Float(128, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.2.time_layer.bias : Float(128, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.2.conv2.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.2.conv2.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.2.conv3.weight : Float(64, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.up_blocks.2.resnets.2.conv3.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.temb_layer1.weight : Float(1024, 256, strides=[256, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.temb_layer1.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.temb_layer2.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.temb_layer2.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.cond_layers.scale.0.weight : Float(1024, 256, strides=[256, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.cond_layers.scale.0.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.cond_layers.scale.1.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.cond_layers.scale.1.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.conv_in.weight : Float(256, 6, 3, 3, strides=[54, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.conv_in.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.conv_out.weight : Float(3, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.conv_out.bias : Float(3, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.0.conv1.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.0.conv1.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.0.time_layer.weight : Float(512, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.0.time_layer.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.0.conv2.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.0.conv2.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.1.conv1.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.1.conv1.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.1.time_layer.weight : Float(512, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.1.time_layer.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.1.conv2.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resnets.1.conv2.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resample.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.0.resample.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.0.conv1.weight : Float(512, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.0.conv1.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.0.time_layer.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.0.time_layer.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.0.conv2.weight : Float(512, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.0.conv2.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.0.conv3.weight : Float(512, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.0.conv3.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.1.conv1.weight : Float(512, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.1.conv1.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.1.time_layer.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.1.time_layer.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.1.conv2.weight : Float(512, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resnets.1.conv2.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.qkv.weight : Float(1536, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.qkv.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.kv_cond.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.proj_out.weight : Float(512, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.proj_out.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.ffn.1.weight : Float(2048, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.ffn.1.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.ffn.3.weight : Float(512, 2048, 1, 1, strides=[2048, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.0.ffn.3.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.qkv.weight : Float(1536, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.qkv.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.kv_cond.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.proj_out.weight : Float(512, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.proj_out.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.ffn.1.weight : Float(2048, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.ffn.1.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.ffn.3.weight : Float(512, 2048, 1, 1, strides=[2048, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.attn.1.ffn.3.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resample.weight : Float(512, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.1.resample.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.0.conv1.weight : Float(768, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.0.conv1.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.0.time_layer.weight : Float(1536, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.0.time_layer.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.0.conv2.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.0.conv2.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.0.conv3.weight : Float(768, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.0.conv3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.1.conv1.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.1.conv1.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.1.time_layer.weight : Float(1536, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.1.time_layer.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.1.conv2.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.resnets.1.conv2.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.0.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.1.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.2.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.3.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.4.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.5.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.6.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.7.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.8.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.down_blocks.2.attn.9.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.resnets.0.conv1.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.resnets.0.conv1.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.resnets.0.time_layer.weight : Float(1536, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.resnets.0.time_layer.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.resnets.0.conv2.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.resnets.0.conv2.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.0.attn.0.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.1.resnets.0.conv1.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.1.resnets.0.conv1.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.1.resnets.0.time_layer.weight : Float(1536, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.1.resnets.0.time_layer.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.1.resnets.0.conv2.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.mid_blocks.1.resnets.0.conv2.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.0.conv1.weight : Float(768, 1536, 3, 3, strides=[13824, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.0.conv1.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.0.time_layer.weight : Float(1536, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.0.time_layer.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.0.conv2.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.0.conv2.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.0.conv3.weight : Float(768, 1536, 1, 1, strides=[1536, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.0.conv3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.1.conv1.weight : Float(768, 1536, 3, 3, strides=[13824, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.1.conv1.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.1.time_layer.weight : Float(1536, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.1.time_layer.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.1.conv2.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.1.conv2.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.1.conv3.weight : Float(768, 1536, 1, 1, strides=[1536, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.1.conv3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.2.conv1.weight : Float(768, 1280, 3, 3, strides=[11520, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.2.conv1.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.2.time_layer.weight : Float(1536, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.2.time_layer.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.2.conv2.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.2.conv2.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.2.conv3.weight : Float(768, 1280, 1, 1, strides=[1280, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resnets.2.conv3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.0.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.1.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.2.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.3.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.4.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.5.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.6.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.7.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.8.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.9.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.10.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.11.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.12.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.13.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.qkv.weight : Float(2304, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.qkv.bias : Float(2304, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.kv_cond.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.proj_out.weight : Float(768, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.proj_out.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.ffn.1.weight : Float(3072, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.ffn.1.bias : Float(3072, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.ffn.3.weight : Float(768, 3072, 1, 1, strides=[3072, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.attn.14.ffn.3.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resample.weight : Float(768, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.0.resample.bias : Float(768, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.0.conv1.weight : Float(512, 1280, 3, 3, strides=[11520, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.0.conv1.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.0.time_layer.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.0.time_layer.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.0.conv2.weight : Float(512, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.0.conv2.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.0.conv3.weight : Float(512, 1280, 1, 1, strides=[1280, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.0.conv3.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.1.conv1.weight : Float(512, 1024, 3, 3, strides=[9216, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.1.conv1.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.1.time_layer.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.1.time_layer.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.1.conv2.weight : Float(512, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.1.conv2.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.1.conv3.weight : Float(512, 1024, 1, 1, strides=[1024, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.1.conv3.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.2.conv1.weight : Float(512, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.2.conv1.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.2.time_layer.weight : Float(1024, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.2.time_layer.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.2.conv2.weight : Float(512, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.2.conv2.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.2.conv3.weight : Float(512, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resnets.2.conv3.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.qkv.weight : Float(1536, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.qkv.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.kv_cond.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.proj_out.weight : Float(512, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.proj_out.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.ffn.1.weight : Float(2048, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.ffn.1.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.ffn.3.weight : Float(512, 2048, 1, 1, strides=[2048, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.0.ffn.3.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.qkv.weight : Float(1536, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.qkv.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.kv_cond.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.proj_out.weight : Float(512, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.proj_out.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.ffn.1.weight : Float(2048, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.ffn.1.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.ffn.3.weight : Float(512, 2048, 1, 1, strides=[2048, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.1.ffn.3.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.qkv.weight : Float(1536, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.qkv.bias : Float(1536, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.norm_cond.weight : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.norm_cond.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.kv_cond.bias : Float(1024, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.proj_out.weight : Float(512, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.proj_out.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.ffn.1.weight : Float(2048, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.ffn.1.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.ffn.3.weight : Float(512, 2048, 1, 1, strides=[2048, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.attn.2.ffn.3.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resample.weight : Float(512, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.1.resample.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.0.conv1.weight : Float(256, 768, 3, 3, strides=[6912, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.0.conv1.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.0.time_layer.weight : Float(512, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.0.time_layer.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.0.conv2.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.0.conv2.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.0.conv3.weight : Float(256, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.0.conv3.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.1.conv1.weight : Float(256, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.1.conv1.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.1.time_layer.weight : Float(512, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.1.time_layer.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.1.conv2.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.1.conv2.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.1.conv3.weight : Float(256, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.1.conv3.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.2.conv1.weight : Float(256, 512, 3, 3, strides=[4608, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.2.conv1.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.2.time_layer.weight : Float(512, 1024, strides=[1024, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.2.time_layer.bias : Float(512, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.2.conv2.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.2.conv2.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.2.conv3.weight : Float(256, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.up_blocks.2.resnets.2.conv3.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.inner_unet.lm_proj.bias : Float(2048, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.in_adapter.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.in_adapter.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %inner_unet.out_adapter.weight : Float(256, 256, 3, 3, strides=[2304, 9, 3, 1], requires_grad=1, device=cuda:0),
      %inner_unet.out_adapter.bias : Float(256, strides=[1], requires_grad=1, device=cuda:0),
      %in_adapter.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %in_adapter.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %out_adapter.weight : Float(64, 64, 3, 3, strides=[576, 9, 3, 1], requires_grad=1, device=cuda:0),
      %out_adapter.bias : Float(64, strides=[1], requires_grad=1, device=cuda:0),
      %onnx::MatMul_9216 : Float(2048, 2048, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9217 : Float(2048, 1024, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9224 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9225 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9226 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9227 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9228 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9229 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9230 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9231 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9232 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9233 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9234 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9235 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9236 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9237 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9238 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9239 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9240 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9241 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9242 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9243 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9250 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9251 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9252 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9253 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9254 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9255 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9256 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9257 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9258 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9259 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9260 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9261 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9262 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9263 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9264 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9265 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9266 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9267 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9268 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9269 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9272 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9273 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9274 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9275 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9276 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9277 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9278 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9279 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9280 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9281 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9282 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9283 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9284 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9285 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9318 : Float(2048, 1024, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9324 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9325 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9326 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9327 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9328 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9329 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9330 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9331 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9364 : Float(2048, 1024, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9370 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9371 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9372 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9373 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9374 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9375 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9376 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9377 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9410 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9416 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9417 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9418 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9419 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9452 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9458 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9459 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9460 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9461 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9494 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9500 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9501 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9502 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9503 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9536 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9542 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9543 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9544 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9545 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9578 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9584 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9585 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9586 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9587 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9588 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9589 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9590 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9591 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9624 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9630 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9631 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9632 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9633 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9666 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9672 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9673 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9674 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9675 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9708 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9714 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9715 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9716 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9717 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9750 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9756 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9757 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9758 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9759 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9792 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9798 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9799 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9800 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9801 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9802 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9803 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9804 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9805 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9838 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9844 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9845 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9846 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9847 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9848 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9849 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9850 : Float(1536, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9851 : Float(1536, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9852 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9853 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9854 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9855 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9888 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9894 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9895 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9896 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9897 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9930 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9936 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9937 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9938 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9939 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_9972 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_9978 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9979 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_9980 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_9981 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10014 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10020 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10021 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10022 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10023 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10056 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10062 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10063 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10064 : Float(1536, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10065 : Float(1536, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10066 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10067 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10068 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10069 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10102 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10108 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10109 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10110 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10111 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10144 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10150 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10151 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10152 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10153 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10186 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10192 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10193 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10194 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10195 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10228 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10234 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10235 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10236 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10237 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10270 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10276 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10277 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10278 : Float(1280, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10279 : Float(1280, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10280 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10281 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10282 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10283 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10316 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10322 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10323 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10324 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10325 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10358 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10364 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10365 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10366 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10367 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10400 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10406 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10407 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10408 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10409 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10442 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10448 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10449 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10450 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10451 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10484 : Float(2048, 1536, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10490 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10491 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10493 : Float(1280, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10494 : Float(1280, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10495 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10496 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10497 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10498 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10531 : Float(2048, 1024, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10537 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10538 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10539 : Float(1024, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10540 : Float(1024, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10541 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10542 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10543 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10544 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10577 : Float(2048, 1024, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10583 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10584 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10585 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10586 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10587 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10588 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10589 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10590 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::MatMul_10623 : Float(2048, 1024, strides=[1, 2048], requires_grad=0, device=cuda:0),
      %onnx::Mul_10629 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10630 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10632 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10633 : Float(768, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10634 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10635 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10636 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10637 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10638 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10639 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10640 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10641 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10642 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10643 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10644 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10645 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10646 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10647 : Float(512, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10648 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10649 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10650 : Float(384, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10651 : Float(384, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10652 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10653 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10655 : Float(384, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10656 : Float(384, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10657 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10658 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10659 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10660 : Float(256, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10661 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10662 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10663 : Float(192, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10664 : Float(192, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10665 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10666 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10668 : Float(192, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10669 : Float(192, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10670 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10671 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10672 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10673 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10674 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10675 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10676 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10677 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10678 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10679 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10680 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10681 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10682 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10683 : Float(128, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10684 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10685 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10686 : Float(96, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10687 : Float(96, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10688 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10689 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10691 : Float(96, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10692 : Float(96, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10693 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10694 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10695 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10696 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10697 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10698 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10699 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10700 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10701 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10702 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10704 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10705 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10706 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10707 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10708 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10709 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10710 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10711 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10712 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10713 : Float(64, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10714 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10715 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Mul_10716 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0),
      %onnx::Add_10717 : Float(32, 1, 1, strides=[1, 1, 1], requires_grad=0, device=cuda:0)):
  %/lm_proj/MatMul_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], device=cpu) = onnx::MatMul[onnx_name="/lm_proj/MatMul"](%cond, %onnx::MatMul_9216), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::lm_proj # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/lm_proj/Add_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/lm_proj/Add"](%inner_unet.inner_unet.lm_proj.bias, %/lm_proj/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::lm_proj # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:992:0
  %/Unsqueeze_output_0 : Long(1, 128, 1, strides=[128, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/Unsqueeze"](%msk, %/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:992:0
  %/Cast_output_0 : Float(1, 128, 1, strides=[128, 1, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast"](%/Unsqueeze_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:992:0
  %/Mul_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul"](%/Cast_output_0, %/lm_proj/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:992:0
  %onnx::ReduceSum_1077 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}]()
  %/ReduceSum_output_0 : Float(1, 2048, strides=[2048, 1], requires_grad=0, device=cuda:0) = onnx::ReduceSum[keepdims=0, onnx_name="/ReduceSum"](%/Mul_output_0, %onnx::ReduceSum_1077), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:992:0
  %/ReduceSum_1_output_0 : Long(1, 1, strides=[1, 1], requires_grad=0, device=cuda:0) = onnx::ReduceSum[keepdims=1, onnx_name="/ReduceSum_1"](%msk, %onnx::ReduceSum_1077), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:992:0
  %/Cast_1_output_0 : Float(1, 1, strides=[1, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast_1"](%/ReduceSum_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:992:0
  %/Div_output_0 : Float(1, 2048, strides=[2048, 1], requires_grad=0, device=cuda:0) = onnx::Div[onnx_name="/Div"](%/ReduceSum_output_0, %/Cast_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:992:0
  %/cond_emb/MatMul_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::MatMul[onnx_name="/cond_emb/MatMul"](%/Div_output_0, %onnx::MatMul_9217), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::cond_emb # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Constant_1_output_0 : Long(2, strides=[1], device=cpu) = onnx::Constant[value=-1  1 [ CPULongType{2} ], onnx_name="/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Reshape_output_0 : Long(1, 1, strides=[1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/Reshape"](%t, %/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Cast_2_output_0 : Float(1, 1, strides=[1, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast_2"](%/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Constant_2_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Constant[value=<Tensor>, onnx_name="/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Mul_1_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_1"](%/Cast_2_output_0, %/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Cast_3_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast_3"](%/Mul_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:947:0
  %/Sin_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Sin[onnx_name="/Sin"](%/Cast_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Cos_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Cos[onnx_name="/Cos"](%/Cast_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Concat_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/Concat"](%/Sin_output_0, %/Cos_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Cast_4_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast_4"](%/Concat_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:960:0
  %/temb_layer1/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/temb_layer1/Gemm"](%/Cast_4_output_0, %temb_layer1.weight, %temb_layer1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::temb_layer1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Sigmoid_output_0 : Float(1, 1024, strides=[1024, 1], device=cpu) = onnx::Sigmoid[onnx_name="/Sigmoid"](%/temb_layer1/Gemm_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/Mul_2_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_2"](%/temb_layer1/Gemm_output_0, %/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/temb_layer2/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/temb_layer2/Gemm"](%/Mul_2_output_0, %temb_layer2.weight, %temb_layer2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::temb_layer2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Add_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/Add"](%/temb_layer2/Gemm_output_0, %/cond_emb/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:175:0
  %/Constant_3_output_0 : Double(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Constant_4_output_0 : Double(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %onnx::Clip_1103 : Tensor? = prim::Constant(), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Clip_output_0 : Double(1, strides=[1], requires_grad=0, device=cuda:0) = onnx::Clip[onnx_name="/Clip"](%/Constant_3_output_0, %onnx::Clip_1103, %/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Constant_5_output_0 : Double(requires_grad=0, device=cpu) = onnx::Constant[value={1024}, onnx_name="/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Mul_3_output_0 : Double(1, strides=[1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_3"](%/Clip_output_0, %/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Constant_6_output_0 : Long(2, strides=[1], device=cpu) = onnx::Constant[value=-1  1 [ CPULongType{2} ], onnx_name="/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Reshape_1_output_0 : Double(1, 1, strides=[1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/Reshape_1"](%/Mul_3_output_0, %/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Constant_7_output_0 : Double(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Constant[value=<Tensor>, onnx_name="/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Mul_4_output_0 : Double(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_4"](%/Reshape_1_output_0, %/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Cast_5_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast_5"](%/Mul_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:947:0
  %/Sin_1_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Sin[onnx_name="/Sin_1"](%/Cast_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Cos_1_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Cos[onnx_name="/Cos_1"](%/Cast_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Concat_1_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/Concat_1"](%/Sin_1_output_0, %/Cos_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Cast_6_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast_6"](%/Concat_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:960:0
  %/scale.0/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/scale.0/Gemm"](%/Cast_6_output_0, %cond_layers.scale.0.weight, %cond_layers.scale.0.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::scale.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Sigmoid_1_output_0 : Float(1, 1024, strides=[1024, 1], device=cpu) = onnx::Sigmoid[onnx_name="/Sigmoid_1"](%/scale.0/Gemm_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/Mul_5_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_5"](%/scale.0/Gemm_output_0, %/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/scale.1/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/scale.1/Gemm"](%/Mul_5_output_0, %cond_layers.scale.1.weight, %cond_layers.scale.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::scale.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Add_1_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/Add_1"](%/Add_output_0, %/scale.1/Gemm_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:178:0
  %/conv_in/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/conv_in/Conv"](%in_1, %conv_in.weight, %conv_in.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.conv.Conv2d::conv_in # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/Constant_8_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={0}, onnx_name="/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:200:0
  %/Constant_9_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={0}, onnx_name="/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:200:0
  %/Constant_10_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:200:0
  %/Constant_11_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:200:0
  %/Slice_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/Slice"](%/Add_1_output_0, %/Constant_9_output_0, %/Constant_10_output_0, %/Constant_8_output_0, %/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:200:0
  %/down_blocks.0/resnets.0/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.0/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1/Reshape_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm1/Reshape"](%/conv_in/Conv_output_0, %/down_blocks.0/resnets.0/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1/InstanceNormalization_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.0/norm1/InstanceNormalization"](%/down_blocks.0/resnets.0/norm1/Reshape_output_0, %/down_blocks.0/resnets.0/norm1/Constant_1_output_0, %/down_blocks.0/resnets.0/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.0/norm1/Shape"](%/conv_in/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1/Reshape_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm1/Reshape_1"](%/down_blocks.0/resnets.0/norm1/InstanceNormalization_output_0, %/down_blocks.0/resnets.0/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1/Mul_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/norm1/Mul"](%/down_blocks.0/resnets.0/norm1/Reshape_1_output_0, %onnx::Mul_9224), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1/Add_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0/norm1/Add"](%/down_blocks.0/resnets.0/norm1/Mul_output_0, %onnx::Add_9225), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/Sigmoid_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.0/Sigmoid"](%/down_blocks.0/resnets.0/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/Mul_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/Mul"](%/down_blocks.0/resnets.0/norm1/Add_output_0, %/down_blocks.0/resnets.0/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/conv1/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.0/conv1/Conv"](%/down_blocks.0/resnets.0/Mul_output_0, %down_blocks.0.resnets.0.conv1.weight, %down_blocks.0.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.0/Sigmoid_1_output_0 : Float(1, 1024, strides=[1024, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.0/Sigmoid_1"](%/Slice_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/Mul_1_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/Mul_1"](%/Slice_output_0, %/down_blocks.0/resnets.0/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/time_layer/Gemm_output_0 : Float(1, 64, strides=[64, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.0/resnets.0/time_layer/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %down_blocks.0.resnets.0.time_layer.weight, %down_blocks.0.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.0/resnets.0/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Unsqueeze_output_0 : Float(1, 64, 1, strides=[64, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.0/Unsqueeze"](%/down_blocks.0/resnets.0/time_layer/Gemm_output_0, %/down_blocks.0/resnets.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Unsqueeze_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.0/Unsqueeze_1"](%/down_blocks.0/resnets.0/Unsqueeze_output_0, %/down_blocks.0/resnets.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.0/Shape"](%/down_blocks.0/resnets.0/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.0/resnets.0/Gather"](%/down_blocks.0/resnets.0/Shape_output_0, %/down_blocks.0/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.0/resnets.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.0/resnets.0/Add"](%/down_blocks.0/resnets.0/Gather_output_0, %/down_blocks.0/resnets.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.0/resnets.0/Div"](%/down_blocks.0/resnets.0/Add_output_0, %/down_blocks.0/resnets.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/Mul_2"](%/down_blocks.0/resnets.0/Div_output_0, %/down_blocks.0/resnets.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Slice_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.0/Slice"](%/down_blocks.0/resnets.0/Unsqueeze_1_output_0, %/down_blocks.0/resnets.0/Constant_3_output_0, %/down_blocks.0/resnets.0/Mul_2_output_0, %/down_blocks.0/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Mul_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/Mul_3"](%/down_blocks.0/resnets.0/Div_output_0, %/down_blocks.0/resnets.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/Slice_1_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.0/Slice_1"](%/down_blocks.0/resnets.0/Unsqueeze_1_output_0, %/down_blocks.0/resnets.0/Mul_2_output_0, %/down_blocks.0/resnets.0/Mul_3_output_0, %/down_blocks.0/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.0/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2/Reshape_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm2/Reshape"](%/down_blocks.0/resnets.0/conv1/Conv_output_0, %/down_blocks.0/resnets.0/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2/InstanceNormalization_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.0/norm2/InstanceNormalization"](%/down_blocks.0/resnets.0/norm2/Reshape_output_0, %/down_blocks.0/resnets.0/norm2/Constant_1_output_0, %/down_blocks.0/resnets.0/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.0/norm2/Shape"](%/down_blocks.0/resnets.0/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2/Reshape_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm2/Reshape_1"](%/down_blocks.0/resnets.0/norm2/InstanceNormalization_output_0, %/down_blocks.0/resnets.0/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2/Mul_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/norm2/Mul"](%/down_blocks.0/resnets.0/norm2/Reshape_1_output_0, %onnx::Mul_9226), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2/Add_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0/norm2/Add"](%/down_blocks.0/resnets.0/norm2/Mul_output_0, %onnx::Add_9227), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0/Add_1_output_0 : Float(1, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0/Add_1"](%/down_blocks.0/resnets.0/Slice_output_0, %/down_blocks.0/resnets.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0/Mul_4_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/Mul_4"](%/down_blocks.0/resnets.0/norm2/Add_output_0, %/down_blocks.0/resnets.0/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0/Add_2_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0/Add_2"](%/down_blocks.0/resnets.0/Mul_4_output_0, %/down_blocks.0/resnets.0/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0/Sigmoid_2_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.0/Sigmoid_2"](%/down_blocks.0/resnets.0/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/Mul_5_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/Mul_5"](%/down_blocks.0/resnets.0/Add_2_output_0, %/down_blocks.0/resnets.0/Sigmoid_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/conv2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.0/conv2/Conv"](%/down_blocks.0/resnets.0/Mul_5_output_0, %down_blocks.0.resnets.0.conv2.weight, %down_blocks.0.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.0/Add_3_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0/Add_3"](%/down_blocks.0/resnets.0/conv2/Conv_output_0, %/conv_in/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.0/resnets.1/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.1/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1/Reshape_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm1/Reshape"](%/down_blocks.0/resnets.0/Add_3_output_0, %/down_blocks.0/resnets.1/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1/InstanceNormalization_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.1/norm1/InstanceNormalization"](%/down_blocks.0/resnets.1/norm1/Reshape_output_0, %/down_blocks.0/resnets.1/norm1/Constant_1_output_0, %/down_blocks.0/resnets.1/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.1/norm1/Shape"](%/down_blocks.0/resnets.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1/Reshape_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm1/Reshape_1"](%/down_blocks.0/resnets.1/norm1/InstanceNormalization_output_0, %/down_blocks.0/resnets.1/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1/Mul_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/norm1/Mul"](%/down_blocks.0/resnets.1/norm1/Reshape_1_output_0, %onnx::Mul_9228), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1/Add_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1/norm1/Add"](%/down_blocks.0/resnets.1/norm1/Mul_output_0, %onnx::Add_9229), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/Sigmoid_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.1/Sigmoid"](%/down_blocks.0/resnets.1/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1/Mul_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/Mul"](%/down_blocks.0/resnets.1/norm1/Add_output_0, %/down_blocks.0/resnets.1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1/conv1/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.1/conv1/Conv"](%/down_blocks.0/resnets.1/Mul_output_0, %down_blocks.0.resnets.1.conv1.weight, %down_blocks.0.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.1/time_layer/Gemm_output_0 : Float(1, 64, strides=[64, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.0/resnets.1/time_layer/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %down_blocks.0.resnets.1.time_layer.weight, %down_blocks.0.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.0/resnets.1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Unsqueeze_output_0 : Float(1, 64, 1, strides=[64, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.1/Unsqueeze"](%/down_blocks.0/resnets.1/time_layer/Gemm_output_0, %/down_blocks.0/resnets.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Unsqueeze_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.1/Unsqueeze_1"](%/down_blocks.0/resnets.1/Unsqueeze_output_0, %/down_blocks.0/resnets.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.1/Shape"](%/down_blocks.0/resnets.1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.0/resnets.1/Gather"](%/down_blocks.0/resnets.1/Shape_output_0, %/down_blocks.0/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.0/resnets.1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.0/resnets.1/Add"](%/down_blocks.0/resnets.1/Gather_output_0, %/down_blocks.0/resnets.1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.0/resnets.1/Div"](%/down_blocks.0/resnets.1/Add_output_0, %/down_blocks.0/resnets.1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/Mul_1"](%/down_blocks.0/resnets.1/Div_output_0, %/down_blocks.0/resnets.1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Slice_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.1/Slice"](%/down_blocks.0/resnets.1/Unsqueeze_1_output_0, %/down_blocks.0/resnets.1/Constant_3_output_0, %/down_blocks.0/resnets.1/Mul_1_output_0, %/down_blocks.0/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/Mul_2"](%/down_blocks.0/resnets.1/Div_output_0, %/down_blocks.0/resnets.1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/Slice_1_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.1/Slice_1"](%/down_blocks.0/resnets.1/Unsqueeze_1_output_0, %/down_blocks.0/resnets.1/Mul_1_output_0, %/down_blocks.0/resnets.1/Mul_2_output_0, %/down_blocks.0/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.1/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2/Reshape_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm2/Reshape"](%/down_blocks.0/resnets.1/conv1/Conv_output_0, %/down_blocks.0/resnets.1/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2/InstanceNormalization_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.1/norm2/InstanceNormalization"](%/down_blocks.0/resnets.1/norm2/Reshape_output_0, %/down_blocks.0/resnets.1/norm2/Constant_1_output_0, %/down_blocks.0/resnets.1/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.1/norm2/Shape"](%/down_blocks.0/resnets.1/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2/Reshape_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm2/Reshape_1"](%/down_blocks.0/resnets.1/norm2/InstanceNormalization_output_0, %/down_blocks.0/resnets.1/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2/Mul_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/norm2/Mul"](%/down_blocks.0/resnets.1/norm2/Reshape_1_output_0, %onnx::Mul_9230), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2/Add_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1/norm2/Add"](%/down_blocks.0/resnets.1/norm2/Mul_output_0, %onnx::Add_9231), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1/Add_1_output_0 : Float(1, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1/Add_1"](%/down_blocks.0/resnets.1/Slice_output_0, %/down_blocks.0/resnets.1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1/Mul_3_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/Mul_3"](%/down_blocks.0/resnets.1/norm2/Add_output_0, %/down_blocks.0/resnets.1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1/Add_2_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1/Add_2"](%/down_blocks.0/resnets.1/Mul_3_output_0, %/down_blocks.0/resnets.1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1/Sigmoid_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.1/Sigmoid_1"](%/down_blocks.0/resnets.1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1/Mul_4_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/Mul_4"](%/down_blocks.0/resnets.1/Add_2_output_0, %/down_blocks.0/resnets.1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1/conv2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.1/conv2/Conv"](%/down_blocks.0/resnets.1/Mul_4_output_0, %down_blocks.0.resnets.1.conv2.weight, %down_blocks.0.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.1/Add_3_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1/Add_3"](%/down_blocks.0/resnets.1/conv2/Conv_output_0, %/down_blocks.0/resnets.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.0/resample/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[2, 2], onnx_name="/down_blocks.0/resample/Conv"](%/down_blocks.0/resnets.1/Add_3_output_0, %down_blocks.0.resample.weight, %down_blocks.0.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.0/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1/Reshape_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm1/Reshape"](%/down_blocks.0/resample/Conv_output_0, %/down_blocks.1/resnets.0/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1/InstanceNormalization_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.0/norm1/InstanceNormalization"](%/down_blocks.1/resnets.0/norm1/Reshape_output_0, %/down_blocks.1/resnets.0/norm1/Constant_1_output_0, %/down_blocks.1/resnets.0/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.0/norm1/Shape"](%/down_blocks.0/resample/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1/Reshape_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm1/Reshape_1"](%/down_blocks.1/resnets.0/norm1/InstanceNormalization_output_0, %/down_blocks.1/resnets.0/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1/Mul_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/norm1/Mul"](%/down_blocks.1/resnets.0/norm1/Reshape_1_output_0, %onnx::Mul_9232), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1/Add_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0/norm1/Add"](%/down_blocks.1/resnets.0/norm1/Mul_output_0, %onnx::Add_9233), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/Sigmoid_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.0/Sigmoid"](%/down_blocks.1/resnets.0/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0/Mul_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/Mul"](%/down_blocks.1/resnets.0/norm1/Add_output_0, %/down_blocks.1/resnets.0/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0/conv1/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.0/conv1/Conv"](%/down_blocks.1/resnets.0/Mul_output_0, %down_blocks.1.resnets.0.conv1.weight, %down_blocks.1.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0/time_layer/Gemm_output_0 : Float(1, 64, strides=[64, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.1/resnets.0/time_layer/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %down_blocks.1.resnets.0.time_layer.weight, %down_blocks.1.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.1/resnets.0/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Unsqueeze_output_0 : Float(1, 64, 1, strides=[64, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.0/Unsqueeze"](%/down_blocks.1/resnets.0/time_layer/Gemm_output_0, %/down_blocks.1/resnets.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Unsqueeze_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.0/Unsqueeze_1"](%/down_blocks.1/resnets.0/Unsqueeze_output_0, %/down_blocks.1/resnets.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.0/Shape"](%/down_blocks.1/resnets.0/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.1/resnets.0/Gather"](%/down_blocks.1/resnets.0/Shape_output_0, %/down_blocks.1/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.1/resnets.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/resnets.0/Add"](%/down_blocks.1/resnets.0/Gather_output_0, %/down_blocks.1/resnets.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/resnets.0/Div"](%/down_blocks.1/resnets.0/Add_output_0, %/down_blocks.1/resnets.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/Mul_1"](%/down_blocks.1/resnets.0/Div_output_0, %/down_blocks.1/resnets.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Slice_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.0/Slice"](%/down_blocks.1/resnets.0/Unsqueeze_1_output_0, %/down_blocks.1/resnets.0/Constant_3_output_0, %/down_blocks.1/resnets.0/Mul_1_output_0, %/down_blocks.1/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/Mul_2"](%/down_blocks.1/resnets.0/Div_output_0, %/down_blocks.1/resnets.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/Slice_1_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.0/Slice_1"](%/down_blocks.1/resnets.0/Unsqueeze_1_output_0, %/down_blocks.1/resnets.0/Mul_1_output_0, %/down_blocks.1/resnets.0/Mul_2_output_0, %/down_blocks.1/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.0/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2/Reshape_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm2/Reshape"](%/down_blocks.1/resnets.0/conv1/Conv_output_0, %/down_blocks.1/resnets.0/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2/InstanceNormalization_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.0/norm2/InstanceNormalization"](%/down_blocks.1/resnets.0/norm2/Reshape_output_0, %/down_blocks.1/resnets.0/norm2/Constant_1_output_0, %/down_blocks.1/resnets.0/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.0/norm2/Shape"](%/down_blocks.1/resnets.0/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2/Reshape_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm2/Reshape_1"](%/down_blocks.1/resnets.0/norm2/InstanceNormalization_output_0, %/down_blocks.1/resnets.0/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2/Mul_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/norm2/Mul"](%/down_blocks.1/resnets.0/norm2/Reshape_1_output_0, %onnx::Mul_9234), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2/Add_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0/norm2/Add"](%/down_blocks.1/resnets.0/norm2/Mul_output_0, %onnx::Add_9235), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0/Add_1_output_0 : Float(1, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0/Add_1"](%/down_blocks.1/resnets.0/Slice_output_0, %/down_blocks.1/resnets.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0/Mul_3_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/Mul_3"](%/down_blocks.1/resnets.0/norm2/Add_output_0, %/down_blocks.1/resnets.0/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0/Add_2_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0/Add_2"](%/down_blocks.1/resnets.0/Mul_3_output_0, %/down_blocks.1/resnets.0/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0/Sigmoid_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.0/Sigmoid_1"](%/down_blocks.1/resnets.0/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0/Mul_4_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/Mul_4"](%/down_blocks.1/resnets.0/Add_2_output_0, %/down_blocks.1/resnets.0/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0/conv2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.0/conv2/Conv"](%/down_blocks.1/resnets.0/Mul_4_output_0, %down_blocks.1.resnets.0.conv2.weight, %down_blocks.1.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0/Add_3_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0/Add_3"](%/down_blocks.1/resnets.0/conv2/Conv_output_0, %/down_blocks.0/resample/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.1/resnets.1/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.1/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1/Reshape_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm1/Reshape"](%/down_blocks.1/resnets.0/Add_3_output_0, %/down_blocks.1/resnets.1/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1/InstanceNormalization_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.1/norm1/InstanceNormalization"](%/down_blocks.1/resnets.1/norm1/Reshape_output_0, %/down_blocks.1/resnets.1/norm1/Constant_1_output_0, %/down_blocks.1/resnets.1/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.1/norm1/Shape"](%/down_blocks.1/resnets.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1/Reshape_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm1/Reshape_1"](%/down_blocks.1/resnets.1/norm1/InstanceNormalization_output_0, %/down_blocks.1/resnets.1/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1/Mul_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/norm1/Mul"](%/down_blocks.1/resnets.1/norm1/Reshape_1_output_0, %onnx::Mul_9236), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1/Add_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1/norm1/Add"](%/down_blocks.1/resnets.1/norm1/Mul_output_0, %onnx::Add_9237), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/Sigmoid_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.1/Sigmoid"](%/down_blocks.1/resnets.1/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1/Mul_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/Mul"](%/down_blocks.1/resnets.1/norm1/Add_output_0, %/down_blocks.1/resnets.1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1/conv1/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.1/conv1/Conv"](%/down_blocks.1/resnets.1/Mul_output_0, %down_blocks.1.resnets.1.conv1.weight, %down_blocks.1.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.1/time_layer/Gemm_output_0 : Float(1, 64, strides=[64, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.1/resnets.1/time_layer/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %down_blocks.1.resnets.1.time_layer.weight, %down_blocks.1.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.1/resnets.1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Unsqueeze_output_0 : Float(1, 64, 1, strides=[64, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.1/Unsqueeze"](%/down_blocks.1/resnets.1/time_layer/Gemm_output_0, %/down_blocks.1/resnets.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Unsqueeze_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.1/Unsqueeze_1"](%/down_blocks.1/resnets.1/Unsqueeze_output_0, %/down_blocks.1/resnets.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.1/Shape"](%/down_blocks.1/resnets.1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.1/resnets.1/Gather"](%/down_blocks.1/resnets.1/Shape_output_0, %/down_blocks.1/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.1/resnets.1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/resnets.1/Add"](%/down_blocks.1/resnets.1/Gather_output_0, %/down_blocks.1/resnets.1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/resnets.1/Div"](%/down_blocks.1/resnets.1/Add_output_0, %/down_blocks.1/resnets.1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/Mul_1"](%/down_blocks.1/resnets.1/Div_output_0, %/down_blocks.1/resnets.1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Slice_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.1/Slice"](%/down_blocks.1/resnets.1/Unsqueeze_1_output_0, %/down_blocks.1/resnets.1/Constant_3_output_0, %/down_blocks.1/resnets.1/Mul_1_output_0, %/down_blocks.1/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/Mul_2"](%/down_blocks.1/resnets.1/Div_output_0, %/down_blocks.1/resnets.1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/Slice_1_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.1/Slice_1"](%/down_blocks.1/resnets.1/Unsqueeze_1_output_0, %/down_blocks.1/resnets.1/Mul_1_output_0, %/down_blocks.1/resnets.1/Mul_2_output_0, %/down_blocks.1/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.1/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2/Reshape_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm2/Reshape"](%/down_blocks.1/resnets.1/conv1/Conv_output_0, %/down_blocks.1/resnets.1/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2/InstanceNormalization_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.1/norm2/InstanceNormalization"](%/down_blocks.1/resnets.1/norm2/Reshape_output_0, %/down_blocks.1/resnets.1/norm2/Constant_1_output_0, %/down_blocks.1/resnets.1/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.1/norm2/Shape"](%/down_blocks.1/resnets.1/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2/Reshape_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm2/Reshape_1"](%/down_blocks.1/resnets.1/norm2/InstanceNormalization_output_0, %/down_blocks.1/resnets.1/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2/Mul_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/norm2/Mul"](%/down_blocks.1/resnets.1/norm2/Reshape_1_output_0, %onnx::Mul_9238), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2/Add_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1/norm2/Add"](%/down_blocks.1/resnets.1/norm2/Mul_output_0, %onnx::Add_9239), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1/Add_1_output_0 : Float(1, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1/Add_1"](%/down_blocks.1/resnets.1/Slice_output_0, %/down_blocks.1/resnets.1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1/Mul_3_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/Mul_3"](%/down_blocks.1/resnets.1/norm2/Add_output_0, %/down_blocks.1/resnets.1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1/Add_2_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1/Add_2"](%/down_blocks.1/resnets.1/Mul_3_output_0, %/down_blocks.1/resnets.1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1/Sigmoid_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.1/Sigmoid_1"](%/down_blocks.1/resnets.1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1/Mul_4_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/Mul_4"](%/down_blocks.1/resnets.1/Add_2_output_0, %/down_blocks.1/resnets.1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1/conv2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.1/conv2/Conv"](%/down_blocks.1/resnets.1/Mul_4_output_0, %down_blocks.1.resnets.1.conv2.weight, %down_blocks.1.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.1/Add_3_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1/Add_3"](%/down_blocks.1/resnets.1/conv2/Conv_output_0, %/down_blocks.1/resnets.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.1/resample/Conv_output_0 : Float(1, 32, 32, 16, strides=[16384, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[2, 2], onnx_name="/down_blocks.1/resample/Conv"](%/down_blocks.1/resnets.1/Add_3_output_0, %down_blocks.1.resample.weight, %down_blocks.1.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/resnets.0/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1/Reshape_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm1/Reshape"](%/down_blocks.1/resample/Conv_output_0, %/down_blocks.2/resnets.0/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1/InstanceNormalization_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/resnets.0/norm1/InstanceNormalization"](%/down_blocks.2/resnets.0/norm1/Reshape_output_0, %/down_blocks.2/resnets.0/norm1/Constant_1_output_0, %/down_blocks.2/resnets.0/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.0/norm1/Shape"](%/down_blocks.1/resample/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1/Reshape_1_output_0 : Float(1, 32, 32, 16, strides=[16384, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm1/Reshape_1"](%/down_blocks.2/resnets.0/norm1/InstanceNormalization_output_0, %/down_blocks.2/resnets.0/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1/Mul_output_0 : Float(1, 32, 32, 16, strides=[16384, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/norm1/Mul"](%/down_blocks.2/resnets.0/norm1/Reshape_1_output_0, %onnx::Mul_9240), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1/Add_output_0 : Float(1, 32, 32, 16, strides=[16384, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0/norm1/Add"](%/down_blocks.2/resnets.0/norm1/Mul_output_0, %onnx::Add_9241), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/Sigmoid_output_0 : Float(1, 32, 32, 16, strides=[16384, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.2/resnets.0/Sigmoid"](%/down_blocks.2/resnets.0/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0/Mul_output_0 : Float(1, 32, 32, 16, strides=[16384, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/Mul"](%/down_blocks.2/resnets.0/norm1/Add_output_0, %/down_blocks.2/resnets.0/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0/conv1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.2/resnets.0/conv1/Conv"](%/down_blocks.2/resnets.0/Mul_output_0, %down_blocks.2.resnets.0.conv1.weight, %down_blocks.2.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0/time_layer/Gemm_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.2/resnets.0/time_layer/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %down_blocks.2.resnets.0.time_layer.weight, %down_blocks.2.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/resnets.0/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.2/resnets.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Unsqueeze_output_0 : Float(1, 128, 1, strides=[128, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.2/resnets.0/Unsqueeze"](%/down_blocks.2/resnets.0/time_layer/Gemm_output_0, %/down_blocks.2/resnets.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.2/resnets.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Unsqueeze_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.2/resnets.0/Unsqueeze_1"](%/down_blocks.2/resnets.0/Unsqueeze_output_0, %/down_blocks.2/resnets.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.0/Shape"](%/down_blocks.2/resnets.0/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/resnets.0/Gather"](%/down_blocks.2/resnets.0/Shape_output_0, %/down_blocks.2/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/resnets.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/resnets.0/Add"](%/down_blocks.2/resnets.0/Gather_output_0, %/down_blocks.2/resnets.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/resnets.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/resnets.0/Div"](%/down_blocks.2/resnets.0/Add_output_0, %/down_blocks.2/resnets.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/Mul_1"](%/down_blocks.2/resnets.0/Div_output_0, %/down_blocks.2/resnets.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Slice_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/resnets.0/Slice"](%/down_blocks.2/resnets.0/Unsqueeze_1_output_0, %/down_blocks.2/resnets.0/Constant_3_output_0, %/down_blocks.2/resnets.0/Mul_1_output_0, %/down_blocks.2/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/resnets.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/Mul_2"](%/down_blocks.2/resnets.0/Div_output_0, %/down_blocks.2/resnets.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/Slice_1_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/resnets.0/Slice_1"](%/down_blocks.2/resnets.0/Unsqueeze_1_output_0, %/down_blocks.2/resnets.0/Mul_1_output_0, %/down_blocks.2/resnets.0/Mul_2_output_0, %/down_blocks.2/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/resnets.0/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm2/Reshape"](%/down_blocks.2/resnets.0/conv1/Conv_output_0, %/down_blocks.2/resnets.0/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/resnets.0/norm2/InstanceNormalization"](%/down_blocks.2/resnets.0/norm2/Reshape_output_0, %/down_blocks.2/resnets.0/norm2/Constant_1_output_0, %/down_blocks.2/resnets.0/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.0/norm2/Shape"](%/down_blocks.2/resnets.0/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm2/Reshape_1"](%/down_blocks.2/resnets.0/norm2/InstanceNormalization_output_0, %/down_blocks.2/resnets.0/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/norm2/Mul"](%/down_blocks.2/resnets.0/norm2/Reshape_1_output_0, %onnx::Mul_9242), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0/norm2/Add"](%/down_blocks.2/resnets.0/norm2/Mul_output_0, %onnx::Add_9243), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0/Add_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0/Add_1"](%/down_blocks.2/resnets.0/Slice_output_0, %/down_blocks.2/resnets.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0/Mul_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/Mul_3"](%/down_blocks.2/resnets.0/norm2/Add_output_0, %/down_blocks.2/resnets.0/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0/Add_2_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0/Add_2"](%/down_blocks.2/resnets.0/Mul_3_output_0, %/down_blocks.2/resnets.0/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0/Sigmoid_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.2/resnets.0/Sigmoid_1"](%/down_blocks.2/resnets.0/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0/Mul_4_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/Mul_4"](%/down_blocks.2/resnets.0/Add_2_output_0, %/down_blocks.2/resnets.0/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0/conv2/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.2/resnets.0/conv2/Conv"](%/down_blocks.2/resnets.0/Mul_4_output_0, %down_blocks.2.resnets.0.conv2.weight, %down_blocks.2.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0/conv3/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/resnets.0/conv3/Conv"](%/down_blocks.1/resample/Conv_output_0, %down_blocks.2.resnets.0.conv3.weight, %down_blocks.2.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0/Add_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0/Add_3"](%/down_blocks.2/resnets.0/conv2/Conv_output_0, %/down_blocks.2/resnets.0/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/in_adapter/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/in_adapter/Conv"](%/down_blocks.2/resnets.0/Add_3_output_0, %in_adapter.weight, %in_adapter.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.conv.Conv2d::in_adapter # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/temb_layer1_1/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/temb_layer1_1/Gemm"](%/Cast_4_output_0, %inner_unet.temb_layer1.weight, %inner_unet.temb_layer1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::temb_layer1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Sigmoid_2_output_0 : Float(1, 1024, strides=[1024, 1], device=cpu) = onnx::Sigmoid[onnx_name="/Sigmoid_2"](%/temb_layer1_1/Gemm_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/Mul_6_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_6"](%/temb_layer1_1/Gemm_output_0, %/Sigmoid_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/temb_layer2_1/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/temb_layer2_1/Gemm"](%/Mul_6_output_0, %inner_unet.temb_layer2.weight, %inner_unet.temb_layer2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::temb_layer2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Add_2_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/Add_2"](%/temb_layer2_1/Gemm_output_0, %/cond_emb/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:175:0
  %/Constant_12_output_0 : Double(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Constant_13_output_0 : Double(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %onnx::Clip_1427 : Tensor? = prim::Constant(), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Clip_1_output_0 : Double(1, strides=[1], requires_grad=0, device=cuda:0) = onnx::Clip[onnx_name="/Clip_1"](%/Constant_12_output_0, %onnx::Clip_1427, %/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Constant_14_output_0 : Double(requires_grad=0, device=cpu) = onnx::Constant[value={256}, onnx_name="/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Mul_7_output_0 : Double(1, strides=[1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_7"](%/Clip_1_output_0, %/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Constant_15_output_0 : Long(2, strides=[1], device=cpu) = onnx::Constant[value=-1  1 [ CPULongType{2} ], onnx_name="/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Reshape_2_output_0 : Double(1, 1, strides=[1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/Reshape_2"](%/Mul_7_output_0, %/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Constant_16_output_0 : Double(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Constant[value=<Tensor>, onnx_name="/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Mul_8_output_0 : Double(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_8"](%/Reshape_2_output_0, %/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Cast_7_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast_7"](%/Mul_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:947:0
  %/Sin_2_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Sin[onnx_name="/Sin_2"](%/Cast_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Cos_2_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Cos[onnx_name="/Cos_2"](%/Cast_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Concat_2_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/Concat_2"](%/Sin_2_output_0, %/Cos_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Cast_8_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast_8"](%/Concat_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:960:0
  %/scale.0_1/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/scale.0_1/Gemm"](%/Cast_8_output_0, %inner_unet.cond_layers.scale.0.weight, %inner_unet.cond_layers.scale.0.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::scale.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Sigmoid_3_output_0 : Float(1, 1024, strides=[1024, 1], device=cpu) = onnx::Sigmoid[onnx_name="/Sigmoid_3"](%/scale.0_1/Gemm_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/Mul_9_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_9"](%/scale.0_1/Gemm_output_0, %/Sigmoid_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/scale.1_1/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/scale.1_1/Gemm"](%/Mul_9_output_0, %inner_unet.cond_layers.scale.1.weight, %inner_unet.cond_layers.scale.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::scale.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Add_3_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/Add_3"](%/Add_2_output_0, %/scale.1_1/Gemm_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:178:0
  %/ReduceMean_output_0 : Float(1, 1, 1, 1, strides=[1, 1, 1, 1], device=cpu) = onnx::ReduceMean[axes=[1, 2, 3], keepdims=1, onnx_name="/ReduceMean"](%in_2), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/Shape"](%in_2), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Constant_17_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value= 1  2  3 [ CPULongType{3} ], onnx_name="/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Gather_output_0 : Long(3, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/Gather"](%/Shape_output_0, %/Constant_17_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/ReduceProd_output_0 : Long(device=cpu) = onnx::ReduceProd[keepdims=0, onnx_name="/ReduceProd"](%/Gather_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Sub_output_0 : Float(1, 6, 32, 16, strides=[3072, 512, 16, 1], device=cpu) = onnx::Sub[onnx_name="/Sub"](%in_2, %/ReduceMean_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Mul_10_output_0 : Float(1, 6, 32, 16, strides=[3072, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/Mul_10"](%/Sub_output_0, %/Sub_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/ReduceMean_1_output_0 : Float(1, 1, 1, 1, strides=[1, 1, 1, 1], device=cpu) = onnx::ReduceMean[axes=[1, 2, 3], keepdims=1, onnx_name="/ReduceMean_1"](%/Mul_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Cast_9_output_0 : Float(device=cpu) = onnx::Cast[to=1, onnx_name="/Cast_9"](%/ReduceProd_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Mul_11_output_0 : Float(1, 1, 1, 1, strides=[1, 1, 1, 1], device=cpu) = onnx::Mul[onnx_name="/Mul_11"](%/ReduceMean_1_output_0, %/Cast_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Constant_18_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Sub_1_output_0 : Float(device=cpu) = onnx::Sub[onnx_name="/Sub_1"](%/Cast_9_output_0, %/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Div_1_output_0 : Float(1, 1, 1, 1, strides=[1, 1, 1, 1], device=cpu) = onnx::Div[onnx_name="/Div_1"](%/Mul_11_output_0, %/Sub_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Sqrt_output_0 : Float(1, 1, 1, 1, strides=[1, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Sqrt[onnx_name="/Sqrt"](%/Div_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/Div_2_output_0 : Float(1, 6, 32, 16, strides=[3072, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Div[onnx_name="/Div_2"](%in_2, %/Sqrt_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1005:0
  %/conv_in_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/conv_in_1/Conv"](%/Div_2_output_0, %inner_unet.conv_in.weight, %inner_unet.conv_in.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.conv.Conv2d::conv_in # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/Add_4_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/Add_4"](%/conv_in_1/Conv_output_0, %/in_adapter/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:195:0
  %/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={0}, onnx_name="/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:200:0
  %/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={0}, onnx_name="/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:200:0
  %/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:200:0
  %/Constant_22_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:200:0
  %/Slice_1_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/Slice_1"](%/Add_3_output_0, %/Constant_20_output_0, %/Constant_21_output_0, %/Constant_19_output_0, %/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:200:0
  %/down_blocks.0/resnets.0/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.0/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_1/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm1_1/Reshape"](%/Add_4_output_0, %/down_blocks.0/resnets.0/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.0/norm1_1/InstanceNormalization"](%/down_blocks.0/resnets.0/norm1_1/Reshape_output_0, %/down_blocks.0/resnets.0/norm1_1/Constant_1_output_0, %/down_blocks.0/resnets.0/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.0/norm1_1/Shape"](%/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_1/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm1_1/Reshape_1"](%/down_blocks.0/resnets.0/norm1_1/InstanceNormalization_output_0, %/down_blocks.0/resnets.0/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_1/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/norm1_1/Mul"](%/down_blocks.0/resnets.0/norm1_1/Reshape_1_output_0, %onnx::Mul_9250), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_1/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0/norm1_1/Add"](%/down_blocks.0/resnets.0/norm1_1/Mul_output_0, %onnx::Add_9251), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0_1/Sigmoid_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.0_1/Sigmoid"](%/down_blocks.0/resnets.0/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0_1/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_1/Mul"](%/down_blocks.0/resnets.0/norm1_1/Add_output_0, %/down_blocks.0/resnets.0_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/conv1_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.0/conv1_1/Conv"](%/down_blocks.0/resnets.0_1/Mul_output_0, %inner_unet.down_blocks.0.resnets.0.conv1.weight, %inner_unet.down_blocks.0.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.0_1/Sigmoid_1_output_0 : Float(1, 1024, strides=[1024, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.0_1/Sigmoid_1"](%/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0_1/Mul_1_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_1/Mul_1"](%/Slice_1_output_0, %/down_blocks.0/resnets.0_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/time_layer_1/Gemm_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.0/resnets.0/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.down_blocks.0.resnets.0.time_layer.weight, %inner_unet.down_blocks.0.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.0/resnets.0_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.0_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Unsqueeze_output_0 : Float(1, 128, 1, strides=[128, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.0_1/Unsqueeze"](%/down_blocks.0/resnets.0/time_layer_1/Gemm_output_0, %/down_blocks.0/resnets.0_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.0_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Unsqueeze_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.0_1/Unsqueeze_1"](%/down_blocks.0/resnets.0_1/Unsqueeze_output_0, %/down_blocks.0/resnets.0_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.0_1/Shape"](%/down_blocks.0/resnets.0_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.0/resnets.0_1/Gather"](%/down_blocks.0/resnets.0_1/Shape_output_0, %/down_blocks.0/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.0/resnets.0_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.0/resnets.0_1/Add"](%/down_blocks.0/resnets.0_1/Gather_output_0, %/down_blocks.0/resnets.0_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.0_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.0/resnets.0_1/Div"](%/down_blocks.0/resnets.0_1/Add_output_0, %/down_blocks.0/resnets.0_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_1/Mul_2"](%/down_blocks.0/resnets.0_1/Div_output_0, %/down_blocks.0/resnets.0_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Slice_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.0_1/Slice"](%/down_blocks.0/resnets.0_1/Unsqueeze_1_output_0, %/down_blocks.0/resnets.0_1/Constant_3_output_0, %/down_blocks.0/resnets.0_1/Mul_2_output_0, %/down_blocks.0/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.0_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Mul_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_1/Mul_3"](%/down_blocks.0/resnets.0_1/Div_output_0, %/down_blocks.0/resnets.0_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_1/Slice_1_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.0_1/Slice_1"](%/down_blocks.0/resnets.0_1/Unsqueeze_1_output_0, %/down_blocks.0/resnets.0_1/Mul_2_output_0, %/down_blocks.0/resnets.0_1/Mul_3_output_0, %/down_blocks.0/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.0/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_1/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm2_1/Reshape"](%/down_blocks.0/resnets.0/conv1_1/Conv_output_0, %/down_blocks.0/resnets.0/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.0/norm2_1/InstanceNormalization"](%/down_blocks.0/resnets.0/norm2_1/Reshape_output_0, %/down_blocks.0/resnets.0/norm2_1/Constant_1_output_0, %/down_blocks.0/resnets.0/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.0/norm2_1/Shape"](%/down_blocks.0/resnets.0/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_1/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm2_1/Reshape_1"](%/down_blocks.0/resnets.0/norm2_1/InstanceNormalization_output_0, %/down_blocks.0/resnets.0/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_1/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/norm2_1/Mul"](%/down_blocks.0/resnets.0/norm2_1/Reshape_1_output_0, %onnx::Mul_9252), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_1/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0/norm2_1/Add"](%/down_blocks.0/resnets.0/norm2_1/Mul_output_0, %onnx::Add_9253), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0_1/Add_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0_1/Add_1"](%/down_blocks.0/resnets.0_1/Slice_output_0, %/down_blocks.0/resnets.0_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0_1/Mul_4_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_1/Mul_4"](%/down_blocks.0/resnets.0/norm2_1/Add_output_0, %/down_blocks.0/resnets.0_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0_1/Add_2_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0_1/Add_2"](%/down_blocks.0/resnets.0_1/Mul_4_output_0, %/down_blocks.0/resnets.0_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0_1/Sigmoid_2_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.0_1/Sigmoid_2"](%/down_blocks.0/resnets.0_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0_1/Mul_5_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_1/Mul_5"](%/down_blocks.0/resnets.0_1/Add_2_output_0, %/down_blocks.0/resnets.0_1/Sigmoid_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/conv2_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.0/conv2_1/Conv"](%/down_blocks.0/resnets.0_1/Mul_5_output_0, %inner_unet.down_blocks.0.resnets.0.conv2.weight, %inner_unet.down_blocks.0.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.0_1/Add_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0_1/Add_3"](%/down_blocks.0/resnets.0/conv2_1/Conv_output_0, %/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.0/resnets.1/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.1/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_1/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm1_1/Reshape"](%/down_blocks.0/resnets.0_1/Add_3_output_0, %/down_blocks.0/resnets.1/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.1/norm1_1/InstanceNormalization"](%/down_blocks.0/resnets.1/norm1_1/Reshape_output_0, %/down_blocks.0/resnets.1/norm1_1/Constant_1_output_0, %/down_blocks.0/resnets.1/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.1/norm1_1/Shape"](%/down_blocks.0/resnets.0_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_1/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm1_1/Reshape_1"](%/down_blocks.0/resnets.1/norm1_1/InstanceNormalization_output_0, %/down_blocks.0/resnets.1/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_1/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/norm1_1/Mul"](%/down_blocks.0/resnets.1/norm1_1/Reshape_1_output_0, %onnx::Mul_9254), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_1/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1/norm1_1/Add"](%/down_blocks.0/resnets.1/norm1_1/Mul_output_0, %onnx::Add_9255), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1_1/Sigmoid_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.1_1/Sigmoid"](%/down_blocks.0/resnets.1/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1_1/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1_1/Mul"](%/down_blocks.0/resnets.1/norm1_1/Add_output_0, %/down_blocks.0/resnets.1_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1/conv1_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.1/conv1_1/Conv"](%/down_blocks.0/resnets.1_1/Mul_output_0, %inner_unet.down_blocks.0.resnets.1.conv1.weight, %inner_unet.down_blocks.0.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.1/time_layer_1/Gemm_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.0/resnets.1/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.down_blocks.0.resnets.1.time_layer.weight, %inner_unet.down_blocks.0.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.0/resnets.1_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Unsqueeze_output_0 : Float(1, 128, 1, strides=[128, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.1_1/Unsqueeze"](%/down_blocks.0/resnets.1/time_layer_1/Gemm_output_0, %/down_blocks.0/resnets.1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Unsqueeze_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.1_1/Unsqueeze_1"](%/down_blocks.0/resnets.1_1/Unsqueeze_output_0, %/down_blocks.0/resnets.1_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.1_1/Shape"](%/down_blocks.0/resnets.1_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.0/resnets.1_1/Gather"](%/down_blocks.0/resnets.1_1/Shape_output_0, %/down_blocks.0/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.0/resnets.1_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.0/resnets.1_1/Add"](%/down_blocks.0/resnets.1_1/Gather_output_0, %/down_blocks.0/resnets.1_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.1_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.0/resnets.1_1/Div"](%/down_blocks.0/resnets.1_1/Add_output_0, %/down_blocks.0/resnets.1_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1_1/Mul_1"](%/down_blocks.0/resnets.1_1/Div_output_0, %/down_blocks.0/resnets.1_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Slice_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.1_1/Slice"](%/down_blocks.0/resnets.1_1/Unsqueeze_1_output_0, %/down_blocks.0/resnets.1_1/Constant_3_output_0, %/down_blocks.0/resnets.1_1/Mul_1_output_0, %/down_blocks.0/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.1_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1_1/Mul_2"](%/down_blocks.0/resnets.1_1/Div_output_0, %/down_blocks.0/resnets.1_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_1/Slice_1_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.1_1/Slice_1"](%/down_blocks.0/resnets.1_1/Unsqueeze_1_output_0, %/down_blocks.0/resnets.1_1/Mul_1_output_0, %/down_blocks.0/resnets.1_1/Mul_2_output_0, %/down_blocks.0/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.1/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_1/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm2_1/Reshape"](%/down_blocks.0/resnets.1/conv1_1/Conv_output_0, %/down_blocks.0/resnets.1/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.1/norm2_1/InstanceNormalization"](%/down_blocks.0/resnets.1/norm2_1/Reshape_output_0, %/down_blocks.0/resnets.1/norm2_1/Constant_1_output_0, %/down_blocks.0/resnets.1/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.1/norm2_1/Shape"](%/down_blocks.0/resnets.1/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_1/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm2_1/Reshape_1"](%/down_blocks.0/resnets.1/norm2_1/InstanceNormalization_output_0, %/down_blocks.0/resnets.1/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_1/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/norm2_1/Mul"](%/down_blocks.0/resnets.1/norm2_1/Reshape_1_output_0, %onnx::Mul_9256), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_1/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1/norm2_1/Add"](%/down_blocks.0/resnets.1/norm2_1/Mul_output_0, %onnx::Add_9257), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1_1/Add_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1_1/Add_1"](%/down_blocks.0/resnets.1_1/Slice_output_0, %/down_blocks.0/resnets.1_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1_1/Mul_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1_1/Mul_3"](%/down_blocks.0/resnets.1/norm2_1/Add_output_0, %/down_blocks.0/resnets.1_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1_1/Add_2_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1_1/Add_2"](%/down_blocks.0/resnets.1_1/Mul_3_output_0, %/down_blocks.0/resnets.1_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1_1/Sigmoid_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.1_1/Sigmoid_1"](%/down_blocks.0/resnets.1_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1_1/Mul_4_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1_1/Mul_4"](%/down_blocks.0/resnets.1_1/Add_2_output_0, %/down_blocks.0/resnets.1_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1/conv2_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.1/conv2_1/Conv"](%/down_blocks.0/resnets.1_1/Mul_4_output_0, %inner_unet.down_blocks.0.resnets.1.conv2.weight, %inner_unet.down_blocks.0.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.1_1/Add_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1_1/Add_3"](%/down_blocks.0/resnets.1/conv2_1/Conv_output_0, %/down_blocks.0/resnets.0_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.0/resample_1/Conv_output_0 : Float(1, 64, 16, 8, strides=[8192, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[2, 2], onnx_name="/down_blocks.0/resample_1/Conv"](%/down_blocks.0/resnets.1_1/Add_3_output_0, %inner_unet.down_blocks.0.resample.weight, %inner_unet.down_blocks.0.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.0/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_1/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm1_1/Reshape"](%/down_blocks.0/resample_1/Conv_output_0, %/down_blocks.1/resnets.0/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.0/norm1_1/InstanceNormalization"](%/down_blocks.1/resnets.0/norm1_1/Reshape_output_0, %/down_blocks.1/resnets.0/norm1_1/Constant_1_output_0, %/down_blocks.1/resnets.0/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.0/norm1_1/Shape"](%/down_blocks.0/resample_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_1/Reshape_1_output_0 : Float(1, 64, 16, 8, strides=[8192, 128, 8, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm1_1/Reshape_1"](%/down_blocks.1/resnets.0/norm1_1/InstanceNormalization_output_0, %/down_blocks.1/resnets.0/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_1/Mul_output_0 : Float(1, 64, 16, 8, strides=[8192, 128, 8, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/norm1_1/Mul"](%/down_blocks.1/resnets.0/norm1_1/Reshape_1_output_0, %onnx::Mul_9258), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_1/Add_output_0 : Float(1, 64, 16, 8, strides=[8192, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0/norm1_1/Add"](%/down_blocks.1/resnets.0/norm1_1/Mul_output_0, %onnx::Add_9259), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0_1/Sigmoid_output_0 : Float(1, 64, 16, 8, strides=[8192, 128, 8, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.0_1/Sigmoid"](%/down_blocks.1/resnets.0/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0_1/Mul_output_0 : Float(1, 64, 16, 8, strides=[8192, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0_1/Mul"](%/down_blocks.1/resnets.0/norm1_1/Add_output_0, %/down_blocks.1/resnets.0_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0/conv1_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.0/conv1_1/Conv"](%/down_blocks.1/resnets.0_1/Mul_output_0, %inner_unet.down_blocks.1.resnets.0.conv1.weight, %inner_unet.down_blocks.1.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0/time_layer_1/Gemm_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.1/resnets.0/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.down_blocks.1.resnets.0.time_layer.weight, %inner_unet.down_blocks.1.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.1/resnets.0_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.0_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Unsqueeze_output_0 : Float(1, 256, 1, strides=[256, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.0_1/Unsqueeze"](%/down_blocks.1/resnets.0/time_layer_1/Gemm_output_0, %/down_blocks.1/resnets.0_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.0_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Unsqueeze_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.0_1/Unsqueeze_1"](%/down_blocks.1/resnets.0_1/Unsqueeze_output_0, %/down_blocks.1/resnets.0_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.0_1/Shape"](%/down_blocks.1/resnets.0_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.1/resnets.0_1/Gather"](%/down_blocks.1/resnets.0_1/Shape_output_0, %/down_blocks.1/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.1/resnets.0_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/resnets.0_1/Add"](%/down_blocks.1/resnets.0_1/Gather_output_0, %/down_blocks.1/resnets.0_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.0_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/resnets.0_1/Div"](%/down_blocks.1/resnets.0_1/Add_output_0, %/down_blocks.1/resnets.0_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0_1/Mul_1"](%/down_blocks.1/resnets.0_1/Div_output_0, %/down_blocks.1/resnets.0_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Slice_output_0 : Float(1, 128, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.0_1/Slice"](%/down_blocks.1/resnets.0_1/Unsqueeze_1_output_0, %/down_blocks.1/resnets.0_1/Constant_3_output_0, %/down_blocks.1/resnets.0_1/Mul_1_output_0, %/down_blocks.1/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.0_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0_1/Mul_2"](%/down_blocks.1/resnets.0_1/Div_output_0, %/down_blocks.1/resnets.0_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_1/Slice_1_output_0 : Float(1, 128, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.0_1/Slice_1"](%/down_blocks.1/resnets.0_1/Unsqueeze_1_output_0, %/down_blocks.1/resnets.0_1/Mul_1_output_0, %/down_blocks.1/resnets.0_1/Mul_2_output_0, %/down_blocks.1/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.0/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_1/Reshape_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm2_1/Reshape"](%/down_blocks.1/resnets.0/conv1_1/Conv_output_0, %/down_blocks.1/resnets.0/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.0/norm2_1/InstanceNormalization"](%/down_blocks.1/resnets.0/norm2_1/Reshape_output_0, %/down_blocks.1/resnets.0/norm2_1/Constant_1_output_0, %/down_blocks.1/resnets.0/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.0/norm2_1/Shape"](%/down_blocks.1/resnets.0/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_1/Reshape_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm2_1/Reshape_1"](%/down_blocks.1/resnets.0/norm2_1/InstanceNormalization_output_0, %/down_blocks.1/resnets.0/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_1/Mul_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/norm2_1/Mul"](%/down_blocks.1/resnets.0/norm2_1/Reshape_1_output_0, %onnx::Mul_9260), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_1/Add_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0/norm2_1/Add"](%/down_blocks.1/resnets.0/norm2_1/Mul_output_0, %onnx::Add_9261), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0_1/Add_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0_1/Add_1"](%/down_blocks.1/resnets.0_1/Slice_output_0, %/down_blocks.1/resnets.0_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0_1/Mul_3_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0_1/Mul_3"](%/down_blocks.1/resnets.0/norm2_1/Add_output_0, %/down_blocks.1/resnets.0_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0_1/Add_2_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0_1/Add_2"](%/down_blocks.1/resnets.0_1/Mul_3_output_0, %/down_blocks.1/resnets.0_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0_1/Sigmoid_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.0_1/Sigmoid_1"](%/down_blocks.1/resnets.0_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0_1/Mul_4_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0_1/Mul_4"](%/down_blocks.1/resnets.0_1/Add_2_output_0, %/down_blocks.1/resnets.0_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0/conv2_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.0/conv2_1/Conv"](%/down_blocks.1/resnets.0_1/Mul_4_output_0, %inner_unet.down_blocks.1.resnets.0.conv2.weight, %inner_unet.down_blocks.1.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0/conv3/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.1/resnets.0/conv3/Conv"](%/down_blocks.0/resample_1/Conv_output_0, %inner_unet.down_blocks.1.resnets.0.conv3.weight, %inner_unet.down_blocks.1.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0_1/Add_3_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0_1/Add_3"](%/down_blocks.1/resnets.0/conv2_1/Conv_output_0, %/down_blocks.1/resnets.0/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.1/resnets.1/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.1/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_1/Reshape_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm1_1/Reshape"](%/down_blocks.1/resnets.0_1/Add_3_output_0, %/down_blocks.1/resnets.1/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.1/norm1_1/InstanceNormalization"](%/down_blocks.1/resnets.1/norm1_1/Reshape_output_0, %/down_blocks.1/resnets.1/norm1_1/Constant_1_output_0, %/down_blocks.1/resnets.1/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.1/norm1_1/Shape"](%/down_blocks.1/resnets.0_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_1/Reshape_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm1_1/Reshape_1"](%/down_blocks.1/resnets.1/norm1_1/InstanceNormalization_output_0, %/down_blocks.1/resnets.1/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_1/Mul_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/norm1_1/Mul"](%/down_blocks.1/resnets.1/norm1_1/Reshape_1_output_0, %onnx::Mul_9262), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_1/Add_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1/norm1_1/Add"](%/down_blocks.1/resnets.1/norm1_1/Mul_output_0, %onnx::Add_9263), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1_1/Sigmoid_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.1_1/Sigmoid"](%/down_blocks.1/resnets.1/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1_1/Mul_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1_1/Mul"](%/down_blocks.1/resnets.1/norm1_1/Add_output_0, %/down_blocks.1/resnets.1_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1/conv1_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.1/conv1_1/Conv"](%/down_blocks.1/resnets.1_1/Mul_output_0, %inner_unet.down_blocks.1.resnets.1.conv1.weight, %inner_unet.down_blocks.1.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.1/time_layer_1/Gemm_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.1/resnets.1/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.down_blocks.1.resnets.1.time_layer.weight, %inner_unet.down_blocks.1.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.1/resnets.1_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Unsqueeze_output_0 : Float(1, 256, 1, strides=[256, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.1_1/Unsqueeze"](%/down_blocks.1/resnets.1/time_layer_1/Gemm_output_0, %/down_blocks.1/resnets.1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Unsqueeze_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.1_1/Unsqueeze_1"](%/down_blocks.1/resnets.1_1/Unsqueeze_output_0, %/down_blocks.1/resnets.1_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.1_1/Shape"](%/down_blocks.1/resnets.1_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.1/resnets.1_1/Gather"](%/down_blocks.1/resnets.1_1/Shape_output_0, %/down_blocks.1/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.1/resnets.1_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/resnets.1_1/Add"](%/down_blocks.1/resnets.1_1/Gather_output_0, %/down_blocks.1/resnets.1_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.1_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/resnets.1_1/Div"](%/down_blocks.1/resnets.1_1/Add_output_0, %/down_blocks.1/resnets.1_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1_1/Mul_1"](%/down_blocks.1/resnets.1_1/Div_output_0, %/down_blocks.1/resnets.1_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Slice_output_0 : Float(1, 128, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.1_1/Slice"](%/down_blocks.1/resnets.1_1/Unsqueeze_1_output_0, %/down_blocks.1/resnets.1_1/Constant_3_output_0, %/down_blocks.1/resnets.1_1/Mul_1_output_0, %/down_blocks.1/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.1_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1_1/Mul_2"](%/down_blocks.1/resnets.1_1/Div_output_0, %/down_blocks.1/resnets.1_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_1/Slice_1_output_0 : Float(1, 128, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.1_1/Slice_1"](%/down_blocks.1/resnets.1_1/Unsqueeze_1_output_0, %/down_blocks.1/resnets.1_1/Mul_1_output_0, %/down_blocks.1/resnets.1_1/Mul_2_output_0, %/down_blocks.1/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.1/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_1/Reshape_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm2_1/Reshape"](%/down_blocks.1/resnets.1/conv1_1/Conv_output_0, %/down_blocks.1/resnets.1/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.1/norm2_1/InstanceNormalization"](%/down_blocks.1/resnets.1/norm2_1/Reshape_output_0, %/down_blocks.1/resnets.1/norm2_1/Constant_1_output_0, %/down_blocks.1/resnets.1/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.1/norm2_1/Shape"](%/down_blocks.1/resnets.1/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_1/Reshape_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm2_1/Reshape_1"](%/down_blocks.1/resnets.1/norm2_1/InstanceNormalization_output_0, %/down_blocks.1/resnets.1/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_1/Mul_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/norm2_1/Mul"](%/down_blocks.1/resnets.1/norm2_1/Reshape_1_output_0, %onnx::Mul_9264), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_1/Add_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1/norm2_1/Add"](%/down_blocks.1/resnets.1/norm2_1/Mul_output_0, %onnx::Add_9265), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1_1/Add_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1_1/Add_1"](%/down_blocks.1/resnets.1_1/Slice_output_0, %/down_blocks.1/resnets.1_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1_1/Mul_3_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1_1/Mul_3"](%/down_blocks.1/resnets.1/norm2_1/Add_output_0, %/down_blocks.1/resnets.1_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1_1/Add_2_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1_1/Add_2"](%/down_blocks.1/resnets.1_1/Mul_3_output_0, %/down_blocks.1/resnets.1_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1_1/Sigmoid_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.1_1/Sigmoid_1"](%/down_blocks.1/resnets.1_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1_1/Mul_4_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1_1/Mul_4"](%/down_blocks.1/resnets.1_1/Add_2_output_0, %/down_blocks.1/resnets.1_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1/conv2_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.1/conv2_1/Conv"](%/down_blocks.1/resnets.1_1/Mul_4_output_0, %inner_unet.down_blocks.1.resnets.1.conv2.weight, %inner_unet.down_blocks.1.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.1_1/Add_3_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1_1/Add_3"](%/down_blocks.1/resnets.1/conv2_1/Conv_output_0, %/down_blocks.1/resnets.0_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.1/resample_1/Conv_output_0 : Float(1, 128, 8, 4, strides=[4096, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[2, 2], onnx_name="/down_blocks.1/resample_1/Conv"](%/down_blocks.1/resnets.1_1/Add_3_output_0, %inner_unet.down_blocks.1.resample.weight, %inner_unet.down_blocks.1.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/resnets.0/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_1/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm1_1/Reshape"](%/down_blocks.1/resample_1/Conv_output_0, %/down_blocks.2/resnets.0/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/resnets.0/norm1_1/InstanceNormalization"](%/down_blocks.2/resnets.0/norm1_1/Reshape_output_0, %/down_blocks.2/resnets.0/norm1_1/Constant_1_output_0, %/down_blocks.2/resnets.0/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.0/norm1_1/Shape"](%/down_blocks.1/resample_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_1/Reshape_1_output_0 : Float(1, 128, 8, 4, strides=[4096, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm1_1/Reshape_1"](%/down_blocks.2/resnets.0/norm1_1/InstanceNormalization_output_0, %/down_blocks.2/resnets.0/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_1/Mul_output_0 : Float(1, 128, 8, 4, strides=[4096, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/norm1_1/Mul"](%/down_blocks.2/resnets.0/norm1_1/Reshape_1_output_0, %onnx::Mul_9266), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_1/Add_output_0 : Float(1, 128, 8, 4, strides=[4096, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0/norm1_1/Add"](%/down_blocks.2/resnets.0/norm1_1/Mul_output_0, %onnx::Add_9267), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0_1/Sigmoid_output_0 : Float(1, 128, 8, 4, strides=[4096, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.2/resnets.0_1/Sigmoid"](%/down_blocks.2/resnets.0/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0_1/Mul_output_0 : Float(1, 128, 8, 4, strides=[4096, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0_1/Mul"](%/down_blocks.2/resnets.0/norm1_1/Add_output_0, %/down_blocks.2/resnets.0_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0/conv1_1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.2/resnets.0/conv1_1/Conv"](%/down_blocks.2/resnets.0_1/Mul_output_0, %inner_unet.down_blocks.2.resnets.0.conv1.weight, %inner_unet.down_blocks.2.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0/time_layer_1/Gemm_output_0 : Float(1, 512, strides=[512, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.2/resnets.0/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.down_blocks.2.resnets.0.time_layer.weight, %inner_unet.down_blocks.2.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/resnets.0_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.2/resnets.0_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Unsqueeze_output_0 : Float(1, 512, 1, strides=[512, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.2/resnets.0_1/Unsqueeze"](%/down_blocks.2/resnets.0/time_layer_1/Gemm_output_0, %/down_blocks.2/resnets.0_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.2/resnets.0_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Unsqueeze_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.2/resnets.0_1/Unsqueeze_1"](%/down_blocks.2/resnets.0_1/Unsqueeze_output_0, %/down_blocks.2/resnets.0_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.0_1/Shape"](%/down_blocks.2/resnets.0_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/resnets.0_1/Gather"](%/down_blocks.2/resnets.0_1/Shape_output_0, %/down_blocks.2/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/resnets.0_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/resnets.0_1/Add"](%/down_blocks.2/resnets.0_1/Gather_output_0, %/down_blocks.2/resnets.0_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/resnets.0_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/resnets.0_1/Div"](%/down_blocks.2/resnets.0_1/Add_output_0, %/down_blocks.2/resnets.0_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0_1/Mul_1"](%/down_blocks.2/resnets.0_1/Div_output_0, %/down_blocks.2/resnets.0_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Slice_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/resnets.0_1/Slice"](%/down_blocks.2/resnets.0_1/Unsqueeze_1_output_0, %/down_blocks.2/resnets.0_1/Constant_3_output_0, %/down_blocks.2/resnets.0_1/Mul_1_output_0, %/down_blocks.2/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/resnets.0_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0_1/Mul_2"](%/down_blocks.2/resnets.0_1/Div_output_0, %/down_blocks.2/resnets.0_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_1/Slice_1_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/resnets.0_1/Slice_1"](%/down_blocks.2/resnets.0_1/Unsqueeze_1_output_0, %/down_blocks.2/resnets.0_1/Mul_1_output_0, %/down_blocks.2/resnets.0_1/Mul_2_output_0, %/down_blocks.2/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/resnets.0/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_1/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm2_1/Reshape"](%/down_blocks.2/resnets.0/conv1_1/Conv_output_0, %/down_blocks.2/resnets.0/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/resnets.0/norm2_1/InstanceNormalization"](%/down_blocks.2/resnets.0/norm2_1/Reshape_output_0, %/down_blocks.2/resnets.0/norm2_1/Constant_1_output_0, %/down_blocks.2/resnets.0/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.0/norm2_1/Shape"](%/down_blocks.2/resnets.0/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_1/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm2_1/Reshape_1"](%/down_blocks.2/resnets.0/norm2_1/InstanceNormalization_output_0, %/down_blocks.2/resnets.0/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_1/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/norm2_1/Mul"](%/down_blocks.2/resnets.0/norm2_1/Reshape_1_output_0, %onnx::Mul_9268), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_1/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0/norm2_1/Add"](%/down_blocks.2/resnets.0/norm2_1/Mul_output_0, %onnx::Add_9269), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0_1/Add_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0_1/Add_1"](%/down_blocks.2/resnets.0_1/Slice_output_0, %/down_blocks.2/resnets.0_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0_1/Mul_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0_1/Mul_3"](%/down_blocks.2/resnets.0/norm2_1/Add_output_0, %/down_blocks.2/resnets.0_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0_1/Add_2_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0_1/Add_2"](%/down_blocks.2/resnets.0_1/Mul_3_output_0, %/down_blocks.2/resnets.0_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0_1/Sigmoid_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.2/resnets.0_1/Sigmoid_1"](%/down_blocks.2/resnets.0_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0_1/Mul_4_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0_1/Mul_4"](%/down_blocks.2/resnets.0_1/Add_2_output_0, %/down_blocks.2/resnets.0_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0/conv2_1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.2/resnets.0/conv2_1/Conv"](%/down_blocks.2/resnets.0_1/Mul_4_output_0, %inner_unet.down_blocks.2.resnets.0.conv2.weight, %inner_unet.down_blocks.2.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0/conv3_1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/resnets.0/conv3_1/Conv"](%/down_blocks.1/resample_1/Conv_output_0, %inner_unet.down_blocks.2.resnets.0.conv3.weight, %inner_unet.down_blocks.2.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0_1/Add_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0_1/Add_3"](%/down_blocks.2/resnets.0/conv2_1/Conv_output_0, %/down_blocks.2/resnets.0/conv3_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/in_adapter_1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/in_adapter_1/Conv"](%/down_blocks.2/resnets.0_1/Add_3_output_0, %inner_unet.in_adapter.weight, %inner_unet.in_adapter.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.conv.Conv2d::in_adapter # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/temb_layer1_2/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/temb_layer1_2/Gemm"](%/Cast_4_output_0, %inner_unet.inner_unet.temb_layer1.weight, %inner_unet.inner_unet.temb_layer1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::temb_layer1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Sigmoid_4_output_0 : Float(1, 1024, strides=[1024, 1], device=cpu) = onnx::Sigmoid[onnx_name="/Sigmoid_4"](%/temb_layer1_2/Gemm_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/Mul_12_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_12"](%/temb_layer1_2/Gemm_output_0, %/Sigmoid_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/temb_layer2_2/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/temb_layer2_2/Gemm"](%/Mul_12_output_0, %inner_unet.inner_unet.temb_layer2.weight, %inner_unet.inner_unet.temb_layer2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::temb_layer2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Add_5_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/Add_5"](%/temb_layer2_2/Gemm_output_0, %/cond_emb/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1081:0
  %/Constant_23_output_0 : Double(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_23"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Constant_24_output_0 : Double(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/Constant_24"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %onnx::Clip_1767 : Tensor? = prim::Constant(), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Clip_2_output_0 : Double(1, strides=[1], requires_grad=0, device=cuda:0) = onnx::Clip[onnx_name="/Clip_2"](%/Constant_23_output_0, %onnx::Clip_1767, %/Constant_24_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Constant_25_output_0 : Double(requires_grad=0, device=cpu) = onnx::Constant[value={64}, onnx_name="/Constant_25"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Mul_13_output_0 : Double(1, strides=[1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_13"](%/Clip_2_output_0, %/Constant_25_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1062:0
  %/Constant_26_output_0 : Long(2, strides=[1], device=cpu) = onnx::Constant[value=-1  1 [ CPULongType{2} ], onnx_name="/Constant_26"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Reshape_3_output_0 : Double(1, 1, strides=[1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/Reshape_3"](%/Mul_13_output_0, %/Constant_26_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Constant_27_output_0 : Double(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Constant[value=<Tensor>, onnx_name="/Constant_27"](), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Mul_14_output_0 : Double(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_14"](%/Reshape_3_output_0, %/Constant_27_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:946:0
  %/Cast_10_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast_10"](%/Mul_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:947:0
  %/Sin_3_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Sin[onnx_name="/Sin_3"](%/Cast_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Cos_3_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Cos[onnx_name="/Cos_3"](%/Cast_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Concat_3_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/Concat_3"](%/Sin_3_output_0, %/Cos_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:950:0
  %/Cast_11_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/Cast_11"](%/Concat_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:960:0
  %/scale.0_2/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/scale.0_2/Gemm"](%/Cast_11_output_0, %inner_unet.inner_unet.cond_layers.scale.0.weight, %inner_unet.inner_unet.cond_layers.scale.0.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::scale.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Sigmoid_5_output_0 : Float(1, 1024, strides=[1024, 1], device=cpu) = onnx::Sigmoid[onnx_name="/Sigmoid_5"](%/scale.0_2/Gemm_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/Mul_15_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_15"](%/scale.0_2/Gemm_output_0, %/Sigmoid_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/scale.1_2/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/scale.1_2/Gemm"](%/Mul_15_output_0, %inner_unet.inner_unet.cond_layers.scale.1.weight, %inner_unet.inner_unet.cond_layers.scale.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.linear.Linear::scale.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/Add_6_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/Add_6"](%/Add_5_output_0, %/scale.1_2/Gemm_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1084:0
  %/conv_in_2/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/conv_in_2/Conv"](%in_3, %inner_unet.inner_unet.conv_in.weight, %inner_unet.inner_unet.conv_in.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.conv.Conv2d::conv_in # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/Add_7_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/Add_7"](%/conv_in_2/Conv_output_0, %/in_adapter_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:1092:0
  %/down_blocks.0/resnets.0/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.0/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_2/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm1_2/Reshape"](%/Add_7_output_0, %/down_blocks.0/resnets.0/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.0/norm1_2/InstanceNormalization"](%/down_blocks.0/resnets.0/norm1_2/Reshape_output_0, %/down_blocks.0/resnets.0/norm1_2/Constant_1_output_0, %/down_blocks.0/resnets.0/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.0/norm1_2/Shape"](%/Add_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_2/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm1_2/Reshape_1"](%/down_blocks.0/resnets.0/norm1_2/InstanceNormalization_output_0, %/down_blocks.0/resnets.0/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_2/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/norm1_2/Mul"](%/down_blocks.0/resnets.0/norm1_2/Reshape_1_output_0, %onnx::Mul_9272), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm1_2/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0/norm1_2/Add"](%/down_blocks.0/resnets.0/norm1_2/Mul_output_0, %onnx::Add_9273), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0_2/Sigmoid_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.0_2/Sigmoid"](%/down_blocks.0/resnets.0/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0_2/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_2/Mul"](%/down_blocks.0/resnets.0/norm1_2/Add_output_0, %/down_blocks.0/resnets.0_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/conv1_2/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.0/conv1_2/Conv"](%/down_blocks.0/resnets.0_2/Mul_output_0, %inner_unet.inner_unet.down_blocks.0.resnets.0.conv1.weight, %inner_unet.inner_unet.down_blocks.0.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.0_2/Sigmoid_1_output_0 : Float(1, 1024, strides=[1024, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.0_2/Sigmoid_1"](%/Add_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0_2/Mul_1_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_2/Mul_1"](%/Add_6_output_0, %/down_blocks.0/resnets.0_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/time_layer_2/Gemm_output_0 : Float(1, 512, strides=[512, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.0/resnets.0/time_layer_2/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.0.resnets.0.time_layer.weight, %inner_unet.inner_unet.down_blocks.0.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.0/resnets.0_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.0_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Unsqueeze_output_0 : Float(1, 512, 1, strides=[512, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.0_2/Unsqueeze"](%/down_blocks.0/resnets.0/time_layer_2/Gemm_output_0, %/down_blocks.0/resnets.0_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.0_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Unsqueeze_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.0_2/Unsqueeze_1"](%/down_blocks.0/resnets.0_2/Unsqueeze_output_0, %/down_blocks.0/resnets.0_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.0_2/Shape"](%/down_blocks.0/resnets.0_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.0/resnets.0_2/Gather"](%/down_blocks.0/resnets.0_2/Shape_output_0, %/down_blocks.0/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.0/resnets.0_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.0/resnets.0_2/Add"](%/down_blocks.0/resnets.0_2/Gather_output_0, %/down_blocks.0/resnets.0_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.0_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.0/resnets.0_2/Div"](%/down_blocks.0/resnets.0_2/Add_output_0, %/down_blocks.0/resnets.0_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_2/Mul_2"](%/down_blocks.0/resnets.0_2/Div_output_0, %/down_blocks.0/resnets.0_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Slice_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.0_2/Slice"](%/down_blocks.0/resnets.0_2/Unsqueeze_1_output_0, %/down_blocks.0/resnets.0_2/Constant_3_output_0, %/down_blocks.0/resnets.0_2/Mul_2_output_0, %/down_blocks.0/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.0_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Mul_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_2/Mul_3"](%/down_blocks.0/resnets.0_2/Div_output_0, %/down_blocks.0/resnets.0_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0_2/Slice_1_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.0_2/Slice_1"](%/down_blocks.0/resnets.0_2/Unsqueeze_1_output_0, %/down_blocks.0/resnets.0_2/Mul_2_output_0, %/down_blocks.0/resnets.0_2/Mul_3_output_0, %/down_blocks.0/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.0/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.0/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_2/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm2_2/Reshape"](%/down_blocks.0/resnets.0/conv1_2/Conv_output_0, %/down_blocks.0/resnets.0/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.0/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.0/norm2_2/InstanceNormalization"](%/down_blocks.0/resnets.0/norm2_2/Reshape_output_0, %/down_blocks.0/resnets.0/norm2_2/Constant_1_output_0, %/down_blocks.0/resnets.0/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.0/norm2_2/Shape"](%/down_blocks.0/resnets.0/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_2/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.0/norm2_2/Reshape_1"](%/down_blocks.0/resnets.0/norm2_2/InstanceNormalization_output_0, %/down_blocks.0/resnets.0/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_2/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0/norm2_2/Mul"](%/down_blocks.0/resnets.0/norm2_2/Reshape_1_output_0, %onnx::Mul_9274), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0/norm2_2/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0/norm2_2/Add"](%/down_blocks.0/resnets.0/norm2_2/Mul_output_0, %onnx::Add_9275), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.0_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.0_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0_2/Add_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0_2/Add_1"](%/down_blocks.0/resnets.0_2/Slice_output_0, %/down_blocks.0/resnets.0_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0_2/Mul_4_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_2/Mul_4"](%/down_blocks.0/resnets.0/norm2_2/Add_output_0, %/down_blocks.0/resnets.0_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0_2/Add_2_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0_2/Add_2"](%/down_blocks.0/resnets.0_2/Mul_4_output_0, %/down_blocks.0/resnets.0_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.0_2/Sigmoid_2_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.0_2/Sigmoid_2"](%/down_blocks.0/resnets.0_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0_2/Mul_5_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.0_2/Mul_5"](%/down_blocks.0/resnets.0_2/Add_2_output_0, %/down_blocks.0/resnets.0_2/Sigmoid_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.0/conv2_2/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.0/conv2_2/Conv"](%/down_blocks.0/resnets.0_2/Mul_5_output_0, %inner_unet.inner_unet.down_blocks.0.resnets.0.conv2.weight, %inner_unet.inner_unet.down_blocks.0.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.0_2/Add_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.0_2/Add_3"](%/down_blocks.0/resnets.0/conv2_2/Conv_output_0, %/Add_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.0/resnets.1/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.1/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_2/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm1_2/Reshape"](%/down_blocks.0/resnets.0_2/Add_3_output_0, %/down_blocks.0/resnets.1/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.1/norm1_2/InstanceNormalization"](%/down_blocks.0/resnets.1/norm1_2/Reshape_output_0, %/down_blocks.0/resnets.1/norm1_2/Constant_1_output_0, %/down_blocks.0/resnets.1/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.1/norm1_2/Shape"](%/down_blocks.0/resnets.0_2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_2/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm1_2/Reshape_1"](%/down_blocks.0/resnets.1/norm1_2/InstanceNormalization_output_0, %/down_blocks.0/resnets.1/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_2/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/norm1_2/Mul"](%/down_blocks.0/resnets.1/norm1_2/Reshape_1_output_0, %onnx::Mul_9276), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm1_2/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1/norm1_2/Add"](%/down_blocks.0/resnets.1/norm1_2/Mul_output_0, %onnx::Add_9277), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1_2/Sigmoid_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.1_2/Sigmoid"](%/down_blocks.0/resnets.1/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1_2/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1_2/Mul"](%/down_blocks.0/resnets.1/norm1_2/Add_output_0, %/down_blocks.0/resnets.1_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1/conv1_2/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.1/conv1_2/Conv"](%/down_blocks.0/resnets.1_2/Mul_output_0, %inner_unet.inner_unet.down_blocks.0.resnets.1.conv1.weight, %inner_unet.inner_unet.down_blocks.0.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.1/time_layer_2/Gemm_output_0 : Float(1, 512, strides=[512, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.0/resnets.1/time_layer_2/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.0.resnets.1.time_layer.weight, %inner_unet.inner_unet.down_blocks.0.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.0/resnets.1_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Unsqueeze_output_0 : Float(1, 512, 1, strides=[512, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.1_2/Unsqueeze"](%/down_blocks.0/resnets.1/time_layer_2/Gemm_output_0, %/down_blocks.0/resnets.1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.0/resnets.1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Unsqueeze_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.0/resnets.1_2/Unsqueeze_1"](%/down_blocks.0/resnets.1_2/Unsqueeze_output_0, %/down_blocks.0/resnets.1_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.1_2/Shape"](%/down_blocks.0/resnets.1_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.0/resnets.1_2/Gather"](%/down_blocks.0/resnets.1_2/Shape_output_0, %/down_blocks.0/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.0/resnets.1_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.0/resnets.1_2/Add"](%/down_blocks.0/resnets.1_2/Gather_output_0, %/down_blocks.0/resnets.1_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.1_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.0/resnets.1_2/Div"](%/down_blocks.0/resnets.1_2/Add_output_0, %/down_blocks.0/resnets.1_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1_2/Mul_1"](%/down_blocks.0/resnets.1_2/Div_output_0, %/down_blocks.0/resnets.1_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Slice_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.1_2/Slice"](%/down_blocks.0/resnets.1_2/Unsqueeze_1_output_0, %/down_blocks.0/resnets.1_2/Constant_3_output_0, %/down_blocks.0/resnets.1_2/Mul_1_output_0, %/down_blocks.0/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.0/resnets.1_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1_2/Mul_2"](%/down_blocks.0/resnets.1_2/Div_output_0, %/down_blocks.0/resnets.1_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1_2/Slice_1_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.0/resnets.1_2/Slice_1"](%/down_blocks.0/resnets.1_2/Unsqueeze_1_output_0, %/down_blocks.0/resnets.1_2/Mul_1_output_0, %/down_blocks.0/resnets.1_2/Mul_2_output_0, %/down_blocks.0/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.0/resnets.1/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.0/resnets.1/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_2/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm2_2/Reshape"](%/down_blocks.0/resnets.1/conv1_2/Conv_output_0, %/down_blocks.0/resnets.1/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.0/resnets.1/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.0/resnets.1/norm2_2/InstanceNormalization"](%/down_blocks.0/resnets.1/norm2_2/Reshape_output_0, %/down_blocks.0/resnets.1/norm2_2/Constant_1_output_0, %/down_blocks.0/resnets.1/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.0/resnets.1/norm2_2/Shape"](%/down_blocks.0/resnets.1/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_2/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.0/resnets.1/norm2_2/Reshape_1"](%/down_blocks.0/resnets.1/norm2_2/InstanceNormalization_output_0, %/down_blocks.0/resnets.1/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_2/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1/norm2_2/Mul"](%/down_blocks.0/resnets.1/norm2_2/Reshape_1_output_0, %onnx::Mul_9278), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1/norm2_2/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1/norm2_2/Add"](%/down_blocks.0/resnets.1/norm2_2/Mul_output_0, %onnx::Add_9279), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.0/resnets.1_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.0/resnets.1_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1_2/Add_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1_2/Add_1"](%/down_blocks.0/resnets.1_2/Slice_output_0, %/down_blocks.0/resnets.1_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1_2/Mul_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1_2/Mul_3"](%/down_blocks.0/resnets.1/norm2_2/Add_output_0, %/down_blocks.0/resnets.1_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1_2/Add_2_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1_2/Add_2"](%/down_blocks.0/resnets.1_2/Mul_3_output_0, %/down_blocks.0/resnets.1_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.0/resnets.1_2/Sigmoid_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.0/resnets.1_2/Sigmoid_1"](%/down_blocks.0/resnets.1_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1_2/Mul_4_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.0/resnets.1_2/Mul_4"](%/down_blocks.0/resnets.1_2/Add_2_output_0, %/down_blocks.0/resnets.1_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.0/resnets.1/conv2_2/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.0/resnets.1/conv2_2/Conv"](%/down_blocks.0/resnets.1_2/Mul_4_output_0, %inner_unet.inner_unet.down_blocks.0.resnets.1.conv2.weight, %inner_unet.inner_unet.down_blocks.0.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.0/resnets.1_2/Add_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.0/resnets.1_2/Add_3"](%/down_blocks.0/resnets.1/conv2_2/Conv_output_0, %/down_blocks.0/resnets.0_2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.0/resample_2/Conv_output_0 : Float(1, 256, 4, 2, strides=[2048, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[2, 2], onnx_name="/down_blocks.0/resample_2/Conv"](%/down_blocks.0/resnets.1_2/Add_3_output_0, %inner_unet.inner_unet.down_blocks.0.resample.weight, %inner_unet.inner_unet.down_blocks.0.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.0/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.0/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_2/Reshape_output_0 : Float(1, 32, 64, strides=[2048, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm1_2/Reshape"](%/down_blocks.0/resample_2/Conv_output_0, %/down_blocks.1/resnets.0/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 64, strides=[2048, 64, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.0/norm1_2/InstanceNormalization"](%/down_blocks.1/resnets.0/norm1_2/Reshape_output_0, %/down_blocks.1/resnets.0/norm1_2/Constant_1_output_0, %/down_blocks.1/resnets.0/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.0/norm1_2/Shape"](%/down_blocks.0/resample_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_2/Reshape_1_output_0 : Float(1, 256, 4, 2, strides=[2048, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm1_2/Reshape_1"](%/down_blocks.1/resnets.0/norm1_2/InstanceNormalization_output_0, %/down_blocks.1/resnets.0/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_2/Mul_output_0 : Float(1, 256, 4, 2, strides=[2048, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/norm1_2/Mul"](%/down_blocks.1/resnets.0/norm1_2/Reshape_1_output_0, %onnx::Mul_9280), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm1_2/Add_output_0 : Float(1, 256, 4, 2, strides=[2048, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0/norm1_2/Add"](%/down_blocks.1/resnets.0/norm1_2/Mul_output_0, %onnx::Add_9281), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0_2/Sigmoid_output_0 : Float(1, 256, 4, 2, strides=[2048, 8, 2, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.0_2/Sigmoid"](%/down_blocks.1/resnets.0/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0_2/Mul_output_0 : Float(1, 256, 4, 2, strides=[2048, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0_2/Mul"](%/down_blocks.1/resnets.0/norm1_2/Add_output_0, %/down_blocks.1/resnets.0_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0/conv1_2/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.0/conv1_2/Conv"](%/down_blocks.1/resnets.0_2/Mul_output_0, %inner_unet.inner_unet.down_blocks.1.resnets.0.conv1.weight, %inner_unet.inner_unet.down_blocks.1.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0/time_layer_2/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.1/resnets.0/time_layer_2/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.1.resnets.0.time_layer.weight, %inner_unet.inner_unet.down_blocks.1.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.1/resnets.0_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.0_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Unsqueeze_output_0 : Float(1, 1024, 1, strides=[1024, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.0_2/Unsqueeze"](%/down_blocks.1/resnets.0/time_layer_2/Gemm_output_0, %/down_blocks.1/resnets.0_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.0_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Unsqueeze_1_output_0 : Float(1, 1024, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.0_2/Unsqueeze_1"](%/down_blocks.1/resnets.0_2/Unsqueeze_output_0, %/down_blocks.1/resnets.0_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.0_2/Shape"](%/down_blocks.1/resnets.0_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.1/resnets.0_2/Gather"](%/down_blocks.1/resnets.0_2/Shape_output_0, %/down_blocks.1/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.1/resnets.0_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/resnets.0_2/Add"](%/down_blocks.1/resnets.0_2/Gather_output_0, %/down_blocks.1/resnets.0_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.0_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/resnets.0_2/Div"](%/down_blocks.1/resnets.0_2/Add_output_0, %/down_blocks.1/resnets.0_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0_2/Mul_1"](%/down_blocks.1/resnets.0_2/Div_output_0, %/down_blocks.1/resnets.0_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Slice_output_0 : Float(1, 512, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.0_2/Slice"](%/down_blocks.1/resnets.0_2/Unsqueeze_1_output_0, %/down_blocks.1/resnets.0_2/Constant_3_output_0, %/down_blocks.1/resnets.0_2/Mul_1_output_0, %/down_blocks.1/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.0_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0_2/Mul_2"](%/down_blocks.1/resnets.0_2/Div_output_0, %/down_blocks.1/resnets.0_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0_2/Slice_1_output_0 : Float(1, 512, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.0_2/Slice_1"](%/down_blocks.1/resnets.0_2/Unsqueeze_1_output_0, %/down_blocks.1/resnets.0_2/Mul_1_output_0, %/down_blocks.1/resnets.0_2/Mul_2_output_0, %/down_blocks.1/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.0/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.0/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_2/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm2_2/Reshape"](%/down_blocks.1/resnets.0/conv1_2/Conv_output_0, %/down_blocks.1/resnets.0/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.0/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.0/norm2_2/InstanceNormalization"](%/down_blocks.1/resnets.0/norm2_2/Reshape_output_0, %/down_blocks.1/resnets.0/norm2_2/Constant_1_output_0, %/down_blocks.1/resnets.0/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.0/norm2_2/Shape"](%/down_blocks.1/resnets.0/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_2/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.0/norm2_2/Reshape_1"](%/down_blocks.1/resnets.0/norm2_2/InstanceNormalization_output_0, %/down_blocks.1/resnets.0/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_2/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0/norm2_2/Mul"](%/down_blocks.1/resnets.0/norm2_2/Reshape_1_output_0, %onnx::Mul_9282), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0/norm2_2/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0/norm2_2/Add"](%/down_blocks.1/resnets.0/norm2_2/Mul_output_0, %onnx::Add_9283), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.0_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.0_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0_2/Add_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0_2/Add_1"](%/down_blocks.1/resnets.0_2/Slice_output_0, %/down_blocks.1/resnets.0_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0_2/Mul_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0_2/Mul_3"](%/down_blocks.1/resnets.0/norm2_2/Add_output_0, %/down_blocks.1/resnets.0_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0_2/Add_2_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0_2/Add_2"](%/down_blocks.1/resnets.0_2/Mul_3_output_0, %/down_blocks.1/resnets.0_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.0_2/Sigmoid_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.0_2/Sigmoid_1"](%/down_blocks.1/resnets.0_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0_2/Mul_4_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.0_2/Mul_4"](%/down_blocks.1/resnets.0_2/Add_2_output_0, %/down_blocks.1/resnets.0_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.0/conv2_2/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.0/conv2_2/Conv"](%/down_blocks.1/resnets.0_2/Mul_4_output_0, %inner_unet.inner_unet.down_blocks.1.resnets.0.conv2.weight, %inner_unet.inner_unet.down_blocks.1.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0/conv3_1/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.1/resnets.0/conv3_1/Conv"](%/down_blocks.0/resample_2/Conv_output_0, %inner_unet.inner_unet.down_blocks.1.resnets.0.conv3.weight, %inner_unet.inner_unet.down_blocks.1.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.0_2/Add_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.0_2/Add_3"](%/down_blocks.1/resnets.0/conv2_2/Conv_output_0, %/down_blocks.1/resnets.0/conv3_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.1/attn.0/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.0/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/norm/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/norm/Reshape"](%/down_blocks.1/resnets.0_2/Add_3_output_0, %/down_blocks.1/attn.0/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/attn.0/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/attn.0/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/norm/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/attn.0/norm/InstanceNormalization"](%/down_blocks.1/attn.0/norm/Reshape_output_0, %/down_blocks.1/attn.0/norm/Constant_1_output_0, %/down_blocks.1/attn.0/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/attn.0/norm/Shape"](%/down_blocks.1/resnets.0_2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/norm/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/norm/Reshape_1"](%/down_blocks.1/attn.0/norm/InstanceNormalization_output_0, %/down_blocks.1/attn.0/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/norm/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/norm/Mul"](%/down_blocks.1/attn.0/norm/Reshape_1_output_0, %onnx::Mul_9284), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/norm/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.0/norm/Add"](%/down_blocks.1/attn.0/norm/Mul_output_0, %onnx::Add_9285), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/qkv/Conv_output_0 : Float(1, 1536, 4, 2, strides=[12288, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.1/attn.0/qkv/Conv"](%/down_blocks.1/attn.0/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.1.attn.0.qkv.weight, %inner_unet.inner_unet.down_blocks.1.attn.0.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/attn.0/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  1536    -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Reshape_output_0 : Float(1, 1536, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/Reshape"](%/down_blocks.1/attn.0/qkv/Conv_output_0, %/down_blocks.1/attn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/attn.0/Shape"](%/down_blocks.1/attn.0/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.1/attn.0/Gather"](%/down_blocks.1/attn.0/Shape_output_0, %/down_blocks.1/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.1/attn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/attn.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/attn.0/Add"](%/down_blocks.1/attn.0/Gather_output_0, %/down_blocks.1/attn.0/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.1/attn.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/attn.0/Div"](%/down_blocks.1/attn.0/Add_output_0, %/down_blocks.1/attn.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/Mul"](%/down_blocks.1/attn.0/Div_output_0, %/down_blocks.1/attn.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Slice_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/attn.0/Slice"](%/down_blocks.1/attn.0/Reshape_output_0, %/down_blocks.1/attn.0/Constant_2_output_0, %/down_blocks.1/attn.0/Mul_output_0, %/down_blocks.1/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/attn.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/Mul_1"](%/down_blocks.1/attn.0/Div_output_0, %/down_blocks.1/attn.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Slice_1_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/attn.0/Slice_1"](%/down_blocks.1/attn.0/Reshape_output_0, %/down_blocks.1/attn.0/Mul_output_0, %/down_blocks.1/attn.0/Mul_1_output_0, %/down_blocks.1/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.1/attn.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/Mul_2"](%/down_blocks.1/attn.0/Div_output_0, %/down_blocks.1/attn.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Slice_2_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/attn.0/Slice_2"](%/down_blocks.1/attn.0/Reshape_output_0, %/down_blocks.1/attn.0/Mul_1_output_0, %/down_blocks.1/attn.0/Mul_2_output_0, %/down_blocks.1/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.0/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={2.82843}, onnx_name="/down_blocks.1/attn.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.1/attn.0/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.1/attn.0/Reciprocal"](%/down_blocks.1/attn.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.1/attn.0/Mul_3_output_0 : Float(1, 512, 8, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/Mul_3"](%/down_blocks.1/attn.0/Slice_output_0, %/down_blocks.1/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.1/attn.0/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64   8 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.0/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.1/attn.0/Reshape_1_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/Reshape_1"](%/down_blocks.1/attn.0/Mul_3_output_0, %/down_blocks.1/attn.0/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.1/attn.0/Mul_4_output_0 : Float(1, 512, 8, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/Mul_4"](%/down_blocks.1/attn.0/Slice_1_output_0, %/down_blocks.1/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.0/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.0/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.0/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.0/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.1/attn.0/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.0/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.0/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.0/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.1/attn.0/Reshape_2_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/Reshape_2"](%/down_blocks.1/attn.0/Mul_4_output_0, %/down_blocks.1/attn.0/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.0/Einsum_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.1/attn.0/Einsum"](%/down_blocks.1/attn.0/Reshape_1_output_0, %/down_blocks.1/attn.0/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.1/attn.0/Cast_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.1/attn.0/Cast"](%/down_blocks.1/attn.0/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.0/Softmax_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.1/attn.0/Softmax"](%/down_blocks.1/attn.0/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.0/Cast_1_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.1/attn.0/Cast_1"](%/down_blocks.1/attn.0/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.0/Reshape_3_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/Reshape_3"](%/down_blocks.1/attn.0/Slice_2_output_0, %/down_blocks.1/attn.0/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.1/attn.0/Einsum_1_output_0 : Float(*, *, *, strides=[512, 1, 64], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.1/attn.0/Einsum_1"](%/down_blocks.1/attn.0/Cast_1_output_0, %/down_blocks.1/attn.0/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.1/attn.0/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  8 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.0/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.1/attn.0/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  8 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.0/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.1/attn.0/Reshape_4_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/Reshape_4"](%/down_blocks.1/attn.0/Einsum_1_output_0, %/down_blocks.1/attn.0/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.1/attn.0/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/attn.0/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.1.attn.0.norm_cond.weight, %inner_unet.inner_unet.down_blocks.1.attn.0.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.1/attn.0/kv_cond/MatMul_output_0 : Float(1, 128, 1024, strides=[131072, 1024, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.1/attn.0/kv_cond/MatMul"](%/down_blocks.1/attn.0/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9318), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.1/attn.0/kv_cond/Add_output_0 : Float(1, 128, 1024, strides=[131072, 1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.0/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.1.attn.0.kv_cond.bias, %/down_blocks.1/attn.0/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.1/attn.0/Transpose_output_0 : Float(1, 1024, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.1/attn.0/Transpose"](%/down_blocks.1/attn.0/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.1/attn.0/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/attn.0/Shape_1"](%/down_blocks.1/attn.0/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.0/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.1/attn.0/Gather_1"](%/down_blocks.1/attn.0/Shape_1_output_0, %/down_blocks.1/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.1/attn.0/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.0/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/attn.0/Add_1"](%/down_blocks.1/attn.0/Gather_1_output_0, %/down_blocks.1/attn.0/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/attn.0/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/attn.0/Div_1"](%/down_blocks.1/attn.0/Add_1_output_0, %/down_blocks.1/attn.0/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.0/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/Mul_5"](%/down_blocks.1/attn.0/Div_1_output_0, %/down_blocks.1/attn.0/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Slice_3_output_0 : Float(1, 512, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/attn.0/Slice_3"](%/down_blocks.1/attn.0/Transpose_output_0, %/down_blocks.1/attn.0/Constant_17_output_0, %/down_blocks.1/attn.0/Mul_5_output_0, %/down_blocks.1/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/attn.0/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/Mul_6"](%/down_blocks.1/attn.0/Div_1_output_0, %/down_blocks.1/attn.0/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Slice_4_output_0 : Float(1, 512, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/attn.0/Slice_4"](%/down_blocks.1/attn.0/Transpose_output_0, %/down_blocks.1/attn.0/Mul_5_output_0, %/down_blocks.1/attn.0/Mul_6_output_0, %/down_blocks.1/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.0/Mul_7_output_0 : Float(1, 512, 128, strides=[65536, 1, 512], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/Mul_7"](%/down_blocks.1/attn.0/Slice_3_output_0, %/down_blocks.1/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.0/Reshape_5_output_0 : Float(8, 64, 128, strides=[64, 1, 512], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/Reshape_5"](%/down_blocks.1/attn.0/Mul_7_output_0, %/down_blocks.1/attn.0/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.0/Einsum_2_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.1/attn.0/Einsum_2"](%/down_blocks.1/attn.0/Reshape_1_output_0, %/down_blocks.1/attn.0/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.1/attn.0/Cast_2_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.1/attn.0/Cast_2"](%/down_blocks.1/attn.0/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.0/Softmax_1_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.1/attn.0/Softmax_1"](%/down_blocks.1/attn.0/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.0/Cast_3_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.1/attn.0/Cast_3"](%/down_blocks.1/attn.0/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.0/Reshape_6_output_0 : Float(8, 64, 128, strides=[64, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/Reshape_6"](%/down_blocks.1/attn.0/Slice_4_output_0, %/down_blocks.1/attn.0/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.1/attn.0/Einsum_3_output_0 : Float(*, *, *, strides=[512, 1, 64], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.1/attn.0/Einsum_3"](%/down_blocks.1/attn.0/Cast_3_output_0, %/down_blocks.1/attn.0/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.1/attn.0/Reshape_7_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/Reshape_7"](%/down_blocks.1/attn.0/Einsum_3_output_0, %/down_blocks.1/attn.0/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.1/attn.0/Add_2_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.0/Add_2"](%/down_blocks.1/attn.0/Reshape_4_output_0, %/down_blocks.1/attn.0/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.1/attn.0/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  512    4    2 [ CPULongType{4} ], onnx_name="/down_blocks.1/attn.0/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.1/attn.0/Reshape_8_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/Reshape_8"](%/down_blocks.1/attn.0/Add_2_output_0, %/down_blocks.1/attn.0/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.1/attn.0/proj_out/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.1/attn.0/proj_out/Conv"](%/down_blocks.1/attn.0/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.1.attn.0.proj_out.weight, %inner_unet.inner_unet.down_blocks.1.attn.0.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/attn.0/Add_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.0/Add_3"](%/down_blocks.1/resnets.0_2/Add_3_output_0, %/down_blocks.1/attn.0/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.1/attn.0/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.0/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/ffn/ffn.0/Reshape"](%/down_blocks.1/attn.0/Add_3_output_0, %/down_blocks.1/attn.0/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/attn.0/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/attn.0/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/attn.0/ffn/ffn.0/InstanceNormalization"](%/down_blocks.1/attn.0/ffn/ffn.0/Reshape_output_0, %/down_blocks.1/attn.0/ffn/ffn.0/Constant_1_output_0, %/down_blocks.1/attn.0/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/attn.0/ffn/ffn.0/Shape"](%/down_blocks.1/attn.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/ffn/ffn.0/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.0/ffn/ffn.0/Reshape_1"](%/down_blocks.1/attn.0/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.1/attn.0/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/ffn/ffn.0/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/ffn/ffn.0/Mul"](%/down_blocks.1/attn.0/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9324), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/ffn/ffn.0/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.0/ffn/ffn.0/Add"](%/down_blocks.1/attn.0/ffn/ffn.0/Mul_output_0, %onnx::Add_9325), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.0/ffn/ffn.1/Conv_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.1/attn.0/ffn/ffn.1/Conv"](%/down_blocks.1/attn.0/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.1.attn.0.ffn.1.weight, %inner_unet.inner_unet.down_blocks.1.attn.0.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/attn.0/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.1/attn.0/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.0/ffn/ffn.2/Div_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/attn.0/ffn/ffn.2/Div"](%/down_blocks.1/attn.0/ffn/ffn.1/Conv_output_0, %/down_blocks.1/attn.0/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.0/ffn/ffn.2/Erf_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.1/attn.0/ffn/ffn.2/Erf"](%/down_blocks.1/attn.0/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.0/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.0/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.0/ffn/ffn.2/Add_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/attn.0/ffn/ffn.2/Add"](%/down_blocks.1/attn.0/ffn/ffn.2/Erf_output_0, %/down_blocks.1/attn.0/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.0/ffn/ffn.2/Mul_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/ffn/ffn.2/Mul"](%/down_blocks.1/attn.0/ffn/ffn.1/Conv_output_0, %/down_blocks.1/attn.0/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.0/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.1/attn.0/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.0/ffn/ffn.2/Mul_1_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/attn.0/ffn/ffn.2/Mul_1"](%/down_blocks.1/attn.0/ffn/ffn.2/Mul_output_0, %/down_blocks.1/attn.0/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.0/ffn/ffn.3/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.1/attn.0/ffn/ffn.3/Conv"](%/down_blocks.1/attn.0/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.1.attn.0.ffn.3.weight, %inner_unet.inner_unet.down_blocks.1.attn.0.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/attn.0/Add_4_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.0/Add_4"](%/down_blocks.1/attn.0/ffn/ffn.3/Conv_output_0, %/down_blocks.1/attn.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.1/resnets.1/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.1/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_2/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm1_2/Reshape"](%/down_blocks.1/attn.0/Add_4_output_0, %/down_blocks.1/resnets.1/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.1/norm1_2/InstanceNormalization"](%/down_blocks.1/resnets.1/norm1_2/Reshape_output_0, %/down_blocks.1/resnets.1/norm1_2/Constant_1_output_0, %/down_blocks.1/resnets.1/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.1/norm1_2/Shape"](%/down_blocks.1/attn.0/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_2/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm1_2/Reshape_1"](%/down_blocks.1/resnets.1/norm1_2/InstanceNormalization_output_0, %/down_blocks.1/resnets.1/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_2/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/norm1_2/Mul"](%/down_blocks.1/resnets.1/norm1_2/Reshape_1_output_0, %onnx::Mul_9326), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm1_2/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1/norm1_2/Add"](%/down_blocks.1/resnets.1/norm1_2/Mul_output_0, %onnx::Add_9327), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1_2/Sigmoid_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.1_2/Sigmoid"](%/down_blocks.1/resnets.1/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1_2/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1_2/Mul"](%/down_blocks.1/resnets.1/norm1_2/Add_output_0, %/down_blocks.1/resnets.1_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1/conv1_2/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.1/conv1_2/Conv"](%/down_blocks.1/resnets.1_2/Mul_output_0, %inner_unet.inner_unet.down_blocks.1.resnets.1.conv1.weight, %inner_unet.inner_unet.down_blocks.1.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.1/time_layer_2/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.1/resnets.1/time_layer_2/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.1.resnets.1.time_layer.weight, %inner_unet.inner_unet.down_blocks.1.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.1/resnets.1_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Unsqueeze_output_0 : Float(1, 1024, 1, strides=[1024, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.1_2/Unsqueeze"](%/down_blocks.1/resnets.1/time_layer_2/Gemm_output_0, %/down_blocks.1/resnets.1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.1/resnets.1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Unsqueeze_1_output_0 : Float(1, 1024, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.1/resnets.1_2/Unsqueeze_1"](%/down_blocks.1/resnets.1_2/Unsqueeze_output_0, %/down_blocks.1/resnets.1_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.1_2/Shape"](%/down_blocks.1/resnets.1_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.1/resnets.1_2/Gather"](%/down_blocks.1/resnets.1_2/Shape_output_0, %/down_blocks.1/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.1/resnets.1_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/resnets.1_2/Add"](%/down_blocks.1/resnets.1_2/Gather_output_0, %/down_blocks.1/resnets.1_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.1_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/resnets.1_2/Div"](%/down_blocks.1/resnets.1_2/Add_output_0, %/down_blocks.1/resnets.1_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1_2/Mul_1"](%/down_blocks.1/resnets.1_2/Div_output_0, %/down_blocks.1/resnets.1_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Slice_output_0 : Float(1, 512, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.1_2/Slice"](%/down_blocks.1/resnets.1_2/Unsqueeze_1_output_0, %/down_blocks.1/resnets.1_2/Constant_3_output_0, %/down_blocks.1/resnets.1_2/Mul_1_output_0, %/down_blocks.1/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/resnets.1_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1_2/Mul_2"](%/down_blocks.1/resnets.1_2/Div_output_0, %/down_blocks.1/resnets.1_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1_2/Slice_1_output_0 : Float(1, 512, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/resnets.1_2/Slice_1"](%/down_blocks.1/resnets.1_2/Unsqueeze_1_output_0, %/down_blocks.1/resnets.1_2/Mul_1_output_0, %/down_blocks.1/resnets.1_2/Mul_2_output_0, %/down_blocks.1/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.1/resnets.1/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/resnets.1/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_2/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm2_2/Reshape"](%/down_blocks.1/resnets.1/conv1_2/Conv_output_0, %/down_blocks.1/resnets.1/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/resnets.1/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/resnets.1/norm2_2/InstanceNormalization"](%/down_blocks.1/resnets.1/norm2_2/Reshape_output_0, %/down_blocks.1/resnets.1/norm2_2/Constant_1_output_0, %/down_blocks.1/resnets.1/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/resnets.1/norm2_2/Shape"](%/down_blocks.1/resnets.1/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_2/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/resnets.1/norm2_2/Reshape_1"](%/down_blocks.1/resnets.1/norm2_2/InstanceNormalization_output_0, %/down_blocks.1/resnets.1/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_2/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1/norm2_2/Mul"](%/down_blocks.1/resnets.1/norm2_2/Reshape_1_output_0, %onnx::Mul_9328), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1/norm2_2/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1/norm2_2/Add"](%/down_blocks.1/resnets.1/norm2_2/Mul_output_0, %onnx::Add_9329), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/resnets.1_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/resnets.1_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1_2/Add_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1_2/Add_1"](%/down_blocks.1/resnets.1_2/Slice_output_0, %/down_blocks.1/resnets.1_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1_2/Mul_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1_2/Mul_3"](%/down_blocks.1/resnets.1/norm2_2/Add_output_0, %/down_blocks.1/resnets.1_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1_2/Add_2_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1_2/Add_2"](%/down_blocks.1/resnets.1_2/Mul_3_output_0, %/down_blocks.1/resnets.1_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.1/resnets.1_2/Sigmoid_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.1/resnets.1_2/Sigmoid_1"](%/down_blocks.1/resnets.1_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1_2/Mul_4_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/resnets.1_2/Mul_4"](%/down_blocks.1/resnets.1_2/Add_2_output_0, %/down_blocks.1/resnets.1_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.1/resnets.1/conv2_2/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.1/resnets.1/conv2_2/Conv"](%/down_blocks.1/resnets.1_2/Mul_4_output_0, %inner_unet.inner_unet.down_blocks.1.resnets.1.conv2.weight, %inner_unet.inner_unet.down_blocks.1.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/resnets.1_2/Add_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/resnets.1_2/Add_3"](%/down_blocks.1/resnets.1/conv2_2/Conv_output_0, %/down_blocks.1/attn.0/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.1/attn.1/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.1/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/norm/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/norm/Reshape"](%/down_blocks.1/resnets.1_2/Add_3_output_0, %/down_blocks.1/attn.1/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/attn.1/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/attn.1/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/norm/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/attn.1/norm/InstanceNormalization"](%/down_blocks.1/attn.1/norm/Reshape_output_0, %/down_blocks.1/attn.1/norm/Constant_1_output_0, %/down_blocks.1/attn.1/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/attn.1/norm/Shape"](%/down_blocks.1/resnets.1_2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/norm/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/norm/Reshape_1"](%/down_blocks.1/attn.1/norm/InstanceNormalization_output_0, %/down_blocks.1/attn.1/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/norm/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/norm/Mul"](%/down_blocks.1/attn.1/norm/Reshape_1_output_0, %onnx::Mul_9330), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/norm/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.1/norm/Add"](%/down_blocks.1/attn.1/norm/Mul_output_0, %onnx::Add_9331), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/qkv/Conv_output_0 : Float(1, 1536, 4, 2, strides=[12288, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.1/attn.1/qkv/Conv"](%/down_blocks.1/attn.1/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.1.attn.1.qkv.weight, %inner_unet.inner_unet.down_blocks.1.attn.1.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/attn.1/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  1536    -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Reshape_output_0 : Float(1, 1536, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/Reshape"](%/down_blocks.1/attn.1/qkv/Conv_output_0, %/down_blocks.1/attn.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/attn.1/Shape"](%/down_blocks.1/attn.1/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.1/attn.1/Gather"](%/down_blocks.1/attn.1/Shape_output_0, %/down_blocks.1/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.1/attn.1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/attn.1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/attn.1/Add"](%/down_blocks.1/attn.1/Gather_output_0, %/down_blocks.1/attn.1/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.1/attn.1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/attn.1/Div"](%/down_blocks.1/attn.1/Add_output_0, %/down_blocks.1/attn.1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/Mul"](%/down_blocks.1/attn.1/Div_output_0, %/down_blocks.1/attn.1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Slice_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/attn.1/Slice"](%/down_blocks.1/attn.1/Reshape_output_0, %/down_blocks.1/attn.1/Constant_2_output_0, %/down_blocks.1/attn.1/Mul_output_0, %/down_blocks.1/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/attn.1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/Mul_1"](%/down_blocks.1/attn.1/Div_output_0, %/down_blocks.1/attn.1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Slice_1_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/attn.1/Slice_1"](%/down_blocks.1/attn.1/Reshape_output_0, %/down_blocks.1/attn.1/Mul_output_0, %/down_blocks.1/attn.1/Mul_1_output_0, %/down_blocks.1/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.1/attn.1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/Mul_2"](%/down_blocks.1/attn.1/Div_output_0, %/down_blocks.1/attn.1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Slice_2_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/attn.1/Slice_2"](%/down_blocks.1/attn.1/Reshape_output_0, %/down_blocks.1/attn.1/Mul_1_output_0, %/down_blocks.1/attn.1/Mul_2_output_0, %/down_blocks.1/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.1/attn.1/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={2.82843}, onnx_name="/down_blocks.1/attn.1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.1/attn.1/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.1/attn.1/Reciprocal"](%/down_blocks.1/attn.1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.1/attn.1/Mul_3_output_0 : Float(1, 512, 8, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/Mul_3"](%/down_blocks.1/attn.1/Slice_output_0, %/down_blocks.1/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.1/attn.1/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64   8 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.1/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.1/attn.1/Reshape_1_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/Reshape_1"](%/down_blocks.1/attn.1/Mul_3_output_0, %/down_blocks.1/attn.1/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.1/attn.1/Mul_4_output_0 : Float(1, 512, 8, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/Mul_4"](%/down_blocks.1/attn.1/Slice_1_output_0, %/down_blocks.1/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.1/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.1/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.1/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.1/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.1/attn.1/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.1/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.1/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.1/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.1/attn.1/Reshape_2_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/Reshape_2"](%/down_blocks.1/attn.1/Mul_4_output_0, %/down_blocks.1/attn.1/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.1/Einsum_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.1/attn.1/Einsum"](%/down_blocks.1/attn.1/Reshape_1_output_0, %/down_blocks.1/attn.1/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.1/attn.1/Cast_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.1/attn.1/Cast"](%/down_blocks.1/attn.1/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.1/Softmax_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.1/attn.1/Softmax"](%/down_blocks.1/attn.1/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.1/Cast_1_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.1/attn.1/Cast_1"](%/down_blocks.1/attn.1/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.1/Reshape_3_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/Reshape_3"](%/down_blocks.1/attn.1/Slice_2_output_0, %/down_blocks.1/attn.1/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.1/attn.1/Einsum_1_output_0 : Float(*, *, *, strides=[512, 1, 64], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.1/attn.1/Einsum_1"](%/down_blocks.1/attn.1/Cast_1_output_0, %/down_blocks.1/attn.1/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.1/attn.1/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  8 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.1/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.1/attn.1/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  8 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.1/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.1/attn.1/Reshape_4_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/Reshape_4"](%/down_blocks.1/attn.1/Einsum_1_output_0, %/down_blocks.1/attn.1/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.1/attn.1/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/attn.1/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.1.attn.1.norm_cond.weight, %inner_unet.inner_unet.down_blocks.1.attn.1.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.1/attn.1/kv_cond/MatMul_output_0 : Float(1, 128, 1024, strides=[131072, 1024, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.1/attn.1/kv_cond/MatMul"](%/down_blocks.1/attn.1/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9364), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.1/attn.1/kv_cond/Add_output_0 : Float(1, 128, 1024, strides=[131072, 1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.1/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.1.attn.1.kv_cond.bias, %/down_blocks.1/attn.1/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.1/attn.1/Transpose_output_0 : Float(1, 1024, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.1/attn.1/Transpose"](%/down_blocks.1/attn.1/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.1/attn.1/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/attn.1/Shape_1"](%/down_blocks.1/attn.1/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.1/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.1/attn.1/Gather_1"](%/down_blocks.1/attn.1/Shape_1_output_0, %/down_blocks.1/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.1/attn.1/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.1/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/attn.1/Add_1"](%/down_blocks.1/attn.1/Gather_1_output_0, %/down_blocks.1/attn.1/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/attn.1/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/attn.1/Div_1"](%/down_blocks.1/attn.1/Add_1_output_0, %/down_blocks.1/attn.1/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.1/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/Mul_5"](%/down_blocks.1/attn.1/Div_1_output_0, %/down_blocks.1/attn.1/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Slice_3_output_0 : Float(1, 512, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/attn.1/Slice_3"](%/down_blocks.1/attn.1/Transpose_output_0, %/down_blocks.1/attn.1/Constant_17_output_0, %/down_blocks.1/attn.1/Mul_5_output_0, %/down_blocks.1/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.1/attn.1/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/Mul_6"](%/down_blocks.1/attn.1/Div_1_output_0, %/down_blocks.1/attn.1/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Slice_4_output_0 : Float(1, 512, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.1/attn.1/Slice_4"](%/down_blocks.1/attn.1/Transpose_output_0, %/down_blocks.1/attn.1/Mul_5_output_0, %/down_blocks.1/attn.1/Mul_6_output_0, %/down_blocks.1/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.1/attn.1/Mul_7_output_0 : Float(1, 512, 128, strides=[65536, 1, 512], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/Mul_7"](%/down_blocks.1/attn.1/Slice_3_output_0, %/down_blocks.1/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.1/Reshape_5_output_0 : Float(8, 64, 128, strides=[64, 1, 512], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/Reshape_5"](%/down_blocks.1/attn.1/Mul_7_output_0, %/down_blocks.1/attn.1/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.1/attn.1/Einsum_2_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.1/attn.1/Einsum_2"](%/down_blocks.1/attn.1/Reshape_1_output_0, %/down_blocks.1/attn.1/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.1/attn.1/Cast_2_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.1/attn.1/Cast_2"](%/down_blocks.1/attn.1/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.1/Softmax_1_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.1/attn.1/Softmax_1"](%/down_blocks.1/attn.1/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.1/Cast_3_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.1/attn.1/Cast_3"](%/down_blocks.1/attn.1/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.1/attn.1/Reshape_6_output_0 : Float(8, 64, 128, strides=[64, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/Reshape_6"](%/down_blocks.1/attn.1/Slice_4_output_0, %/down_blocks.1/attn.1/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.1/attn.1/Einsum_3_output_0 : Float(*, *, *, strides=[512, 1, 64], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.1/attn.1/Einsum_3"](%/down_blocks.1/attn.1/Cast_3_output_0, %/down_blocks.1/attn.1/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.1/attn.1/Reshape_7_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/Reshape_7"](%/down_blocks.1/attn.1/Einsum_3_output_0, %/down_blocks.1/attn.1/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.1/attn.1/Add_2_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.1/Add_2"](%/down_blocks.1/attn.1/Reshape_4_output_0, %/down_blocks.1/attn.1/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.1/attn.1/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  512    4    2 [ CPULongType{4} ], onnx_name="/down_blocks.1/attn.1/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.1/attn.1/Reshape_8_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/Reshape_8"](%/down_blocks.1/attn.1/Add_2_output_0, %/down_blocks.1/attn.1/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.1/attn.1/proj_out/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.1/attn.1/proj_out/Conv"](%/down_blocks.1/attn.1/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.1.attn.1.proj_out.weight, %inner_unet.inner_unet.down_blocks.1.attn.1.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/attn.1/Add_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.1/Add_3"](%/down_blocks.1/resnets.1_2/Add_3_output_0, %/down_blocks.1/attn.1/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.1/attn.1/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.1/attn.1/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/ffn/ffn.0/Reshape"](%/down_blocks.1/attn.1/Add_3_output_0, %/down_blocks.1/attn.1/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/attn.1/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.1/attn.1/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.1/attn.1/ffn/ffn.0/InstanceNormalization"](%/down_blocks.1/attn.1/ffn/ffn.0/Reshape_output_0, %/down_blocks.1/attn.1/ffn/ffn.0/Constant_1_output_0, %/down_blocks.1/attn.1/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.1/attn.1/ffn/ffn.0/Shape"](%/down_blocks.1/attn.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/ffn/ffn.0/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.1/attn.1/ffn/ffn.0/Reshape_1"](%/down_blocks.1/attn.1/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.1/attn.1/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/ffn/ffn.0/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/ffn/ffn.0/Mul"](%/down_blocks.1/attn.1/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9370), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/ffn/ffn.0/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.1/ffn/ffn.0/Add"](%/down_blocks.1/attn.1/ffn/ffn.0/Mul_output_0, %onnx::Add_9371), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.1/attn.1/ffn/ffn.1/Conv_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.1/attn.1/ffn/ffn.1/Conv"](%/down_blocks.1/attn.1/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.1.attn.1.ffn.1.weight, %inner_unet.inner_unet.down_blocks.1.attn.1.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/attn.1/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.1/attn.1/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.1/ffn/ffn.2/Div_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.1/attn.1/ffn/ffn.2/Div"](%/down_blocks.1/attn.1/ffn/ffn.1/Conv_output_0, %/down_blocks.1/attn.1/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.1/ffn/ffn.2/Erf_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.1/attn.1/ffn/ffn.2/Erf"](%/down_blocks.1/attn.1/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.1/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.1/attn.1/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.1/ffn/ffn.2/Add_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.1/attn.1/ffn/ffn.2/Add"](%/down_blocks.1/attn.1/ffn/ffn.2/Erf_output_0, %/down_blocks.1/attn.1/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.1/ffn/ffn.2/Mul_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/ffn/ffn.2/Mul"](%/down_blocks.1/attn.1/ffn/ffn.1/Conv_output_0, %/down_blocks.1/attn.1/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.1/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.1/attn.1/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.1/ffn/ffn.2/Mul_1_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.1/attn.1/ffn/ffn.2/Mul_1"](%/down_blocks.1/attn.1/ffn/ffn.2/Mul_output_0, %/down_blocks.1/attn.1/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.1/attn.1/ffn/ffn.3/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.1/attn.1/ffn/ffn.3/Conv"](%/down_blocks.1/attn.1/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.1.attn.1.ffn.3.weight, %inner_unet.inner_unet.down_blocks.1.attn.1.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.1/attn.1/Add_4_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.1/attn.1/Add_4"](%/down_blocks.1/attn.1/ffn/ffn.3/Conv_output_0, %/down_blocks.1/attn.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.1/resample_2/Conv_output_0 : Float(1, 512, 2, 1, strides=[1024, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[2, 2], onnx_name="/down_blocks.1/resample_2/Conv"](%/down_blocks.1/attn.1/Add_4_output_0, %inner_unet.inner_unet.down_blocks.1.resample.weight, %inner_unet.inner_unet.down_blocks.1.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.1/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/resnets.0/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_2/Reshape_output_0 : Float(1, 32, 32, strides=[1024, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm1_2/Reshape"](%/down_blocks.1/resample_2/Conv_output_0, %/down_blocks.2/resnets.0/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 32, strides=[1024, 32, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/resnets.0/norm1_2/InstanceNormalization"](%/down_blocks.2/resnets.0/norm1_2/Reshape_output_0, %/down_blocks.2/resnets.0/norm1_2/Constant_1_output_0, %/down_blocks.2/resnets.0/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.0/norm1_2/Shape"](%/down_blocks.1/resample_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_2/Reshape_1_output_0 : Float(1, 512, 2, 1, strides=[1024, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm1_2/Reshape_1"](%/down_blocks.2/resnets.0/norm1_2/InstanceNormalization_output_0, %/down_blocks.2/resnets.0/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_2/Mul_output_0 : Float(1, 512, 2, 1, strides=[1024, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/norm1_2/Mul"](%/down_blocks.2/resnets.0/norm1_2/Reshape_1_output_0, %onnx::Mul_9372), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm1_2/Add_output_0 : Float(1, 512, 2, 1, strides=[1024, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0/norm1_2/Add"](%/down_blocks.2/resnets.0/norm1_2/Mul_output_0, %onnx::Add_9373), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0_2/Sigmoid_output_0 : Float(1, 512, 2, 1, strides=[1024, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.2/resnets.0_2/Sigmoid"](%/down_blocks.2/resnets.0/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0_2/Mul_output_0 : Float(1, 512, 2, 1, strides=[1024, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0_2/Mul"](%/down_blocks.2/resnets.0/norm1_2/Add_output_0, %/down_blocks.2/resnets.0_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0/conv1_2/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.2/resnets.0/conv1_2/Conv"](%/down_blocks.2/resnets.0_2/Mul_output_0, %inner_unet.inner_unet.down_blocks.2.resnets.0.conv1.weight, %inner_unet.inner_unet.down_blocks.2.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0/time_layer_2/Gemm_output_0 : Float(1, 1536, strides=[1536, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.2/resnets.0/time_layer_2/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.resnets.0.time_layer.weight, %inner_unet.inner_unet.down_blocks.2.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/resnets.0_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.2/resnets.0_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Unsqueeze_output_0 : Float(1, 1536, 1, strides=[1536, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.2/resnets.0_2/Unsqueeze"](%/down_blocks.2/resnets.0/time_layer_2/Gemm_output_0, %/down_blocks.2/resnets.0_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.2/resnets.0_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Unsqueeze_1_output_0 : Float(1, 1536, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.2/resnets.0_2/Unsqueeze_1"](%/down_blocks.2/resnets.0_2/Unsqueeze_output_0, %/down_blocks.2/resnets.0_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.0_2/Shape"](%/down_blocks.2/resnets.0_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/resnets.0_2/Gather"](%/down_blocks.2/resnets.0_2/Shape_output_0, %/down_blocks.2/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/resnets.0_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/resnets.0_2/Add"](%/down_blocks.2/resnets.0_2/Gather_output_0, %/down_blocks.2/resnets.0_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/resnets.0_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/resnets.0_2/Div"](%/down_blocks.2/resnets.0_2/Add_output_0, %/down_blocks.2/resnets.0_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0_2/Mul_1"](%/down_blocks.2/resnets.0_2/Div_output_0, %/down_blocks.2/resnets.0_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Slice_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/resnets.0_2/Slice"](%/down_blocks.2/resnets.0_2/Unsqueeze_1_output_0, %/down_blocks.2/resnets.0_2/Constant_3_output_0, %/down_blocks.2/resnets.0_2/Mul_1_output_0, %/down_blocks.2/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/resnets.0_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0_2/Mul_2"](%/down_blocks.2/resnets.0_2/Div_output_0, %/down_blocks.2/resnets.0_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0_2/Slice_1_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/resnets.0_2/Slice_1"](%/down_blocks.2/resnets.0_2/Unsqueeze_1_output_0, %/down_blocks.2/resnets.0_2/Mul_1_output_0, %/down_blocks.2/resnets.0_2/Mul_2_output_0, %/down_blocks.2/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.0/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/resnets.0/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_2/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm2_2/Reshape"](%/down_blocks.2/resnets.0/conv1_2/Conv_output_0, %/down_blocks.2/resnets.0/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.0/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/resnets.0/norm2_2/InstanceNormalization"](%/down_blocks.2/resnets.0/norm2_2/Reshape_output_0, %/down_blocks.2/resnets.0/norm2_2/Constant_1_output_0, %/down_blocks.2/resnets.0/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.0/norm2_2/Shape"](%/down_blocks.2/resnets.0/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_2/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.0/norm2_2/Reshape_1"](%/down_blocks.2/resnets.0/norm2_2/InstanceNormalization_output_0, %/down_blocks.2/resnets.0/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_2/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0/norm2_2/Mul"](%/down_blocks.2/resnets.0/norm2_2/Reshape_1_output_0, %onnx::Mul_9374), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0/norm2_2/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0/norm2_2/Add"](%/down_blocks.2/resnets.0/norm2_2/Mul_output_0, %onnx::Add_9375), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.0_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.0_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0_2/Add_1_output_0 : Float(1, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0_2/Add_1"](%/down_blocks.2/resnets.0_2/Slice_output_0, %/down_blocks.2/resnets.0_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0_2/Mul_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0_2/Mul_3"](%/down_blocks.2/resnets.0/norm2_2/Add_output_0, %/down_blocks.2/resnets.0_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0_2/Add_2_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0_2/Add_2"](%/down_blocks.2/resnets.0_2/Mul_3_output_0, %/down_blocks.2/resnets.0_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.0_2/Sigmoid_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.2/resnets.0_2/Sigmoid_1"](%/down_blocks.2/resnets.0_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0_2/Mul_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.0_2/Mul_4"](%/down_blocks.2/resnets.0_2/Add_2_output_0, %/down_blocks.2/resnets.0_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.0/conv2_2/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.2/resnets.0/conv2_2/Conv"](%/down_blocks.2/resnets.0_2/Mul_4_output_0, %inner_unet.inner_unet.down_blocks.2.resnets.0.conv2.weight, %inner_unet.inner_unet.down_blocks.2.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0/conv3_2/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/resnets.0/conv3_2/Conv"](%/down_blocks.1/resample_2/Conv_output_0, %inner_unet.inner_unet.down_blocks.2.resnets.0.conv3.weight, %inner_unet.inner_unet.down_blocks.2.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.0_2/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.0_2/Add_3"](%/down_blocks.2/resnets.0/conv2_2/Conv_output_0, %/down_blocks.2/resnets.0/conv3_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.2/attn.0/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.0/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/norm/Reshape"](%/down_blocks.2/resnets.0_2/Add_3_output_0, %/down_blocks.2/attn.0/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.0/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.0/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.0/norm/InstanceNormalization"](%/down_blocks.2/attn.0/norm/Reshape_output_0, %/down_blocks.2/attn.0/norm/Constant_1_output_0, %/down_blocks.2/attn.0/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.0/norm/Shape"](%/down_blocks.2/resnets.0_2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/norm/Reshape_1"](%/down_blocks.2/attn.0/norm/InstanceNormalization_output_0, %/down_blocks.2/attn.0/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/norm/Mul"](%/down_blocks.2/attn.0/norm/Reshape_1_output_0, %onnx::Mul_9376), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.0/norm/Add"](%/down_blocks.2/attn.0/norm/Mul_output_0, %onnx::Add_9377), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.0/qkv/Conv"](%/down_blocks.2/attn.0/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.0.qkv.weight, %inner_unet.inner_unet.down_blocks.2.attn.0.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.0/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/Reshape"](%/down_blocks.2/attn.0/qkv/Conv_output_0, %/down_blocks.2/attn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.0/Shape"](%/down_blocks.2/attn.0/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.0/Gather"](%/down_blocks.2/attn.0/Shape_output_0, %/down_blocks.2/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.0/Add"](%/down_blocks.2/attn.0/Gather_output_0, %/down_blocks.2/attn.0/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.0/Div"](%/down_blocks.2/attn.0/Add_output_0, %/down_blocks.2/attn.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/Mul"](%/down_blocks.2/attn.0/Div_output_0, %/down_blocks.2/attn.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.0/Slice"](%/down_blocks.2/attn.0/Reshape_output_0, %/down_blocks.2/attn.0/Constant_2_output_0, %/down_blocks.2/attn.0/Mul_output_0, %/down_blocks.2/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/Mul_1"](%/down_blocks.2/attn.0/Div_output_0, %/down_blocks.2/attn.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.0/Slice_1"](%/down_blocks.2/attn.0/Reshape_output_0, %/down_blocks.2/attn.0/Mul_output_0, %/down_blocks.2/attn.0/Mul_1_output_0, %/down_blocks.2/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/Mul_2"](%/down_blocks.2/attn.0/Div_output_0, %/down_blocks.2/attn.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.0/Slice_2"](%/down_blocks.2/attn.0/Reshape_output_0, %/down_blocks.2/attn.0/Mul_1_output_0, %/down_blocks.2/attn.0/Mul_2_output_0, %/down_blocks.2/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.0/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/down_blocks.2/attn.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.2/attn.0/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.2/attn.0/Reciprocal"](%/down_blocks.2/attn.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.2/attn.0/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/Mul_3"](%/down_blocks.2/attn.0/Slice_output_0, %/down_blocks.2/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.0/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.0/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.0/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/Reshape_1"](%/down_blocks.2/attn.0/Mul_3_output_0, %/down_blocks.2/attn.0/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.0/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/Mul_4"](%/down_blocks.2/attn.0/Slice_1_output_0, %/down_blocks.2/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.0/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.0/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.0/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.0/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.0/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.0/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.0/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.0/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.0/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/Reshape_2"](%/down_blocks.2/attn.0/Mul_4_output_0, %/down_blocks.2/attn.0/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.0/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.0/Einsum"](%/down_blocks.2/attn.0/Reshape_1_output_0, %/down_blocks.2/attn.0/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.0/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.0/Cast"](%/down_blocks.2/attn.0/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.0/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.0/Softmax"](%/down_blocks.2/attn.0/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.0/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.0/Cast_1"](%/down_blocks.2/attn.0/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.0/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/Reshape_3"](%/down_blocks.2/attn.0/Slice_2_output_0, %/down_blocks.2/attn.0/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.0/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.0/Einsum_1"](%/down_blocks.2/attn.0/Cast_1_output_0, %/down_blocks.2/attn.0/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.0/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.0/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.0/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.0/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.0/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/Reshape_4"](%/down_blocks.2/attn.0/Einsum_1_output_0, %/down_blocks.2/attn.0/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.0/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.0/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.0.norm_cond.weight, %inner_unet.inner_unet.down_blocks.2.attn.0.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.2/attn.0/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.2/attn.0/kv_cond/MatMul"](%/down_blocks.2/attn.0/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9410), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.0/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.0/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.2.attn.0.kv_cond.bias, %/down_blocks.2/attn.0/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.0/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.2/attn.0/Transpose"](%/down_blocks.2/attn.0/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.2/attn.0/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.0/Shape_1"](%/down_blocks.2/attn.0/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.0/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.0/Gather_1"](%/down_blocks.2/attn.0/Shape_1_output_0, %/down_blocks.2/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.0/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.0/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.0/Add_1"](%/down_blocks.2/attn.0/Gather_1_output_0, %/down_blocks.2/attn.0/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.0/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.0/Div_1"](%/down_blocks.2/attn.0/Add_1_output_0, %/down_blocks.2/attn.0/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.0/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/Mul_5"](%/down_blocks.2/attn.0/Div_1_output_0, %/down_blocks.2/attn.0/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.0/Slice_3"](%/down_blocks.2/attn.0/Transpose_output_0, %/down_blocks.2/attn.0/Constant_17_output_0, %/down_blocks.2/attn.0/Mul_5_output_0, %/down_blocks.2/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.0/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/Mul_6"](%/down_blocks.2/attn.0/Div_1_output_0, %/down_blocks.2/attn.0/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.0/Slice_4"](%/down_blocks.2/attn.0/Transpose_output_0, %/down_blocks.2/attn.0/Mul_5_output_0, %/down_blocks.2/attn.0/Mul_6_output_0, %/down_blocks.2/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.0/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/Mul_7"](%/down_blocks.2/attn.0/Slice_3_output_0, %/down_blocks.2/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.0/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/Reshape_5"](%/down_blocks.2/attn.0/Mul_7_output_0, %/down_blocks.2/attn.0/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.0/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.0/Einsum_2"](%/down_blocks.2/attn.0/Reshape_1_output_0, %/down_blocks.2/attn.0/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.0/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.0/Cast_2"](%/down_blocks.2/attn.0/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.0/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.0/Softmax_1"](%/down_blocks.2/attn.0/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.0/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.0/Cast_3"](%/down_blocks.2/attn.0/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.0/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/Reshape_6"](%/down_blocks.2/attn.0/Slice_4_output_0, %/down_blocks.2/attn.0/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.0/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.0/Einsum_3"](%/down_blocks.2/attn.0/Cast_3_output_0, %/down_blocks.2/attn.0/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.0/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/Reshape_7"](%/down_blocks.2/attn.0/Einsum_3_output_0, %/down_blocks.2/attn.0/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.0/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.0/Add_2"](%/down_blocks.2/attn.0/Reshape_4_output_0, %/down_blocks.2/attn.0/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.2/attn.0/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/down_blocks.2/attn.0/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.0/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/Reshape_8"](%/down_blocks.2/attn.0/Add_2_output_0, %/down_blocks.2/attn.0/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.0/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.0/proj_out/Conv"](%/down_blocks.2/attn.0/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.2.attn.0.proj_out.weight, %inner_unet.inner_unet.down_blocks.2.attn.0.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.0/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.0/Add_3"](%/down_blocks.2/resnets.0_2/Add_3_output_0, %/down_blocks.2/attn.0/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.2/attn.0/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.0/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/ffn/ffn.0/Reshape"](%/down_blocks.2/attn.0/Add_3_output_0, %/down_blocks.2/attn.0/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.0/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.0/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.0/ffn/ffn.0/InstanceNormalization"](%/down_blocks.2/attn.0/ffn/ffn.0/Reshape_output_0, %/down_blocks.2/attn.0/ffn/ffn.0/Constant_1_output_0, %/down_blocks.2/attn.0/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.0/ffn/ffn.0/Shape"](%/down_blocks.2/attn.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.0/ffn/ffn.0/Reshape_1"](%/down_blocks.2/attn.0/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.2/attn.0/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/ffn/ffn.0/Mul"](%/down_blocks.2/attn.0/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9416), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.0/ffn/ffn.0/Add"](%/down_blocks.2/attn.0/ffn/ffn.0/Mul_output_0, %onnx::Add_9417), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.0/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.0/ffn/ffn.1/Conv"](%/down_blocks.2/attn.0/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.0.ffn.1.weight, %inner_unet.inner_unet.down_blocks.2.attn.0.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.0/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.2/attn.0/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.0/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.0/ffn/ffn.2/Div"](%/down_blocks.2/attn.0/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.0/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.0/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.2/attn.0/ffn/ffn.2/Erf"](%/down_blocks.2/attn.0/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.0/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.0/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.0/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.0/ffn/ffn.2/Add"](%/down_blocks.2/attn.0/ffn/ffn.2/Erf_output_0, %/down_blocks.2/attn.0/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.0/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/ffn/ffn.2/Mul"](%/down_blocks.2/attn.0/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.0/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.0/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.2/attn.0/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.0/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.0/ffn/ffn.2/Mul_1"](%/down_blocks.2/attn.0/ffn/ffn.2/Mul_output_0, %/down_blocks.2/attn.0/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.0/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.0/ffn/ffn.3/Conv"](%/down_blocks.2/attn.0/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.attn.0.ffn.3.weight, %inner_unet.inner_unet.down_blocks.2.attn.0.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.0/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.0/Add_4"](%/down_blocks.2/attn.0/ffn/ffn.3/Conv_output_0, %/down_blocks.2/attn.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.2/attn.1/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.1/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/norm/Reshape"](%/down_blocks.2/attn.0/Add_4_output_0, %/down_blocks.2/attn.1/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.1/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.1/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.1/norm/InstanceNormalization"](%/down_blocks.2/attn.1/norm/Reshape_output_0, %/down_blocks.2/attn.1/norm/Constant_1_output_0, %/down_blocks.2/attn.1/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.1/norm/Shape"](%/down_blocks.2/attn.0/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/norm/Reshape_1"](%/down_blocks.2/attn.1/norm/InstanceNormalization_output_0, %/down_blocks.2/attn.1/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/norm/Mul"](%/down_blocks.2/attn.1/norm/Reshape_1_output_0, %onnx::Mul_9418), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.1/norm/Add"](%/down_blocks.2/attn.1/norm/Mul_output_0, %onnx::Add_9419), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.1/qkv/Conv"](%/down_blocks.2/attn.1/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.1.qkv.weight, %inner_unet.inner_unet.down_blocks.2.attn.1.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.1/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/Reshape"](%/down_blocks.2/attn.1/qkv/Conv_output_0, %/down_blocks.2/attn.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.1/Shape"](%/down_blocks.2/attn.1/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.1/Gather"](%/down_blocks.2/attn.1/Shape_output_0, %/down_blocks.2/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.1/Add"](%/down_blocks.2/attn.1/Gather_output_0, %/down_blocks.2/attn.1/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.1/Div"](%/down_blocks.2/attn.1/Add_output_0, %/down_blocks.2/attn.1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/Mul"](%/down_blocks.2/attn.1/Div_output_0, %/down_blocks.2/attn.1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.1/Slice"](%/down_blocks.2/attn.1/Reshape_output_0, %/down_blocks.2/attn.1/Constant_2_output_0, %/down_blocks.2/attn.1/Mul_output_0, %/down_blocks.2/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/Mul_1"](%/down_blocks.2/attn.1/Div_output_0, %/down_blocks.2/attn.1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.1/Slice_1"](%/down_blocks.2/attn.1/Reshape_output_0, %/down_blocks.2/attn.1/Mul_output_0, %/down_blocks.2/attn.1/Mul_1_output_0, %/down_blocks.2/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/Mul_2"](%/down_blocks.2/attn.1/Div_output_0, %/down_blocks.2/attn.1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.1/Slice_2"](%/down_blocks.2/attn.1/Reshape_output_0, %/down_blocks.2/attn.1/Mul_1_output_0, %/down_blocks.2/attn.1/Mul_2_output_0, %/down_blocks.2/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.1/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/down_blocks.2/attn.1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.2/attn.1/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.2/attn.1/Reciprocal"](%/down_blocks.2/attn.1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.2/attn.1/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/Mul_3"](%/down_blocks.2/attn.1/Slice_output_0, %/down_blocks.2/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.1/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.1/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.1/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/Reshape_1"](%/down_blocks.2/attn.1/Mul_3_output_0, %/down_blocks.2/attn.1/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.1/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/Mul_4"](%/down_blocks.2/attn.1/Slice_1_output_0, %/down_blocks.2/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.1/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.1/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.1/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.1/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.1/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.1/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.1/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.1/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.1/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/Reshape_2"](%/down_blocks.2/attn.1/Mul_4_output_0, %/down_blocks.2/attn.1/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.1/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.1/Einsum"](%/down_blocks.2/attn.1/Reshape_1_output_0, %/down_blocks.2/attn.1/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.1/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.1/Cast"](%/down_blocks.2/attn.1/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.1/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.1/Softmax"](%/down_blocks.2/attn.1/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.1/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.1/Cast_1"](%/down_blocks.2/attn.1/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.1/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/Reshape_3"](%/down_blocks.2/attn.1/Slice_2_output_0, %/down_blocks.2/attn.1/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.1/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.1/Einsum_1"](%/down_blocks.2/attn.1/Cast_1_output_0, %/down_blocks.2/attn.1/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.1/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.1/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.1/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.1/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.1/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/Reshape_4"](%/down_blocks.2/attn.1/Einsum_1_output_0, %/down_blocks.2/attn.1/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.1/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.1/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.1.norm_cond.weight, %inner_unet.inner_unet.down_blocks.2.attn.1.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.2/attn.1/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.2/attn.1/kv_cond/MatMul"](%/down_blocks.2/attn.1/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9452), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.1/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.1/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.2.attn.1.kv_cond.bias, %/down_blocks.2/attn.1/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.1/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.2/attn.1/Transpose"](%/down_blocks.2/attn.1/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.2/attn.1/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.1/Shape_1"](%/down_blocks.2/attn.1/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.1/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.1/Gather_1"](%/down_blocks.2/attn.1/Shape_1_output_0, %/down_blocks.2/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.1/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.1/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.1/Add_1"](%/down_blocks.2/attn.1/Gather_1_output_0, %/down_blocks.2/attn.1/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.1/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.1/Div_1"](%/down_blocks.2/attn.1/Add_1_output_0, %/down_blocks.2/attn.1/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.1/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/Mul_5"](%/down_blocks.2/attn.1/Div_1_output_0, %/down_blocks.2/attn.1/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.1/Slice_3"](%/down_blocks.2/attn.1/Transpose_output_0, %/down_blocks.2/attn.1/Constant_17_output_0, %/down_blocks.2/attn.1/Mul_5_output_0, %/down_blocks.2/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.1/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/Mul_6"](%/down_blocks.2/attn.1/Div_1_output_0, %/down_blocks.2/attn.1/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.1/Slice_4"](%/down_blocks.2/attn.1/Transpose_output_0, %/down_blocks.2/attn.1/Mul_5_output_0, %/down_blocks.2/attn.1/Mul_6_output_0, %/down_blocks.2/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.1/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/Mul_7"](%/down_blocks.2/attn.1/Slice_3_output_0, %/down_blocks.2/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.1/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/Reshape_5"](%/down_blocks.2/attn.1/Mul_7_output_0, %/down_blocks.2/attn.1/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.1/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.1/Einsum_2"](%/down_blocks.2/attn.1/Reshape_1_output_0, %/down_blocks.2/attn.1/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.1/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.1/Cast_2"](%/down_blocks.2/attn.1/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.1/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.1/Softmax_1"](%/down_blocks.2/attn.1/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.1/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.1/Cast_3"](%/down_blocks.2/attn.1/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.1/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/Reshape_6"](%/down_blocks.2/attn.1/Slice_4_output_0, %/down_blocks.2/attn.1/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.1/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.1/Einsum_3"](%/down_blocks.2/attn.1/Cast_3_output_0, %/down_blocks.2/attn.1/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.1/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/Reshape_7"](%/down_blocks.2/attn.1/Einsum_3_output_0, %/down_blocks.2/attn.1/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.1/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.1/Add_2"](%/down_blocks.2/attn.1/Reshape_4_output_0, %/down_blocks.2/attn.1/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.2/attn.1/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/down_blocks.2/attn.1/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.1/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/Reshape_8"](%/down_blocks.2/attn.1/Add_2_output_0, %/down_blocks.2/attn.1/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.1/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.1/proj_out/Conv"](%/down_blocks.2/attn.1/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.2.attn.1.proj_out.weight, %inner_unet.inner_unet.down_blocks.2.attn.1.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.1/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.1/Add_3"](%/down_blocks.2/attn.0/Add_4_output_0, %/down_blocks.2/attn.1/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.2/attn.1/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.1/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/ffn/ffn.0/Reshape"](%/down_blocks.2/attn.1/Add_3_output_0, %/down_blocks.2/attn.1/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.1/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.1/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.1/ffn/ffn.0/InstanceNormalization"](%/down_blocks.2/attn.1/ffn/ffn.0/Reshape_output_0, %/down_blocks.2/attn.1/ffn/ffn.0/Constant_1_output_0, %/down_blocks.2/attn.1/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.1/ffn/ffn.0/Shape"](%/down_blocks.2/attn.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.1/ffn/ffn.0/Reshape_1"](%/down_blocks.2/attn.1/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.2/attn.1/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/ffn/ffn.0/Mul"](%/down_blocks.2/attn.1/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9458), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.1/ffn/ffn.0/Add"](%/down_blocks.2/attn.1/ffn/ffn.0/Mul_output_0, %onnx::Add_9459), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.1/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.1/ffn/ffn.1/Conv"](%/down_blocks.2/attn.1/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.1.ffn.1.weight, %inner_unet.inner_unet.down_blocks.2.attn.1.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.1/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.2/attn.1/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.1/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.1/ffn/ffn.2/Div"](%/down_blocks.2/attn.1/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.1/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.1/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.2/attn.1/ffn/ffn.2/Erf"](%/down_blocks.2/attn.1/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.1/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.1/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.1/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.1/ffn/ffn.2/Add"](%/down_blocks.2/attn.1/ffn/ffn.2/Erf_output_0, %/down_blocks.2/attn.1/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.1/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/ffn/ffn.2/Mul"](%/down_blocks.2/attn.1/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.1/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.1/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.2/attn.1/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.1/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.1/ffn/ffn.2/Mul_1"](%/down_blocks.2/attn.1/ffn/ffn.2/Mul_output_0, %/down_blocks.2/attn.1/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.1/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.1/ffn/ffn.3/Conv"](%/down_blocks.2/attn.1/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.attn.1.ffn.3.weight, %inner_unet.inner_unet.down_blocks.2.attn.1.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.1/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.1/Add_4"](%/down_blocks.2/attn.1/ffn/ffn.3/Conv_output_0, %/down_blocks.2/attn.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.2/attn.2/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.2/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/norm/Reshape"](%/down_blocks.2/attn.1/Add_4_output_0, %/down_blocks.2/attn.2/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.2/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.2/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.2/norm/InstanceNormalization"](%/down_blocks.2/attn.2/norm/Reshape_output_0, %/down_blocks.2/attn.2/norm/Constant_1_output_0, %/down_blocks.2/attn.2/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.2/norm/Shape"](%/down_blocks.2/attn.1/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/norm/Reshape_1"](%/down_blocks.2/attn.2/norm/InstanceNormalization_output_0, %/down_blocks.2/attn.2/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/norm/Mul"](%/down_blocks.2/attn.2/norm/Reshape_1_output_0, %onnx::Mul_9460), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.2/norm/Add"](%/down_blocks.2/attn.2/norm/Mul_output_0, %onnx::Add_9461), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.2/qkv/Conv"](%/down_blocks.2/attn.2/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.2.qkv.weight, %inner_unet.inner_unet.down_blocks.2.attn.2.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.2/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/Reshape"](%/down_blocks.2/attn.2/qkv/Conv_output_0, %/down_blocks.2/attn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.2/Shape"](%/down_blocks.2/attn.2/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.2/Gather"](%/down_blocks.2/attn.2/Shape_output_0, %/down_blocks.2/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.2/Add"](%/down_blocks.2/attn.2/Gather_output_0, %/down_blocks.2/attn.2/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.2/Div"](%/down_blocks.2/attn.2/Add_output_0, %/down_blocks.2/attn.2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/Mul"](%/down_blocks.2/attn.2/Div_output_0, %/down_blocks.2/attn.2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.2/Slice"](%/down_blocks.2/attn.2/Reshape_output_0, %/down_blocks.2/attn.2/Constant_2_output_0, %/down_blocks.2/attn.2/Mul_output_0, %/down_blocks.2/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/Mul_1"](%/down_blocks.2/attn.2/Div_output_0, %/down_blocks.2/attn.2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.2/Slice_1"](%/down_blocks.2/attn.2/Reshape_output_0, %/down_blocks.2/attn.2/Mul_output_0, %/down_blocks.2/attn.2/Mul_1_output_0, %/down_blocks.2/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/Mul_2"](%/down_blocks.2/attn.2/Div_output_0, %/down_blocks.2/attn.2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.2/Slice_2"](%/down_blocks.2/attn.2/Reshape_output_0, %/down_blocks.2/attn.2/Mul_1_output_0, %/down_blocks.2/attn.2/Mul_2_output_0, %/down_blocks.2/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.2/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/down_blocks.2/attn.2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.2/attn.2/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.2/attn.2/Reciprocal"](%/down_blocks.2/attn.2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.2/attn.2/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/Mul_3"](%/down_blocks.2/attn.2/Slice_output_0, %/down_blocks.2/attn.2/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.2/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.2/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.2/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/Reshape_1"](%/down_blocks.2/attn.2/Mul_3_output_0, %/down_blocks.2/attn.2/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.2/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/Mul_4"](%/down_blocks.2/attn.2/Slice_1_output_0, %/down_blocks.2/attn.2/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.2/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.2/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.2/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.2/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.2/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.2/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.2/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.2/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.2/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/Reshape_2"](%/down_blocks.2/attn.2/Mul_4_output_0, %/down_blocks.2/attn.2/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.2/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.2/Einsum"](%/down_blocks.2/attn.2/Reshape_1_output_0, %/down_blocks.2/attn.2/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.2/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.2/Cast"](%/down_blocks.2/attn.2/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.2/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.2/Softmax"](%/down_blocks.2/attn.2/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.2/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.2/Cast_1"](%/down_blocks.2/attn.2/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.2/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/Reshape_3"](%/down_blocks.2/attn.2/Slice_2_output_0, %/down_blocks.2/attn.2/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.2/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.2/Einsum_1"](%/down_blocks.2/attn.2/Cast_1_output_0, %/down_blocks.2/attn.2/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.2/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.2/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.2/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.2/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.2/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/Reshape_4"](%/down_blocks.2/attn.2/Einsum_1_output_0, %/down_blocks.2/attn.2/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.2/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.2/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.2.norm_cond.weight, %inner_unet.inner_unet.down_blocks.2.attn.2.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.2/attn.2/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.2/attn.2/kv_cond/MatMul"](%/down_blocks.2/attn.2/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9494), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.2/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.2/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.2.attn.2.kv_cond.bias, %/down_blocks.2/attn.2/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.2/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.2/attn.2/Transpose"](%/down_blocks.2/attn.2/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.2/attn.2/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.2/Shape_1"](%/down_blocks.2/attn.2/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.2/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.2/Gather_1"](%/down_blocks.2/attn.2/Shape_1_output_0, %/down_blocks.2/attn.2/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.2/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.2/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.2/Add_1"](%/down_blocks.2/attn.2/Gather_1_output_0, %/down_blocks.2/attn.2/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.2/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.2/Div_1"](%/down_blocks.2/attn.2/Add_1_output_0, %/down_blocks.2/attn.2/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.2/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/Mul_5"](%/down_blocks.2/attn.2/Div_1_output_0, %/down_blocks.2/attn.2/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.2/Slice_3"](%/down_blocks.2/attn.2/Transpose_output_0, %/down_blocks.2/attn.2/Constant_17_output_0, %/down_blocks.2/attn.2/Mul_5_output_0, %/down_blocks.2/attn.2/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.2/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/Mul_6"](%/down_blocks.2/attn.2/Div_1_output_0, %/down_blocks.2/attn.2/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.2/Slice_4"](%/down_blocks.2/attn.2/Transpose_output_0, %/down_blocks.2/attn.2/Mul_5_output_0, %/down_blocks.2/attn.2/Mul_6_output_0, %/down_blocks.2/attn.2/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.2/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/Mul_7"](%/down_blocks.2/attn.2/Slice_3_output_0, %/down_blocks.2/attn.2/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.2/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/Reshape_5"](%/down_blocks.2/attn.2/Mul_7_output_0, %/down_blocks.2/attn.2/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.2/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.2/Einsum_2"](%/down_blocks.2/attn.2/Reshape_1_output_0, %/down_blocks.2/attn.2/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.2/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.2/Cast_2"](%/down_blocks.2/attn.2/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.2/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.2/Softmax_1"](%/down_blocks.2/attn.2/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.2/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.2/Cast_3"](%/down_blocks.2/attn.2/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.2/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/Reshape_6"](%/down_blocks.2/attn.2/Slice_4_output_0, %/down_blocks.2/attn.2/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.2/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.2/Einsum_3"](%/down_blocks.2/attn.2/Cast_3_output_0, %/down_blocks.2/attn.2/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.2/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/Reshape_7"](%/down_blocks.2/attn.2/Einsum_3_output_0, %/down_blocks.2/attn.2/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.2/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.2/Add_2"](%/down_blocks.2/attn.2/Reshape_4_output_0, %/down_blocks.2/attn.2/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.2/attn.2/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/down_blocks.2/attn.2/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.2/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/Reshape_8"](%/down_blocks.2/attn.2/Add_2_output_0, %/down_blocks.2/attn.2/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.2/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.2/proj_out/Conv"](%/down_blocks.2/attn.2/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.2.attn.2.proj_out.weight, %inner_unet.inner_unet.down_blocks.2.attn.2.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.2/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.2/Add_3"](%/down_blocks.2/attn.1/Add_4_output_0, %/down_blocks.2/attn.2/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.2/attn.2/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.2/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/ffn/ffn.0/Reshape"](%/down_blocks.2/attn.2/Add_3_output_0, %/down_blocks.2/attn.2/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.2/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.2/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.2/ffn/ffn.0/InstanceNormalization"](%/down_blocks.2/attn.2/ffn/ffn.0/Reshape_output_0, %/down_blocks.2/attn.2/ffn/ffn.0/Constant_1_output_0, %/down_blocks.2/attn.2/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.2/ffn/ffn.0/Shape"](%/down_blocks.2/attn.2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.2/ffn/ffn.0/Reshape_1"](%/down_blocks.2/attn.2/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.2/attn.2/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/ffn/ffn.0/Mul"](%/down_blocks.2/attn.2/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9500), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.2/ffn/ffn.0/Add"](%/down_blocks.2/attn.2/ffn/ffn.0/Mul_output_0, %onnx::Add_9501), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.2/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.2/ffn/ffn.1/Conv"](%/down_blocks.2/attn.2/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.2.ffn.1.weight, %inner_unet.inner_unet.down_blocks.2.attn.2.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.2/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.2/attn.2/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.2/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.2/ffn/ffn.2/Div"](%/down_blocks.2/attn.2/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.2/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.2/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.2/attn.2/ffn/ffn.2/Erf"](%/down_blocks.2/attn.2/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.2/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.2/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.2/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.2/ffn/ffn.2/Add"](%/down_blocks.2/attn.2/ffn/ffn.2/Erf_output_0, %/down_blocks.2/attn.2/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.2/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/ffn/ffn.2/Mul"](%/down_blocks.2/attn.2/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.2/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.2/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.2/attn.2/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.2/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.2/ffn/ffn.2/Mul_1"](%/down_blocks.2/attn.2/ffn/ffn.2/Mul_output_0, %/down_blocks.2/attn.2/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.2/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.2/ffn/ffn.3/Conv"](%/down_blocks.2/attn.2/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.attn.2.ffn.3.weight, %inner_unet.inner_unet.down_blocks.2.attn.2.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.2/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.2/Add_4"](%/down_blocks.2/attn.2/ffn/ffn.3/Conv_output_0, %/down_blocks.2/attn.2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.2/attn.3/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.3/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/norm/Reshape"](%/down_blocks.2/attn.2/Add_4_output_0, %/down_blocks.2/attn.3/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.3/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.3/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.3/norm/InstanceNormalization"](%/down_blocks.2/attn.3/norm/Reshape_output_0, %/down_blocks.2/attn.3/norm/Constant_1_output_0, %/down_blocks.2/attn.3/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.3/norm/Shape"](%/down_blocks.2/attn.2/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/norm/Reshape_1"](%/down_blocks.2/attn.3/norm/InstanceNormalization_output_0, %/down_blocks.2/attn.3/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/norm/Mul"](%/down_blocks.2/attn.3/norm/Reshape_1_output_0, %onnx::Mul_9502), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.3/norm/Add"](%/down_blocks.2/attn.3/norm/Mul_output_0, %onnx::Add_9503), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.3/qkv/Conv"](%/down_blocks.2/attn.3/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.3.qkv.weight, %inner_unet.inner_unet.down_blocks.2.attn.3.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.3/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.3/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/Reshape"](%/down_blocks.2/attn.3/qkv/Conv_output_0, %/down_blocks.2/attn.3/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.3/Shape"](%/down_blocks.2/attn.3/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.3/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.3/Gather"](%/down_blocks.2/attn.3/Shape_output_0, %/down_blocks.2/attn.3/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.3/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.3/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.3/Add"](%/down_blocks.2/attn.3/Gather_output_0, %/down_blocks.2/attn.3/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.3/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.3/Div"](%/down_blocks.2/attn.3/Add_output_0, %/down_blocks.2/attn.3/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.3/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/Mul"](%/down_blocks.2/attn.3/Div_output_0, %/down_blocks.2/attn.3/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.3/Slice"](%/down_blocks.2/attn.3/Reshape_output_0, %/down_blocks.2/attn.3/Constant_2_output_0, %/down_blocks.2/attn.3/Mul_output_0, %/down_blocks.2/attn.3/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.3/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/Mul_1"](%/down_blocks.2/attn.3/Div_output_0, %/down_blocks.2/attn.3/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.3/Slice_1"](%/down_blocks.2/attn.3/Reshape_output_0, %/down_blocks.2/attn.3/Mul_output_0, %/down_blocks.2/attn.3/Mul_1_output_0, %/down_blocks.2/attn.3/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.3/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/Mul_2"](%/down_blocks.2/attn.3/Div_output_0, %/down_blocks.2/attn.3/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.3/Slice_2"](%/down_blocks.2/attn.3/Reshape_output_0, %/down_blocks.2/attn.3/Mul_1_output_0, %/down_blocks.2/attn.3/Mul_2_output_0, %/down_blocks.2/attn.3/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.3/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/down_blocks.2/attn.3/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.2/attn.3/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.2/attn.3/Reciprocal"](%/down_blocks.2/attn.3/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.2/attn.3/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/Mul_3"](%/down_blocks.2/attn.3/Slice_output_0, %/down_blocks.2/attn.3/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.3/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.3/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.3/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/Reshape_1"](%/down_blocks.2/attn.3/Mul_3_output_0, %/down_blocks.2/attn.3/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.3/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/Mul_4"](%/down_blocks.2/attn.3/Slice_1_output_0, %/down_blocks.2/attn.3/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.3/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.3/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.3/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.3/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.3/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.3/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.3/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.3/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.3/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/Reshape_2"](%/down_blocks.2/attn.3/Mul_4_output_0, %/down_blocks.2/attn.3/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.3/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.3/Einsum"](%/down_blocks.2/attn.3/Reshape_1_output_0, %/down_blocks.2/attn.3/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.3/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.3/Cast"](%/down_blocks.2/attn.3/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.3/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.3/Softmax"](%/down_blocks.2/attn.3/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.3/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.3/Cast_1"](%/down_blocks.2/attn.3/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.3/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/Reshape_3"](%/down_blocks.2/attn.3/Slice_2_output_0, %/down_blocks.2/attn.3/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.3/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.3/Einsum_1"](%/down_blocks.2/attn.3/Cast_1_output_0, %/down_blocks.2/attn.3/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.3/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.3/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.3/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.3/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.3/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/Reshape_4"](%/down_blocks.2/attn.3/Einsum_1_output_0, %/down_blocks.2/attn.3/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.3/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.3/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.3.norm_cond.weight, %inner_unet.inner_unet.down_blocks.2.attn.3.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.2/attn.3/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.2/attn.3/kv_cond/MatMul"](%/down_blocks.2/attn.3/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9536), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.3/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.3/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.2.attn.3.kv_cond.bias, %/down_blocks.2/attn.3/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.3/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.2/attn.3/Transpose"](%/down_blocks.2/attn.3/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.2/attn.3/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.3/Shape_1"](%/down_blocks.2/attn.3/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.3/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.3/Gather_1"](%/down_blocks.2/attn.3/Shape_1_output_0, %/down_blocks.2/attn.3/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.3/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.3/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.3/Add_1"](%/down_blocks.2/attn.3/Gather_1_output_0, %/down_blocks.2/attn.3/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.3/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.3/Div_1"](%/down_blocks.2/attn.3/Add_1_output_0, %/down_blocks.2/attn.3/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.3/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/Mul_5"](%/down_blocks.2/attn.3/Div_1_output_0, %/down_blocks.2/attn.3/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.3/Slice_3"](%/down_blocks.2/attn.3/Transpose_output_0, %/down_blocks.2/attn.3/Constant_17_output_0, %/down_blocks.2/attn.3/Mul_5_output_0, %/down_blocks.2/attn.3/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.3/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/Mul_6"](%/down_blocks.2/attn.3/Div_1_output_0, %/down_blocks.2/attn.3/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.3/Slice_4"](%/down_blocks.2/attn.3/Transpose_output_0, %/down_blocks.2/attn.3/Mul_5_output_0, %/down_blocks.2/attn.3/Mul_6_output_0, %/down_blocks.2/attn.3/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.3/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/Mul_7"](%/down_blocks.2/attn.3/Slice_3_output_0, %/down_blocks.2/attn.3/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.3/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/Reshape_5"](%/down_blocks.2/attn.3/Mul_7_output_0, %/down_blocks.2/attn.3/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.3/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.3/Einsum_2"](%/down_blocks.2/attn.3/Reshape_1_output_0, %/down_blocks.2/attn.3/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.3/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.3/Cast_2"](%/down_blocks.2/attn.3/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.3/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.3/Softmax_1"](%/down_blocks.2/attn.3/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.3/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.3/Cast_3"](%/down_blocks.2/attn.3/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.3/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/Reshape_6"](%/down_blocks.2/attn.3/Slice_4_output_0, %/down_blocks.2/attn.3/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.3/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.3/Einsum_3"](%/down_blocks.2/attn.3/Cast_3_output_0, %/down_blocks.2/attn.3/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.3/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/Reshape_7"](%/down_blocks.2/attn.3/Einsum_3_output_0, %/down_blocks.2/attn.3/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.3/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.3/Add_2"](%/down_blocks.2/attn.3/Reshape_4_output_0, %/down_blocks.2/attn.3/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.2/attn.3/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/down_blocks.2/attn.3/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.3/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/Reshape_8"](%/down_blocks.2/attn.3/Add_2_output_0, %/down_blocks.2/attn.3/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.3/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.3/proj_out/Conv"](%/down_blocks.2/attn.3/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.2.attn.3.proj_out.weight, %inner_unet.inner_unet.down_blocks.2.attn.3.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.3/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.3/Add_3"](%/down_blocks.2/attn.2/Add_4_output_0, %/down_blocks.2/attn.3/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.2/attn.3/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.3/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/ffn/ffn.0/Reshape"](%/down_blocks.2/attn.3/Add_3_output_0, %/down_blocks.2/attn.3/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.3/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.3/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.3/ffn/ffn.0/InstanceNormalization"](%/down_blocks.2/attn.3/ffn/ffn.0/Reshape_output_0, %/down_blocks.2/attn.3/ffn/ffn.0/Constant_1_output_0, %/down_blocks.2/attn.3/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.3/ffn/ffn.0/Shape"](%/down_blocks.2/attn.3/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.3/ffn/ffn.0/Reshape_1"](%/down_blocks.2/attn.3/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.2/attn.3/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/ffn/ffn.0/Mul"](%/down_blocks.2/attn.3/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9542), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.3/ffn/ffn.0/Add"](%/down_blocks.2/attn.3/ffn/ffn.0/Mul_output_0, %onnx::Add_9543), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.3/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.3/ffn/ffn.1/Conv"](%/down_blocks.2/attn.3/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.3.ffn.1.weight, %inner_unet.inner_unet.down_blocks.2.attn.3.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.3/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.2/attn.3/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.3/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.3/ffn/ffn.2/Div"](%/down_blocks.2/attn.3/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.3/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.3/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.2/attn.3/ffn/ffn.2/Erf"](%/down_blocks.2/attn.3/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.3/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.3/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.3/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.3/ffn/ffn.2/Add"](%/down_blocks.2/attn.3/ffn/ffn.2/Erf_output_0, %/down_blocks.2/attn.3/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.3/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/ffn/ffn.2/Mul"](%/down_blocks.2/attn.3/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.3/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.3/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.2/attn.3/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.3/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.3/ffn/ffn.2/Mul_1"](%/down_blocks.2/attn.3/ffn/ffn.2/Mul_output_0, %/down_blocks.2/attn.3/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.3/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.3/ffn/ffn.3/Conv"](%/down_blocks.2/attn.3/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.attn.3.ffn.3.weight, %inner_unet.inner_unet.down_blocks.2.attn.3.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.3/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.3/Add_4"](%/down_blocks.2/attn.3/ffn/ffn.3/Conv_output_0, %/down_blocks.2/attn.3/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.2/attn.4/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.4/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/norm/Reshape"](%/down_blocks.2/attn.3/Add_4_output_0, %/down_blocks.2/attn.4/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.4/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.4/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.4/norm/InstanceNormalization"](%/down_blocks.2/attn.4/norm/Reshape_output_0, %/down_blocks.2/attn.4/norm/Constant_1_output_0, %/down_blocks.2/attn.4/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.4/norm/Shape"](%/down_blocks.2/attn.3/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/norm/Reshape_1"](%/down_blocks.2/attn.4/norm/InstanceNormalization_output_0, %/down_blocks.2/attn.4/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/norm/Mul"](%/down_blocks.2/attn.4/norm/Reshape_1_output_0, %onnx::Mul_9544), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.4/norm/Add"](%/down_blocks.2/attn.4/norm/Mul_output_0, %onnx::Add_9545), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.4/qkv/Conv"](%/down_blocks.2/attn.4/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.4.qkv.weight, %inner_unet.inner_unet.down_blocks.2.attn.4.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.4/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.4/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/Reshape"](%/down_blocks.2/attn.4/qkv/Conv_output_0, %/down_blocks.2/attn.4/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.4/Shape"](%/down_blocks.2/attn.4/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.4/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.4/Gather"](%/down_blocks.2/attn.4/Shape_output_0, %/down_blocks.2/attn.4/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.4/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.4/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.4/Add"](%/down_blocks.2/attn.4/Gather_output_0, %/down_blocks.2/attn.4/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.4/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.4/Div"](%/down_blocks.2/attn.4/Add_output_0, %/down_blocks.2/attn.4/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.4/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/Mul"](%/down_blocks.2/attn.4/Div_output_0, %/down_blocks.2/attn.4/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.4/Slice"](%/down_blocks.2/attn.4/Reshape_output_0, %/down_blocks.2/attn.4/Constant_2_output_0, %/down_blocks.2/attn.4/Mul_output_0, %/down_blocks.2/attn.4/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.4/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/Mul_1"](%/down_blocks.2/attn.4/Div_output_0, %/down_blocks.2/attn.4/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.4/Slice_1"](%/down_blocks.2/attn.4/Reshape_output_0, %/down_blocks.2/attn.4/Mul_output_0, %/down_blocks.2/attn.4/Mul_1_output_0, %/down_blocks.2/attn.4/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.4/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/Mul_2"](%/down_blocks.2/attn.4/Div_output_0, %/down_blocks.2/attn.4/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.4/Slice_2"](%/down_blocks.2/attn.4/Reshape_output_0, %/down_blocks.2/attn.4/Mul_1_output_0, %/down_blocks.2/attn.4/Mul_2_output_0, %/down_blocks.2/attn.4/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.4/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/down_blocks.2/attn.4/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.2/attn.4/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.2/attn.4/Reciprocal"](%/down_blocks.2/attn.4/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.2/attn.4/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/Mul_3"](%/down_blocks.2/attn.4/Slice_output_0, %/down_blocks.2/attn.4/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.4/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.4/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.4/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/Reshape_1"](%/down_blocks.2/attn.4/Mul_3_output_0, %/down_blocks.2/attn.4/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.4/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/Mul_4"](%/down_blocks.2/attn.4/Slice_1_output_0, %/down_blocks.2/attn.4/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.4/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.4/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.4/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.4/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.4/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.4/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.4/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.4/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.4/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/Reshape_2"](%/down_blocks.2/attn.4/Mul_4_output_0, %/down_blocks.2/attn.4/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.4/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.4/Einsum"](%/down_blocks.2/attn.4/Reshape_1_output_0, %/down_blocks.2/attn.4/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.4/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.4/Cast"](%/down_blocks.2/attn.4/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.4/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.4/Softmax"](%/down_blocks.2/attn.4/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.4/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.4/Cast_1"](%/down_blocks.2/attn.4/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.4/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/Reshape_3"](%/down_blocks.2/attn.4/Slice_2_output_0, %/down_blocks.2/attn.4/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.4/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.4/Einsum_1"](%/down_blocks.2/attn.4/Cast_1_output_0, %/down_blocks.2/attn.4/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.4/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.4/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.4/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.4/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.4/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/Reshape_4"](%/down_blocks.2/attn.4/Einsum_1_output_0, %/down_blocks.2/attn.4/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.4/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.4/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.4.norm_cond.weight, %inner_unet.inner_unet.down_blocks.2.attn.4.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.2/attn.4/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.2/attn.4/kv_cond/MatMul"](%/down_blocks.2/attn.4/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9578), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.4/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.4/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.2.attn.4.kv_cond.bias, %/down_blocks.2/attn.4/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.4/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.2/attn.4/Transpose"](%/down_blocks.2/attn.4/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.2/attn.4/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.4/Shape_1"](%/down_blocks.2/attn.4/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.4/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.4/Gather_1"](%/down_blocks.2/attn.4/Shape_1_output_0, %/down_blocks.2/attn.4/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.4/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.4/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.4/Add_1"](%/down_blocks.2/attn.4/Gather_1_output_0, %/down_blocks.2/attn.4/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.4/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.4/Div_1"](%/down_blocks.2/attn.4/Add_1_output_0, %/down_blocks.2/attn.4/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.4/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/Mul_5"](%/down_blocks.2/attn.4/Div_1_output_0, %/down_blocks.2/attn.4/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.4/Slice_3"](%/down_blocks.2/attn.4/Transpose_output_0, %/down_blocks.2/attn.4/Constant_17_output_0, %/down_blocks.2/attn.4/Mul_5_output_0, %/down_blocks.2/attn.4/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.4/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/Mul_6"](%/down_blocks.2/attn.4/Div_1_output_0, %/down_blocks.2/attn.4/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.4/Slice_4"](%/down_blocks.2/attn.4/Transpose_output_0, %/down_blocks.2/attn.4/Mul_5_output_0, %/down_blocks.2/attn.4/Mul_6_output_0, %/down_blocks.2/attn.4/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.4/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/Mul_7"](%/down_blocks.2/attn.4/Slice_3_output_0, %/down_blocks.2/attn.4/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.4/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/Reshape_5"](%/down_blocks.2/attn.4/Mul_7_output_0, %/down_blocks.2/attn.4/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.4/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.4/Einsum_2"](%/down_blocks.2/attn.4/Reshape_1_output_0, %/down_blocks.2/attn.4/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.4/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.4/Cast_2"](%/down_blocks.2/attn.4/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.4/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.4/Softmax_1"](%/down_blocks.2/attn.4/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.4/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.4/Cast_3"](%/down_blocks.2/attn.4/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.4/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/Reshape_6"](%/down_blocks.2/attn.4/Slice_4_output_0, %/down_blocks.2/attn.4/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.4/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.4/Einsum_3"](%/down_blocks.2/attn.4/Cast_3_output_0, %/down_blocks.2/attn.4/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.4/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/Reshape_7"](%/down_blocks.2/attn.4/Einsum_3_output_0, %/down_blocks.2/attn.4/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.4/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.4/Add_2"](%/down_blocks.2/attn.4/Reshape_4_output_0, %/down_blocks.2/attn.4/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.2/attn.4/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/down_blocks.2/attn.4/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.4/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/Reshape_8"](%/down_blocks.2/attn.4/Add_2_output_0, %/down_blocks.2/attn.4/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.4/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.4/proj_out/Conv"](%/down_blocks.2/attn.4/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.2.attn.4.proj_out.weight, %inner_unet.inner_unet.down_blocks.2.attn.4.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.4/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.4/Add_3"](%/down_blocks.2/attn.3/Add_4_output_0, %/down_blocks.2/attn.4/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.2/attn.4/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.4/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/ffn/ffn.0/Reshape"](%/down_blocks.2/attn.4/Add_3_output_0, %/down_blocks.2/attn.4/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.4/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.4/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.4/ffn/ffn.0/InstanceNormalization"](%/down_blocks.2/attn.4/ffn/ffn.0/Reshape_output_0, %/down_blocks.2/attn.4/ffn/ffn.0/Constant_1_output_0, %/down_blocks.2/attn.4/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.4/ffn/ffn.0/Shape"](%/down_blocks.2/attn.4/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.4/ffn/ffn.0/Reshape_1"](%/down_blocks.2/attn.4/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.2/attn.4/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/ffn/ffn.0/Mul"](%/down_blocks.2/attn.4/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9584), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.4/ffn/ffn.0/Add"](%/down_blocks.2/attn.4/ffn/ffn.0/Mul_output_0, %onnx::Add_9585), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.4/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.4/ffn/ffn.1/Conv"](%/down_blocks.2/attn.4/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.4.ffn.1.weight, %inner_unet.inner_unet.down_blocks.2.attn.4.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.4/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.2/attn.4/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.4/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.4/ffn/ffn.2/Div"](%/down_blocks.2/attn.4/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.4/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.4/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.2/attn.4/ffn/ffn.2/Erf"](%/down_blocks.2/attn.4/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.4/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.4/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.4/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.4/ffn/ffn.2/Add"](%/down_blocks.2/attn.4/ffn/ffn.2/Erf_output_0, %/down_blocks.2/attn.4/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.4/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/ffn/ffn.2/Mul"](%/down_blocks.2/attn.4/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.4/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.4/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.2/attn.4/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.4/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.4/ffn/ffn.2/Mul_1"](%/down_blocks.2/attn.4/ffn/ffn.2/Mul_output_0, %/down_blocks.2/attn.4/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.4/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.4/ffn/ffn.3/Conv"](%/down_blocks.2/attn.4/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.attn.4.ffn.3.weight, %inner_unet.inner_unet.down_blocks.2.attn.4.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.4/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.4/Add_4"](%/down_blocks.2/attn.4/ffn/ffn.3/Conv_output_0, %/down_blocks.2/attn.4/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.2/resnets.1/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/resnets.1/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm1/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.1/norm1/Reshape"](%/down_blocks.2/attn.4/Add_4_output_0, %/down_blocks.2/resnets.1/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.1/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.1/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm1/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/resnets.1/norm1/InstanceNormalization"](%/down_blocks.2/resnets.1/norm1/Reshape_output_0, %/down_blocks.2/resnets.1/norm1/Constant_1_output_0, %/down_blocks.2/resnets.1/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.1/norm1/Shape"](%/down_blocks.2/attn.4/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm1/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.1/norm1/Reshape_1"](%/down_blocks.2/resnets.1/norm1/InstanceNormalization_output_0, %/down_blocks.2/resnets.1/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm1/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.1/norm1/Mul"](%/down_blocks.2/resnets.1/norm1/Reshape_1_output_0, %onnx::Mul_9586), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm1/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.1/norm1/Add"](%/down_blocks.2/resnets.1/norm1/Mul_output_0, %onnx::Add_9587), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/Sigmoid_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.2/resnets.1/Sigmoid"](%/down_blocks.2/resnets.1/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.1/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.1/Mul"](%/down_blocks.2/resnets.1/norm1/Add_output_0, %/down_blocks.2/resnets.1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.1/conv1/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.2/resnets.1/conv1/Conv"](%/down_blocks.2/resnets.1/Mul_output_0, %inner_unet.inner_unet.down_blocks.2.resnets.1.conv1.weight, %inner_unet.inner_unet.down_blocks.2.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.1/time_layer/Gemm_output_0 : Float(1, 1536, strides=[1536, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/down_blocks.2/resnets.1/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.resnets.1.time_layer.weight, %inner_unet.inner_unet.down_blocks.2.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/resnets.1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.2/resnets.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Unsqueeze_output_0 : Float(1, 1536, 1, strides=[1536, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.2/resnets.1/Unsqueeze"](%/down_blocks.2/resnets.1/time_layer/Gemm_output_0, %/down_blocks.2/resnets.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/down_blocks.2/resnets.1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Unsqueeze_1_output_0 : Float(1, 1536, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/down_blocks.2/resnets.1/Unsqueeze_1"](%/down_blocks.2/resnets.1/Unsqueeze_output_0, %/down_blocks.2/resnets.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.1/Shape"](%/down_blocks.2/resnets.1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/resnets.1/Gather"](%/down_blocks.2/resnets.1/Shape_output_0, %/down_blocks.2/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/resnets.1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/resnets.1/Add"](%/down_blocks.2/resnets.1/Gather_output_0, %/down_blocks.2/resnets.1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/resnets.1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/resnets.1/Div"](%/down_blocks.2/resnets.1/Add_output_0, %/down_blocks.2/resnets.1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.1/Mul_1"](%/down_blocks.2/resnets.1/Div_output_0, %/down_blocks.2/resnets.1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Slice_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/resnets.1/Slice"](%/down_blocks.2/resnets.1/Unsqueeze_1_output_0, %/down_blocks.2/resnets.1/Constant_3_output_0, %/down_blocks.2/resnets.1/Mul_1_output_0, %/down_blocks.2/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/resnets.1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.1/Mul_2"](%/down_blocks.2/resnets.1/Div_output_0, %/down_blocks.2/resnets.1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/Slice_1_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/resnets.1/Slice_1"](%/down_blocks.2/resnets.1/Unsqueeze_1_output_0, %/down_blocks.2/resnets.1/Mul_1_output_0, %/down_blocks.2/resnets.1/Mul_2_output_0, %/down_blocks.2/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/down_blocks.2/resnets.1/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/resnets.1/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm2/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.1/norm2/Reshape"](%/down_blocks.2/resnets.1/conv1/Conv_output_0, %/down_blocks.2/resnets.1/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.1/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/resnets.1/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm2/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/resnets.1/norm2/InstanceNormalization"](%/down_blocks.2/resnets.1/norm2/Reshape_output_0, %/down_blocks.2/resnets.1/norm2/Constant_1_output_0, %/down_blocks.2/resnets.1/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/resnets.1/norm2/Shape"](%/down_blocks.2/resnets.1/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm2/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/resnets.1/norm2/Reshape_1"](%/down_blocks.2/resnets.1/norm2/InstanceNormalization_output_0, %/down_blocks.2/resnets.1/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm2/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/resnets.1/norm2/Mul"](%/down_blocks.2/resnets.1/norm2/Reshape_1_output_0, %onnx::Mul_9588), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/norm2/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.1/norm2/Add"](%/down_blocks.2/resnets.1/norm2/Mul_output_0, %onnx::Add_9589), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/resnets.1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/resnets.1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.1/Add_1_output_0 : Float(1, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.1/Add_1"](%/down_blocks.2/resnets.1/Slice_output_0, %/down_blocks.2/resnets.1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.1/Mul_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.1/Mul_3"](%/down_blocks.2/resnets.1/norm2/Add_output_0, %/down_blocks.2/resnets.1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.1/Add_2_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.1/Add_2"](%/down_blocks.2/resnets.1/Mul_3_output_0, %/down_blocks.2/resnets.1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/down_blocks.2/resnets.1/Sigmoid_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/down_blocks.2/resnets.1/Sigmoid_1"](%/down_blocks.2/resnets.1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.1/Mul_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/resnets.1/Mul_4"](%/down_blocks.2/resnets.1/Add_2_output_0, %/down_blocks.2/resnets.1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/down_blocks.2/resnets.1/conv2/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/down_blocks.2/resnets.1/conv2/Conv"](%/down_blocks.2/resnets.1/Mul_4_output_0, %inner_unet.inner_unet.down_blocks.2.resnets.1.conv2.weight, %inner_unet.inner_unet.down_blocks.2.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/resnets.1/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/resnets.1/Add_3"](%/down_blocks.2/resnets.1/conv2/Conv_output_0, %/down_blocks.2/attn.4/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/down_blocks.2/attn.5/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.5/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/norm/Reshape"](%/down_blocks.2/resnets.1/Add_3_output_0, %/down_blocks.2/attn.5/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.5/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.5/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.5/norm/InstanceNormalization"](%/down_blocks.2/attn.5/norm/Reshape_output_0, %/down_blocks.2/attn.5/norm/Constant_1_output_0, %/down_blocks.2/attn.5/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.5/norm/Shape"](%/down_blocks.2/resnets.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/norm/Reshape_1"](%/down_blocks.2/attn.5/norm/InstanceNormalization_output_0, %/down_blocks.2/attn.5/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/norm/Mul"](%/down_blocks.2/attn.5/norm/Reshape_1_output_0, %onnx::Mul_9590), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.5/norm/Add"](%/down_blocks.2/attn.5/norm/Mul_output_0, %onnx::Add_9591), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.5/qkv/Conv"](%/down_blocks.2/attn.5/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.5.qkv.weight, %inner_unet.inner_unet.down_blocks.2.attn.5.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.5/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.5/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/Reshape"](%/down_blocks.2/attn.5/qkv/Conv_output_0, %/down_blocks.2/attn.5/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.5/Shape"](%/down_blocks.2/attn.5/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.5/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.5/Gather"](%/down_blocks.2/attn.5/Shape_output_0, %/down_blocks.2/attn.5/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.5/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.5/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.5/Add"](%/down_blocks.2/attn.5/Gather_output_0, %/down_blocks.2/attn.5/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.5/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.5/Div"](%/down_blocks.2/attn.5/Add_output_0, %/down_blocks.2/attn.5/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.5/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/Mul"](%/down_blocks.2/attn.5/Div_output_0, %/down_blocks.2/attn.5/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.5/Slice"](%/down_blocks.2/attn.5/Reshape_output_0, %/down_blocks.2/attn.5/Constant_2_output_0, %/down_blocks.2/attn.5/Mul_output_0, %/down_blocks.2/attn.5/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.5/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/Mul_1"](%/down_blocks.2/attn.5/Div_output_0, %/down_blocks.2/attn.5/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.5/Slice_1"](%/down_blocks.2/attn.5/Reshape_output_0, %/down_blocks.2/attn.5/Mul_output_0, %/down_blocks.2/attn.5/Mul_1_output_0, %/down_blocks.2/attn.5/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.5/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/Mul_2"](%/down_blocks.2/attn.5/Div_output_0, %/down_blocks.2/attn.5/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.5/Slice_2"](%/down_blocks.2/attn.5/Reshape_output_0, %/down_blocks.2/attn.5/Mul_1_output_0, %/down_blocks.2/attn.5/Mul_2_output_0, %/down_blocks.2/attn.5/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.5/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/down_blocks.2/attn.5/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.2/attn.5/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.2/attn.5/Reciprocal"](%/down_blocks.2/attn.5/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.2/attn.5/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/Mul_3"](%/down_blocks.2/attn.5/Slice_output_0, %/down_blocks.2/attn.5/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.5/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.5/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.5/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/Reshape_1"](%/down_blocks.2/attn.5/Mul_3_output_0, %/down_blocks.2/attn.5/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.5/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/Mul_4"](%/down_blocks.2/attn.5/Slice_1_output_0, %/down_blocks.2/attn.5/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.5/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.5/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.5/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.5/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.5/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.5/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.5/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.5/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.5/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/Reshape_2"](%/down_blocks.2/attn.5/Mul_4_output_0, %/down_blocks.2/attn.5/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.5/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.5/Einsum"](%/down_blocks.2/attn.5/Reshape_1_output_0, %/down_blocks.2/attn.5/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.5/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.5/Cast"](%/down_blocks.2/attn.5/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.5/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.5/Softmax"](%/down_blocks.2/attn.5/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.5/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.5/Cast_1"](%/down_blocks.2/attn.5/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.5/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/Reshape_3"](%/down_blocks.2/attn.5/Slice_2_output_0, %/down_blocks.2/attn.5/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.5/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.5/Einsum_1"](%/down_blocks.2/attn.5/Cast_1_output_0, %/down_blocks.2/attn.5/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.5/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.5/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.5/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.5/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.5/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/Reshape_4"](%/down_blocks.2/attn.5/Einsum_1_output_0, %/down_blocks.2/attn.5/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.5/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.5/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.5.norm_cond.weight, %inner_unet.inner_unet.down_blocks.2.attn.5.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.2/attn.5/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.2/attn.5/kv_cond/MatMul"](%/down_blocks.2/attn.5/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9624), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.5/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.5/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.2.attn.5.kv_cond.bias, %/down_blocks.2/attn.5/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.5/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.2/attn.5/Transpose"](%/down_blocks.2/attn.5/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.2/attn.5/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.5/Shape_1"](%/down_blocks.2/attn.5/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.5/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.5/Gather_1"](%/down_blocks.2/attn.5/Shape_1_output_0, %/down_blocks.2/attn.5/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.5/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.5/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.5/Add_1"](%/down_blocks.2/attn.5/Gather_1_output_0, %/down_blocks.2/attn.5/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.5/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.5/Div_1"](%/down_blocks.2/attn.5/Add_1_output_0, %/down_blocks.2/attn.5/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.5/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/Mul_5"](%/down_blocks.2/attn.5/Div_1_output_0, %/down_blocks.2/attn.5/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.5/Slice_3"](%/down_blocks.2/attn.5/Transpose_output_0, %/down_blocks.2/attn.5/Constant_17_output_0, %/down_blocks.2/attn.5/Mul_5_output_0, %/down_blocks.2/attn.5/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.5/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/Mul_6"](%/down_blocks.2/attn.5/Div_1_output_0, %/down_blocks.2/attn.5/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.5/Slice_4"](%/down_blocks.2/attn.5/Transpose_output_0, %/down_blocks.2/attn.5/Mul_5_output_0, %/down_blocks.2/attn.5/Mul_6_output_0, %/down_blocks.2/attn.5/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.5/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/Mul_7"](%/down_blocks.2/attn.5/Slice_3_output_0, %/down_blocks.2/attn.5/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.5/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/Reshape_5"](%/down_blocks.2/attn.5/Mul_7_output_0, %/down_blocks.2/attn.5/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.5/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.5/Einsum_2"](%/down_blocks.2/attn.5/Reshape_1_output_0, %/down_blocks.2/attn.5/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.5/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.5/Cast_2"](%/down_blocks.2/attn.5/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.5/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.5/Softmax_1"](%/down_blocks.2/attn.5/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.5/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.5/Cast_3"](%/down_blocks.2/attn.5/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.5/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/Reshape_6"](%/down_blocks.2/attn.5/Slice_4_output_0, %/down_blocks.2/attn.5/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.5/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.5/Einsum_3"](%/down_blocks.2/attn.5/Cast_3_output_0, %/down_blocks.2/attn.5/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.5/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/Reshape_7"](%/down_blocks.2/attn.5/Einsum_3_output_0, %/down_blocks.2/attn.5/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.5/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.5/Add_2"](%/down_blocks.2/attn.5/Reshape_4_output_0, %/down_blocks.2/attn.5/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.2/attn.5/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/down_blocks.2/attn.5/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.5/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/Reshape_8"](%/down_blocks.2/attn.5/Add_2_output_0, %/down_blocks.2/attn.5/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.5/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.5/proj_out/Conv"](%/down_blocks.2/attn.5/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.2.attn.5.proj_out.weight, %inner_unet.inner_unet.down_blocks.2.attn.5.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.5/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.5/Add_3"](%/down_blocks.2/resnets.1/Add_3_output_0, %/down_blocks.2/attn.5/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.2/attn.5/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.5/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/ffn/ffn.0/Reshape"](%/down_blocks.2/attn.5/Add_3_output_0, %/down_blocks.2/attn.5/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.5/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.5/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.5/ffn/ffn.0/InstanceNormalization"](%/down_blocks.2/attn.5/ffn/ffn.0/Reshape_output_0, %/down_blocks.2/attn.5/ffn/ffn.0/Constant_1_output_0, %/down_blocks.2/attn.5/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.5/ffn/ffn.0/Shape"](%/down_blocks.2/attn.5/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.5/ffn/ffn.0/Reshape_1"](%/down_blocks.2/attn.5/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.2/attn.5/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/ffn/ffn.0/Mul"](%/down_blocks.2/attn.5/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9630), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.5/ffn/ffn.0/Add"](%/down_blocks.2/attn.5/ffn/ffn.0/Mul_output_0, %onnx::Add_9631), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.5/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.5/ffn/ffn.1/Conv"](%/down_blocks.2/attn.5/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.5.ffn.1.weight, %inner_unet.inner_unet.down_blocks.2.attn.5.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.5/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.2/attn.5/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.5/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.5/ffn/ffn.2/Div"](%/down_blocks.2/attn.5/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.5/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.5/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.2/attn.5/ffn/ffn.2/Erf"](%/down_blocks.2/attn.5/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.5/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.5/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.5/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.5/ffn/ffn.2/Add"](%/down_blocks.2/attn.5/ffn/ffn.2/Erf_output_0, %/down_blocks.2/attn.5/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.5/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/ffn/ffn.2/Mul"](%/down_blocks.2/attn.5/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.5/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.5/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.2/attn.5/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.5/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.5/ffn/ffn.2/Mul_1"](%/down_blocks.2/attn.5/ffn/ffn.2/Mul_output_0, %/down_blocks.2/attn.5/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.5/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.5/ffn/ffn.3/Conv"](%/down_blocks.2/attn.5/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.attn.5.ffn.3.weight, %inner_unet.inner_unet.down_blocks.2.attn.5.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.5/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.5/Add_4"](%/down_blocks.2/attn.5/ffn/ffn.3/Conv_output_0, %/down_blocks.2/attn.5/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.2/attn.6/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.6/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/norm/Reshape"](%/down_blocks.2/attn.5/Add_4_output_0, %/down_blocks.2/attn.6/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.6/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.6/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.6/norm/InstanceNormalization"](%/down_blocks.2/attn.6/norm/Reshape_output_0, %/down_blocks.2/attn.6/norm/Constant_1_output_0, %/down_blocks.2/attn.6/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.6/norm/Shape"](%/down_blocks.2/attn.5/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/norm/Reshape_1"](%/down_blocks.2/attn.6/norm/InstanceNormalization_output_0, %/down_blocks.2/attn.6/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/norm/Mul"](%/down_blocks.2/attn.6/norm/Reshape_1_output_0, %onnx::Mul_9632), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.6/norm/Add"](%/down_blocks.2/attn.6/norm/Mul_output_0, %onnx::Add_9633), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.6/qkv/Conv"](%/down_blocks.2/attn.6/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.6.qkv.weight, %inner_unet.inner_unet.down_blocks.2.attn.6.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.6/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.6/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/Reshape"](%/down_blocks.2/attn.6/qkv/Conv_output_0, %/down_blocks.2/attn.6/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.6/Shape"](%/down_blocks.2/attn.6/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.6/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.6/Gather"](%/down_blocks.2/attn.6/Shape_output_0, %/down_blocks.2/attn.6/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.6/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.6/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.6/Add"](%/down_blocks.2/attn.6/Gather_output_0, %/down_blocks.2/attn.6/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.6/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.6/Div"](%/down_blocks.2/attn.6/Add_output_0, %/down_blocks.2/attn.6/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.6/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/Mul"](%/down_blocks.2/attn.6/Div_output_0, %/down_blocks.2/attn.6/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.6/Slice"](%/down_blocks.2/attn.6/Reshape_output_0, %/down_blocks.2/attn.6/Constant_2_output_0, %/down_blocks.2/attn.6/Mul_output_0, %/down_blocks.2/attn.6/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.6/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/Mul_1"](%/down_blocks.2/attn.6/Div_output_0, %/down_blocks.2/attn.6/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.6/Slice_1"](%/down_blocks.2/attn.6/Reshape_output_0, %/down_blocks.2/attn.6/Mul_output_0, %/down_blocks.2/attn.6/Mul_1_output_0, %/down_blocks.2/attn.6/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.6/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/Mul_2"](%/down_blocks.2/attn.6/Div_output_0, %/down_blocks.2/attn.6/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.6/Slice_2"](%/down_blocks.2/attn.6/Reshape_output_0, %/down_blocks.2/attn.6/Mul_1_output_0, %/down_blocks.2/attn.6/Mul_2_output_0, %/down_blocks.2/attn.6/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.6/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/down_blocks.2/attn.6/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.2/attn.6/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.2/attn.6/Reciprocal"](%/down_blocks.2/attn.6/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.2/attn.6/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/Mul_3"](%/down_blocks.2/attn.6/Slice_output_0, %/down_blocks.2/attn.6/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.6/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.6/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.6/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/Reshape_1"](%/down_blocks.2/attn.6/Mul_3_output_0, %/down_blocks.2/attn.6/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.6/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/Mul_4"](%/down_blocks.2/attn.6/Slice_1_output_0, %/down_blocks.2/attn.6/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.6/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.6/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.6/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.6/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.6/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.6/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.6/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.6/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.6/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/Reshape_2"](%/down_blocks.2/attn.6/Mul_4_output_0, %/down_blocks.2/attn.6/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.6/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.6/Einsum"](%/down_blocks.2/attn.6/Reshape_1_output_0, %/down_blocks.2/attn.6/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.6/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.6/Cast"](%/down_blocks.2/attn.6/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.6/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.6/Softmax"](%/down_blocks.2/attn.6/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.6/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.6/Cast_1"](%/down_blocks.2/attn.6/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.6/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/Reshape_3"](%/down_blocks.2/attn.6/Slice_2_output_0, %/down_blocks.2/attn.6/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.6/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.6/Einsum_1"](%/down_blocks.2/attn.6/Cast_1_output_0, %/down_blocks.2/attn.6/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.6/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.6/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.6/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.6/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.6/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/Reshape_4"](%/down_blocks.2/attn.6/Einsum_1_output_0, %/down_blocks.2/attn.6/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.6/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.6/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.6.norm_cond.weight, %inner_unet.inner_unet.down_blocks.2.attn.6.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.2/attn.6/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.2/attn.6/kv_cond/MatMul"](%/down_blocks.2/attn.6/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9666), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.6/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.6/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.2.attn.6.kv_cond.bias, %/down_blocks.2/attn.6/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.6/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.2/attn.6/Transpose"](%/down_blocks.2/attn.6/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.2/attn.6/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.6/Shape_1"](%/down_blocks.2/attn.6/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.6/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.6/Gather_1"](%/down_blocks.2/attn.6/Shape_1_output_0, %/down_blocks.2/attn.6/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.6/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.6/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.6/Add_1"](%/down_blocks.2/attn.6/Gather_1_output_0, %/down_blocks.2/attn.6/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.6/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.6/Div_1"](%/down_blocks.2/attn.6/Add_1_output_0, %/down_blocks.2/attn.6/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.6/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/Mul_5"](%/down_blocks.2/attn.6/Div_1_output_0, %/down_blocks.2/attn.6/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.6/Slice_3"](%/down_blocks.2/attn.6/Transpose_output_0, %/down_blocks.2/attn.6/Constant_17_output_0, %/down_blocks.2/attn.6/Mul_5_output_0, %/down_blocks.2/attn.6/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.6/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/Mul_6"](%/down_blocks.2/attn.6/Div_1_output_0, %/down_blocks.2/attn.6/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.6/Slice_4"](%/down_blocks.2/attn.6/Transpose_output_0, %/down_blocks.2/attn.6/Mul_5_output_0, %/down_blocks.2/attn.6/Mul_6_output_0, %/down_blocks.2/attn.6/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.6/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/Mul_7"](%/down_blocks.2/attn.6/Slice_3_output_0, %/down_blocks.2/attn.6/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.6/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/Reshape_5"](%/down_blocks.2/attn.6/Mul_7_output_0, %/down_blocks.2/attn.6/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.6/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.6/Einsum_2"](%/down_blocks.2/attn.6/Reshape_1_output_0, %/down_blocks.2/attn.6/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.6/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.6/Cast_2"](%/down_blocks.2/attn.6/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.6/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.6/Softmax_1"](%/down_blocks.2/attn.6/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.6/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.6/Cast_3"](%/down_blocks.2/attn.6/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.6/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/Reshape_6"](%/down_blocks.2/attn.6/Slice_4_output_0, %/down_blocks.2/attn.6/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.6/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.6/Einsum_3"](%/down_blocks.2/attn.6/Cast_3_output_0, %/down_blocks.2/attn.6/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.6/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/Reshape_7"](%/down_blocks.2/attn.6/Einsum_3_output_0, %/down_blocks.2/attn.6/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.6/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.6/Add_2"](%/down_blocks.2/attn.6/Reshape_4_output_0, %/down_blocks.2/attn.6/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.2/attn.6/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/down_blocks.2/attn.6/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.6/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/Reshape_8"](%/down_blocks.2/attn.6/Add_2_output_0, %/down_blocks.2/attn.6/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.6/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.6/proj_out/Conv"](%/down_blocks.2/attn.6/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.2.attn.6.proj_out.weight, %inner_unet.inner_unet.down_blocks.2.attn.6.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.6/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.6/Add_3"](%/down_blocks.2/attn.5/Add_4_output_0, %/down_blocks.2/attn.6/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.2/attn.6/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.6/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/ffn/ffn.0/Reshape"](%/down_blocks.2/attn.6/Add_3_output_0, %/down_blocks.2/attn.6/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.6/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.6/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.6/ffn/ffn.0/InstanceNormalization"](%/down_blocks.2/attn.6/ffn/ffn.0/Reshape_output_0, %/down_blocks.2/attn.6/ffn/ffn.0/Constant_1_output_0, %/down_blocks.2/attn.6/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.6/ffn/ffn.0/Shape"](%/down_blocks.2/attn.6/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.6/ffn/ffn.0/Reshape_1"](%/down_blocks.2/attn.6/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.2/attn.6/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/ffn/ffn.0/Mul"](%/down_blocks.2/attn.6/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9672), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.6/ffn/ffn.0/Add"](%/down_blocks.2/attn.6/ffn/ffn.0/Mul_output_0, %onnx::Add_9673), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.6/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.6/ffn/ffn.1/Conv"](%/down_blocks.2/attn.6/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.6.ffn.1.weight, %inner_unet.inner_unet.down_blocks.2.attn.6.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.6/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.2/attn.6/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.6/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.6/ffn/ffn.2/Div"](%/down_blocks.2/attn.6/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.6/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.6/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.2/attn.6/ffn/ffn.2/Erf"](%/down_blocks.2/attn.6/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.6/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.6/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.6/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.6/ffn/ffn.2/Add"](%/down_blocks.2/attn.6/ffn/ffn.2/Erf_output_0, %/down_blocks.2/attn.6/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.6/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/ffn/ffn.2/Mul"](%/down_blocks.2/attn.6/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.6/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.6/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.2/attn.6/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.6/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.6/ffn/ffn.2/Mul_1"](%/down_blocks.2/attn.6/ffn/ffn.2/Mul_output_0, %/down_blocks.2/attn.6/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.6/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.6/ffn/ffn.3/Conv"](%/down_blocks.2/attn.6/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.attn.6.ffn.3.weight, %inner_unet.inner_unet.down_blocks.2.attn.6.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.6/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.6/Add_4"](%/down_blocks.2/attn.6/ffn/ffn.3/Conv_output_0, %/down_blocks.2/attn.6/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.2/attn.7/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.7/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/norm/Reshape"](%/down_blocks.2/attn.6/Add_4_output_0, %/down_blocks.2/attn.7/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.7/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.7/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.7/norm/InstanceNormalization"](%/down_blocks.2/attn.7/norm/Reshape_output_0, %/down_blocks.2/attn.7/norm/Constant_1_output_0, %/down_blocks.2/attn.7/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.7/norm/Shape"](%/down_blocks.2/attn.6/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/norm/Reshape_1"](%/down_blocks.2/attn.7/norm/InstanceNormalization_output_0, %/down_blocks.2/attn.7/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/norm/Mul"](%/down_blocks.2/attn.7/norm/Reshape_1_output_0, %onnx::Mul_9674), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.7/norm/Add"](%/down_blocks.2/attn.7/norm/Mul_output_0, %onnx::Add_9675), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.7/qkv/Conv"](%/down_blocks.2/attn.7/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.7.qkv.weight, %inner_unet.inner_unet.down_blocks.2.attn.7.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.7/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.7/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/Reshape"](%/down_blocks.2/attn.7/qkv/Conv_output_0, %/down_blocks.2/attn.7/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.7/Shape"](%/down_blocks.2/attn.7/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.7/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.7/Gather"](%/down_blocks.2/attn.7/Shape_output_0, %/down_blocks.2/attn.7/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.7/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.7/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.7/Add"](%/down_blocks.2/attn.7/Gather_output_0, %/down_blocks.2/attn.7/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.7/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.7/Div"](%/down_blocks.2/attn.7/Add_output_0, %/down_blocks.2/attn.7/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.7/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/Mul"](%/down_blocks.2/attn.7/Div_output_0, %/down_blocks.2/attn.7/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.7/Slice"](%/down_blocks.2/attn.7/Reshape_output_0, %/down_blocks.2/attn.7/Constant_2_output_0, %/down_blocks.2/attn.7/Mul_output_0, %/down_blocks.2/attn.7/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.7/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/Mul_1"](%/down_blocks.2/attn.7/Div_output_0, %/down_blocks.2/attn.7/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.7/Slice_1"](%/down_blocks.2/attn.7/Reshape_output_0, %/down_blocks.2/attn.7/Mul_output_0, %/down_blocks.2/attn.7/Mul_1_output_0, %/down_blocks.2/attn.7/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.7/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/Mul_2"](%/down_blocks.2/attn.7/Div_output_0, %/down_blocks.2/attn.7/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.7/Slice_2"](%/down_blocks.2/attn.7/Reshape_output_0, %/down_blocks.2/attn.7/Mul_1_output_0, %/down_blocks.2/attn.7/Mul_2_output_0, %/down_blocks.2/attn.7/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.7/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/down_blocks.2/attn.7/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.2/attn.7/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.2/attn.7/Reciprocal"](%/down_blocks.2/attn.7/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.2/attn.7/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/Mul_3"](%/down_blocks.2/attn.7/Slice_output_0, %/down_blocks.2/attn.7/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.7/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.7/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.7/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/Reshape_1"](%/down_blocks.2/attn.7/Mul_3_output_0, %/down_blocks.2/attn.7/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.7/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/Mul_4"](%/down_blocks.2/attn.7/Slice_1_output_0, %/down_blocks.2/attn.7/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.7/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.7/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.7/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.7/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.7/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.7/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.7/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.7/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.7/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/Reshape_2"](%/down_blocks.2/attn.7/Mul_4_output_0, %/down_blocks.2/attn.7/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.7/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.7/Einsum"](%/down_blocks.2/attn.7/Reshape_1_output_0, %/down_blocks.2/attn.7/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.7/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.7/Cast"](%/down_blocks.2/attn.7/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.7/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.7/Softmax"](%/down_blocks.2/attn.7/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.7/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.7/Cast_1"](%/down_blocks.2/attn.7/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.7/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/Reshape_3"](%/down_blocks.2/attn.7/Slice_2_output_0, %/down_blocks.2/attn.7/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.7/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.7/Einsum_1"](%/down_blocks.2/attn.7/Cast_1_output_0, %/down_blocks.2/attn.7/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.7/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.7/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.7/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.7/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.7/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/Reshape_4"](%/down_blocks.2/attn.7/Einsum_1_output_0, %/down_blocks.2/attn.7/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.7/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.7/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.7.norm_cond.weight, %inner_unet.inner_unet.down_blocks.2.attn.7.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.2/attn.7/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.2/attn.7/kv_cond/MatMul"](%/down_blocks.2/attn.7/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9708), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.7/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.7/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.2.attn.7.kv_cond.bias, %/down_blocks.2/attn.7/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.7/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.2/attn.7/Transpose"](%/down_blocks.2/attn.7/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.2/attn.7/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.7/Shape_1"](%/down_blocks.2/attn.7/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.7/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.7/Gather_1"](%/down_blocks.2/attn.7/Shape_1_output_0, %/down_blocks.2/attn.7/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.7/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.7/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.7/Add_1"](%/down_blocks.2/attn.7/Gather_1_output_0, %/down_blocks.2/attn.7/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.7/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.7/Div_1"](%/down_blocks.2/attn.7/Add_1_output_0, %/down_blocks.2/attn.7/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.7/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/Mul_5"](%/down_blocks.2/attn.7/Div_1_output_0, %/down_blocks.2/attn.7/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.7/Slice_3"](%/down_blocks.2/attn.7/Transpose_output_0, %/down_blocks.2/attn.7/Constant_17_output_0, %/down_blocks.2/attn.7/Mul_5_output_0, %/down_blocks.2/attn.7/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.7/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/Mul_6"](%/down_blocks.2/attn.7/Div_1_output_0, %/down_blocks.2/attn.7/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.7/Slice_4"](%/down_blocks.2/attn.7/Transpose_output_0, %/down_blocks.2/attn.7/Mul_5_output_0, %/down_blocks.2/attn.7/Mul_6_output_0, %/down_blocks.2/attn.7/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.7/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/Mul_7"](%/down_blocks.2/attn.7/Slice_3_output_0, %/down_blocks.2/attn.7/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.7/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/Reshape_5"](%/down_blocks.2/attn.7/Mul_7_output_0, %/down_blocks.2/attn.7/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.7/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.7/Einsum_2"](%/down_blocks.2/attn.7/Reshape_1_output_0, %/down_blocks.2/attn.7/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.7/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.7/Cast_2"](%/down_blocks.2/attn.7/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.7/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.7/Softmax_1"](%/down_blocks.2/attn.7/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.7/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.7/Cast_3"](%/down_blocks.2/attn.7/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.7/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/Reshape_6"](%/down_blocks.2/attn.7/Slice_4_output_0, %/down_blocks.2/attn.7/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.7/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.7/Einsum_3"](%/down_blocks.2/attn.7/Cast_3_output_0, %/down_blocks.2/attn.7/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.7/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/Reshape_7"](%/down_blocks.2/attn.7/Einsum_3_output_0, %/down_blocks.2/attn.7/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.7/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.7/Add_2"](%/down_blocks.2/attn.7/Reshape_4_output_0, %/down_blocks.2/attn.7/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.2/attn.7/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/down_blocks.2/attn.7/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.7/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/Reshape_8"](%/down_blocks.2/attn.7/Add_2_output_0, %/down_blocks.2/attn.7/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.7/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.7/proj_out/Conv"](%/down_blocks.2/attn.7/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.2.attn.7.proj_out.weight, %inner_unet.inner_unet.down_blocks.2.attn.7.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.7/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.7/Add_3"](%/down_blocks.2/attn.6/Add_4_output_0, %/down_blocks.2/attn.7/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.2/attn.7/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.7/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/ffn/ffn.0/Reshape"](%/down_blocks.2/attn.7/Add_3_output_0, %/down_blocks.2/attn.7/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.7/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.7/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.7/ffn/ffn.0/InstanceNormalization"](%/down_blocks.2/attn.7/ffn/ffn.0/Reshape_output_0, %/down_blocks.2/attn.7/ffn/ffn.0/Constant_1_output_0, %/down_blocks.2/attn.7/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.7/ffn/ffn.0/Shape"](%/down_blocks.2/attn.7/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.7/ffn/ffn.0/Reshape_1"](%/down_blocks.2/attn.7/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.2/attn.7/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/ffn/ffn.0/Mul"](%/down_blocks.2/attn.7/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9714), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.7/ffn/ffn.0/Add"](%/down_blocks.2/attn.7/ffn/ffn.0/Mul_output_0, %onnx::Add_9715), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.7/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.7/ffn/ffn.1/Conv"](%/down_blocks.2/attn.7/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.7.ffn.1.weight, %inner_unet.inner_unet.down_blocks.2.attn.7.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.7/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.2/attn.7/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.7/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.7/ffn/ffn.2/Div"](%/down_blocks.2/attn.7/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.7/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.7/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.2/attn.7/ffn/ffn.2/Erf"](%/down_blocks.2/attn.7/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.7/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.7/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.7/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.7/ffn/ffn.2/Add"](%/down_blocks.2/attn.7/ffn/ffn.2/Erf_output_0, %/down_blocks.2/attn.7/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.7/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/ffn/ffn.2/Mul"](%/down_blocks.2/attn.7/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.7/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.7/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.2/attn.7/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.7/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.7/ffn/ffn.2/Mul_1"](%/down_blocks.2/attn.7/ffn/ffn.2/Mul_output_0, %/down_blocks.2/attn.7/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.7/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.7/ffn/ffn.3/Conv"](%/down_blocks.2/attn.7/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.attn.7.ffn.3.weight, %inner_unet.inner_unet.down_blocks.2.attn.7.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.7/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.7/Add_4"](%/down_blocks.2/attn.7/ffn/ffn.3/Conv_output_0, %/down_blocks.2/attn.7/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.2/attn.8/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.8/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/norm/Reshape"](%/down_blocks.2/attn.7/Add_4_output_0, %/down_blocks.2/attn.8/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.8/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.8/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.8/norm/InstanceNormalization"](%/down_blocks.2/attn.8/norm/Reshape_output_0, %/down_blocks.2/attn.8/norm/Constant_1_output_0, %/down_blocks.2/attn.8/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.8/norm/Shape"](%/down_blocks.2/attn.7/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/norm/Reshape_1"](%/down_blocks.2/attn.8/norm/InstanceNormalization_output_0, %/down_blocks.2/attn.8/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/norm/Mul"](%/down_blocks.2/attn.8/norm/Reshape_1_output_0, %onnx::Mul_9716), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.8/norm/Add"](%/down_blocks.2/attn.8/norm/Mul_output_0, %onnx::Add_9717), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.8/qkv/Conv"](%/down_blocks.2/attn.8/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.8.qkv.weight, %inner_unet.inner_unet.down_blocks.2.attn.8.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.8/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.8/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/Reshape"](%/down_blocks.2/attn.8/qkv/Conv_output_0, %/down_blocks.2/attn.8/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.8/Shape"](%/down_blocks.2/attn.8/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.8/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.8/Gather"](%/down_blocks.2/attn.8/Shape_output_0, %/down_blocks.2/attn.8/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.8/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.8/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.8/Add"](%/down_blocks.2/attn.8/Gather_output_0, %/down_blocks.2/attn.8/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.8/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.8/Div"](%/down_blocks.2/attn.8/Add_output_0, %/down_blocks.2/attn.8/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.8/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/Mul"](%/down_blocks.2/attn.8/Div_output_0, %/down_blocks.2/attn.8/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.8/Slice"](%/down_blocks.2/attn.8/Reshape_output_0, %/down_blocks.2/attn.8/Constant_2_output_0, %/down_blocks.2/attn.8/Mul_output_0, %/down_blocks.2/attn.8/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.8/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/Mul_1"](%/down_blocks.2/attn.8/Div_output_0, %/down_blocks.2/attn.8/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.8/Slice_1"](%/down_blocks.2/attn.8/Reshape_output_0, %/down_blocks.2/attn.8/Mul_output_0, %/down_blocks.2/attn.8/Mul_1_output_0, %/down_blocks.2/attn.8/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.8/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/Mul_2"](%/down_blocks.2/attn.8/Div_output_0, %/down_blocks.2/attn.8/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.8/Slice_2"](%/down_blocks.2/attn.8/Reshape_output_0, %/down_blocks.2/attn.8/Mul_1_output_0, %/down_blocks.2/attn.8/Mul_2_output_0, %/down_blocks.2/attn.8/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.8/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/down_blocks.2/attn.8/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.2/attn.8/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.2/attn.8/Reciprocal"](%/down_blocks.2/attn.8/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.2/attn.8/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/Mul_3"](%/down_blocks.2/attn.8/Slice_output_0, %/down_blocks.2/attn.8/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.8/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.8/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.8/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/Reshape_1"](%/down_blocks.2/attn.8/Mul_3_output_0, %/down_blocks.2/attn.8/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.8/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/Mul_4"](%/down_blocks.2/attn.8/Slice_1_output_0, %/down_blocks.2/attn.8/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.8/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.8/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.8/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.8/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.8/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.8/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.8/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.8/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.8/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/Reshape_2"](%/down_blocks.2/attn.8/Mul_4_output_0, %/down_blocks.2/attn.8/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.8/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.8/Einsum"](%/down_blocks.2/attn.8/Reshape_1_output_0, %/down_blocks.2/attn.8/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.8/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.8/Cast"](%/down_blocks.2/attn.8/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.8/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.8/Softmax"](%/down_blocks.2/attn.8/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.8/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.8/Cast_1"](%/down_blocks.2/attn.8/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.8/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/Reshape_3"](%/down_blocks.2/attn.8/Slice_2_output_0, %/down_blocks.2/attn.8/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.8/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.8/Einsum_1"](%/down_blocks.2/attn.8/Cast_1_output_0, %/down_blocks.2/attn.8/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.8/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.8/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.8/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.8/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.8/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/Reshape_4"](%/down_blocks.2/attn.8/Einsum_1_output_0, %/down_blocks.2/attn.8/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.8/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.8/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.8.norm_cond.weight, %inner_unet.inner_unet.down_blocks.2.attn.8.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.2/attn.8/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.2/attn.8/kv_cond/MatMul"](%/down_blocks.2/attn.8/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9750), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.8/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.8/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.2.attn.8.kv_cond.bias, %/down_blocks.2/attn.8/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.8/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.2/attn.8/Transpose"](%/down_blocks.2/attn.8/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.2/attn.8/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.8/Shape_1"](%/down_blocks.2/attn.8/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.8/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.8/Gather_1"](%/down_blocks.2/attn.8/Shape_1_output_0, %/down_blocks.2/attn.8/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.8/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.8/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.8/Add_1"](%/down_blocks.2/attn.8/Gather_1_output_0, %/down_blocks.2/attn.8/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.8/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.8/Div_1"](%/down_blocks.2/attn.8/Add_1_output_0, %/down_blocks.2/attn.8/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.8/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/Mul_5"](%/down_blocks.2/attn.8/Div_1_output_0, %/down_blocks.2/attn.8/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.8/Slice_3"](%/down_blocks.2/attn.8/Transpose_output_0, %/down_blocks.2/attn.8/Constant_17_output_0, %/down_blocks.2/attn.8/Mul_5_output_0, %/down_blocks.2/attn.8/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.8/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/Mul_6"](%/down_blocks.2/attn.8/Div_1_output_0, %/down_blocks.2/attn.8/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.8/Slice_4"](%/down_blocks.2/attn.8/Transpose_output_0, %/down_blocks.2/attn.8/Mul_5_output_0, %/down_blocks.2/attn.8/Mul_6_output_0, %/down_blocks.2/attn.8/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.8/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/Mul_7"](%/down_blocks.2/attn.8/Slice_3_output_0, %/down_blocks.2/attn.8/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.8/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/Reshape_5"](%/down_blocks.2/attn.8/Mul_7_output_0, %/down_blocks.2/attn.8/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.8/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.8/Einsum_2"](%/down_blocks.2/attn.8/Reshape_1_output_0, %/down_blocks.2/attn.8/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.8/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.8/Cast_2"](%/down_blocks.2/attn.8/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.8/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.8/Softmax_1"](%/down_blocks.2/attn.8/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.8/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.8/Cast_3"](%/down_blocks.2/attn.8/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.8/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/Reshape_6"](%/down_blocks.2/attn.8/Slice_4_output_0, %/down_blocks.2/attn.8/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.8/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.8/Einsum_3"](%/down_blocks.2/attn.8/Cast_3_output_0, %/down_blocks.2/attn.8/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.8/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/Reshape_7"](%/down_blocks.2/attn.8/Einsum_3_output_0, %/down_blocks.2/attn.8/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.8/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.8/Add_2"](%/down_blocks.2/attn.8/Reshape_4_output_0, %/down_blocks.2/attn.8/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.2/attn.8/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/down_blocks.2/attn.8/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.8/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/Reshape_8"](%/down_blocks.2/attn.8/Add_2_output_0, %/down_blocks.2/attn.8/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.8/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.8/proj_out/Conv"](%/down_blocks.2/attn.8/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.2.attn.8.proj_out.weight, %inner_unet.inner_unet.down_blocks.2.attn.8.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.8/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.8/Add_3"](%/down_blocks.2/attn.7/Add_4_output_0, %/down_blocks.2/attn.8/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.2/attn.8/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.8/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/ffn/ffn.0/Reshape"](%/down_blocks.2/attn.8/Add_3_output_0, %/down_blocks.2/attn.8/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.8/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.8/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.8/ffn/ffn.0/InstanceNormalization"](%/down_blocks.2/attn.8/ffn/ffn.0/Reshape_output_0, %/down_blocks.2/attn.8/ffn/ffn.0/Constant_1_output_0, %/down_blocks.2/attn.8/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.8/ffn/ffn.0/Shape"](%/down_blocks.2/attn.8/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.8/ffn/ffn.0/Reshape_1"](%/down_blocks.2/attn.8/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.2/attn.8/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/ffn/ffn.0/Mul"](%/down_blocks.2/attn.8/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9756), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.8/ffn/ffn.0/Add"](%/down_blocks.2/attn.8/ffn/ffn.0/Mul_output_0, %onnx::Add_9757), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.8/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.8/ffn/ffn.1/Conv"](%/down_blocks.2/attn.8/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.8.ffn.1.weight, %inner_unet.inner_unet.down_blocks.2.attn.8.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.8/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.2/attn.8/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.8/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.8/ffn/ffn.2/Div"](%/down_blocks.2/attn.8/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.8/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.8/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.2/attn.8/ffn/ffn.2/Erf"](%/down_blocks.2/attn.8/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.8/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.8/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.8/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.8/ffn/ffn.2/Add"](%/down_blocks.2/attn.8/ffn/ffn.2/Erf_output_0, %/down_blocks.2/attn.8/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.8/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/ffn/ffn.2/Mul"](%/down_blocks.2/attn.8/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.8/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.8/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.2/attn.8/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.8/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.8/ffn/ffn.2/Mul_1"](%/down_blocks.2/attn.8/ffn/ffn.2/Mul_output_0, %/down_blocks.2/attn.8/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.8/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.8/ffn/ffn.3/Conv"](%/down_blocks.2/attn.8/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.attn.8.ffn.3.weight, %inner_unet.inner_unet.down_blocks.2.attn.8.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.8/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.8/Add_4"](%/down_blocks.2/attn.8/ffn/ffn.3/Conv_output_0, %/down_blocks.2/attn.8/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/down_blocks.2/attn.9/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.9/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/norm/Reshape"](%/down_blocks.2/attn.8/Add_4_output_0, %/down_blocks.2/attn.9/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.9/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.9/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.9/norm/InstanceNormalization"](%/down_blocks.2/attn.9/norm/Reshape_output_0, %/down_blocks.2/attn.9/norm/Constant_1_output_0, %/down_blocks.2/attn.9/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.9/norm/Shape"](%/down_blocks.2/attn.8/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/norm/Reshape_1"](%/down_blocks.2/attn.9/norm/InstanceNormalization_output_0, %/down_blocks.2/attn.9/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/norm/Mul"](%/down_blocks.2/attn.9/norm/Reshape_1_output_0, %onnx::Mul_9758), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.9/norm/Add"](%/down_blocks.2/attn.9/norm/Mul_output_0, %onnx::Add_9759), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.9/qkv/Conv"](%/down_blocks.2/attn.9/norm/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.9.qkv.weight, %inner_unet.inner_unet.down_blocks.2.attn.9.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.9/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.9/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/Reshape"](%/down_blocks.2/attn.9/qkv/Conv_output_0, %/down_blocks.2/attn.9/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.9/Shape"](%/down_blocks.2/attn.9/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.9/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.9/Gather"](%/down_blocks.2/attn.9/Shape_output_0, %/down_blocks.2/attn.9/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.9/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.9/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.9/Add"](%/down_blocks.2/attn.9/Gather_output_0, %/down_blocks.2/attn.9/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.9/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.9/Div"](%/down_blocks.2/attn.9/Add_output_0, %/down_blocks.2/attn.9/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.9/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/Mul"](%/down_blocks.2/attn.9/Div_output_0, %/down_blocks.2/attn.9/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.9/Slice"](%/down_blocks.2/attn.9/Reshape_output_0, %/down_blocks.2/attn.9/Constant_2_output_0, %/down_blocks.2/attn.9/Mul_output_0, %/down_blocks.2/attn.9/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.9/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/Mul_1"](%/down_blocks.2/attn.9/Div_output_0, %/down_blocks.2/attn.9/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.9/Slice_1"](%/down_blocks.2/attn.9/Reshape_output_0, %/down_blocks.2/attn.9/Mul_output_0, %/down_blocks.2/attn.9/Mul_1_output_0, %/down_blocks.2/attn.9/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/down_blocks.2/attn.9/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/Mul_2"](%/down_blocks.2/attn.9/Div_output_0, %/down_blocks.2/attn.9/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.9/Slice_2"](%/down_blocks.2/attn.9/Reshape_output_0, %/down_blocks.2/attn.9/Mul_1_output_0, %/down_blocks.2/attn.9/Mul_2_output_0, %/down_blocks.2/attn.9/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/down_blocks.2/attn.9/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/down_blocks.2/attn.9/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/down_blocks.2/attn.9/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/down_blocks.2/attn.9/Reciprocal"](%/down_blocks.2/attn.9/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/down_blocks.2/attn.9/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/Mul_3"](%/down_blocks.2/attn.9/Slice_output_0, %/down_blocks.2/attn.9/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.9/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.9/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.9/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/Reshape_1"](%/down_blocks.2/attn.9/Mul_3_output_0, %/down_blocks.2/attn.9/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/down_blocks.2/attn.9/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/Mul_4"](%/down_blocks.2/attn.9/Slice_1_output_0, %/down_blocks.2/attn.9/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.9/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.9/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.9/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.9/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.9/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.9/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.9/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.9/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.9/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/Reshape_2"](%/down_blocks.2/attn.9/Mul_4_output_0, %/down_blocks.2/attn.9/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.9/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.9/Einsum"](%/down_blocks.2/attn.9/Reshape_1_output_0, %/down_blocks.2/attn.9/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.9/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.9/Cast"](%/down_blocks.2/attn.9/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.9/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.9/Softmax"](%/down_blocks.2/attn.9/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.9/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.9/Cast_1"](%/down_blocks.2/attn.9/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.9/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/Reshape_3"](%/down_blocks.2/attn.9/Slice_2_output_0, %/down_blocks.2/attn.9/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.9/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.9/Einsum_1"](%/down_blocks.2/attn.9/Cast_1_output_0, %/down_blocks.2/attn.9/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.9/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.9/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.9/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.9/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.9/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/Reshape_4"](%/down_blocks.2/attn.9/Einsum_1_output_0, %/down_blocks.2/attn.9/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.9/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.9/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.9.norm_cond.weight, %inner_unet.inner_unet.down_blocks.2.attn.9.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/down_blocks.2/attn.9/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/down_blocks.2/attn.9/kv_cond/MatMul"](%/down_blocks.2/attn.9/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9792), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.9/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.9/kv_cond/Add"](%inner_unet.inner_unet.down_blocks.2.attn.9.kv_cond.bias, %/down_blocks.2/attn.9/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/down_blocks.2/attn.9/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/down_blocks.2/attn.9/Transpose"](%/down_blocks.2/attn.9/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/down_blocks.2/attn.9/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.9/Shape_1"](%/down_blocks.2/attn.9/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.9/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/down_blocks.2/attn.9/Gather_1"](%/down_blocks.2/attn.9/Shape_1_output_0, %/down_blocks.2/attn.9/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/down_blocks.2/attn.9/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.9/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.9/Add_1"](%/down_blocks.2/attn.9/Gather_1_output_0, %/down_blocks.2/attn.9/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.9/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.9/Div_1"](%/down_blocks.2/attn.9/Add_1_output_0, %/down_blocks.2/attn.9/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.9/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/Mul_5"](%/down_blocks.2/attn.9/Div_1_output_0, %/down_blocks.2/attn.9/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.9/Slice_3"](%/down_blocks.2/attn.9/Transpose_output_0, %/down_blocks.2/attn.9/Constant_17_output_0, %/down_blocks.2/attn.9/Mul_5_output_0, %/down_blocks.2/attn.9/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/down_blocks.2/attn.9/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/Mul_6"](%/down_blocks.2/attn.9/Div_1_output_0, %/down_blocks.2/attn.9/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/down_blocks.2/attn.9/Slice_4"](%/down_blocks.2/attn.9/Transpose_output_0, %/down_blocks.2/attn.9/Mul_5_output_0, %/down_blocks.2/attn.9/Mul_6_output_0, %/down_blocks.2/attn.9/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/down_blocks.2/attn.9/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/Mul_7"](%/down_blocks.2/attn.9/Slice_3_output_0, %/down_blocks.2/attn.9/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.9/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/Reshape_5"](%/down_blocks.2/attn.9/Mul_7_output_0, %/down_blocks.2/attn.9/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/down_blocks.2/attn.9/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/down_blocks.2/attn.9/Einsum_2"](%/down_blocks.2/attn.9/Reshape_1_output_0, %/down_blocks.2/attn.9/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.9/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.9/Cast_2"](%/down_blocks.2/attn.9/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.9/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/down_blocks.2/attn.9/Softmax_1"](%/down_blocks.2/attn.9/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.9/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/down_blocks.2/attn.9/Cast_3"](%/down_blocks.2/attn.9/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/down_blocks.2/attn.9/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/Reshape_6"](%/down_blocks.2/attn.9/Slice_4_output_0, %/down_blocks.2/attn.9/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/down_blocks.2/attn.9/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/down_blocks.2/attn.9/Einsum_3"](%/down_blocks.2/attn.9/Cast_3_output_0, %/down_blocks.2/attn.9/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/down_blocks.2/attn.9/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/Reshape_7"](%/down_blocks.2/attn.9/Einsum_3_output_0, %/down_blocks.2/attn.9/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/down_blocks.2/attn.9/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.9/Add_2"](%/down_blocks.2/attn.9/Reshape_4_output_0, %/down_blocks.2/attn.9/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/down_blocks.2/attn.9/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/down_blocks.2/attn.9/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.9/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/Reshape_8"](%/down_blocks.2/attn.9/Add_2_output_0, %/down_blocks.2/attn.9/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/down_blocks.2/attn.9/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.9/proj_out/Conv"](%/down_blocks.2/attn.9/Reshape_8_output_0, %inner_unet.inner_unet.down_blocks.2.attn.9.proj_out.weight, %inner_unet.inner_unet.down_blocks.2.attn.9.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.9/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.9/Add_3"](%/down_blocks.2/attn.8/Add_4_output_0, %/down_blocks.2/attn.9/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/down_blocks.2/attn.9/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/down_blocks.2/attn.9/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/ffn/ffn.0/Reshape"](%/down_blocks.2/attn.9/Add_3_output_0, %/down_blocks.2/attn.9/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.9/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/down_blocks.2/attn.9/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/down_blocks.2/attn.9/ffn/ffn.0/InstanceNormalization"](%/down_blocks.2/attn.9/ffn/ffn.0/Reshape_output_0, %/down_blocks.2/attn.9/ffn/ffn.0/Constant_1_output_0, %/down_blocks.2/attn.9/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/down_blocks.2/attn.9/ffn/ffn.0/Shape"](%/down_blocks.2/attn.9/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/down_blocks.2/attn.9/ffn/ffn.0/Reshape_1"](%/down_blocks.2/attn.9/ffn/ffn.0/InstanceNormalization_output_0, %/down_blocks.2/attn.9/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/ffn/ffn.0/Mul"](%/down_blocks.2/attn.9/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9798), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.9/ffn/ffn.0/Add"](%/down_blocks.2/attn.9/ffn/ffn.0/Mul_output_0, %onnx::Add_9799), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/down_blocks.2/attn.9/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.9/ffn/ffn.1/Conv"](%/down_blocks.2/attn.9/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.down_blocks.2.attn.9.ffn.1.weight, %inner_unet.inner_unet.down_blocks.2.attn.9.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.9/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/down_blocks.2/attn.9/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.9/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/down_blocks.2/attn.9/ffn/ffn.2/Div"](%/down_blocks.2/attn.9/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.9/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.9/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/down_blocks.2/attn.9/ffn/ffn.2/Erf"](%/down_blocks.2/attn.9/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.9/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/down_blocks.2/attn.9/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.9/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/down_blocks.2/attn.9/ffn/ffn.2/Add"](%/down_blocks.2/attn.9/ffn/ffn.2/Erf_output_0, %/down_blocks.2/attn.9/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.9/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/ffn/ffn.2/Mul"](%/down_blocks.2/attn.9/ffn/ffn.1/Conv_output_0, %/down_blocks.2/attn.9/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.9/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/down_blocks.2/attn.9/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.9/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/down_blocks.2/attn.9/ffn/ffn.2/Mul_1"](%/down_blocks.2/attn.9/ffn/ffn.2/Mul_output_0, %/down_blocks.2/attn.9/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/down_blocks.2/attn.9/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/down_blocks.2/attn.9/ffn/ffn.3/Conv"](%/down_blocks.2/attn.9/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.down_blocks.2.attn.9.ffn.3.weight, %inner_unet.inner_unet.down_blocks.2.attn.9.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/down_blocks.2/attn.9/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/down_blocks.2/attn.9/Add_4"](%/down_blocks.2/attn.9/ffn/ffn.3/Conv_output_0, %/down_blocks.2/attn.9/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::down_blocks.2/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/mid_blocks.0/resnets.0/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/mid_blocks.0/resnets.0/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm1/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/resnets.0/norm1/Reshape"](%/down_blocks.2/attn.9/Add_4_output_0, %/mid_blocks.0/resnets.0/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.0/resnets.0/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.0/resnets.0/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm1/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/mid_blocks.0/resnets.0/norm1/InstanceNormalization"](%/mid_blocks.0/resnets.0/norm1/Reshape_output_0, %/mid_blocks.0/resnets.0/norm1/Constant_1_output_0, %/mid_blocks.0/resnets.0/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/mid_blocks.0/resnets.0/norm1/Shape"](%/down_blocks.2/attn.9/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm1/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/resnets.0/norm1/Reshape_1"](%/mid_blocks.0/resnets.0/norm1/InstanceNormalization_output_0, %/mid_blocks.0/resnets.0/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm1/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/resnets.0/norm1/Mul"](%/mid_blocks.0/resnets.0/norm1/Reshape_1_output_0, %onnx::Mul_9800), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm1/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/resnets.0/norm1/Add"](%/mid_blocks.0/resnets.0/norm1/Mul_output_0, %onnx::Add_9801), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/Sigmoid_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/mid_blocks.0/resnets.0/Sigmoid"](%/mid_blocks.0/resnets.0/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/mid_blocks.0/resnets.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/mid_blocks.0/resnets.0/Mul"](%/mid_blocks.0/resnets.0/norm1/Add_output_0, %/mid_blocks.0/resnets.0/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/mid_blocks.0/resnets.0/conv1/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/mid_blocks.0/resnets.0/conv1/Conv"](%/mid_blocks.0/resnets.0/Mul_output_0, %inner_unet.inner_unet.mid_blocks.0.resnets.0.conv1.weight, %inner_unet.inner_unet.mid_blocks.0.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/mid_blocks.0/resnets.0/time_layer/Gemm_output_0 : Float(1, 1536, strides=[1536, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/mid_blocks.0/resnets.0/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.mid_blocks.0.resnets.0.time_layer.weight, %inner_unet.inner_unet.mid_blocks.0.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/mid_blocks.0/resnets.0/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/mid_blocks.0/resnets.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Unsqueeze_output_0 : Float(1, 1536, 1, strides=[1536, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/mid_blocks.0/resnets.0/Unsqueeze"](%/mid_blocks.0/resnets.0/time_layer/Gemm_output_0, %/mid_blocks.0/resnets.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/mid_blocks.0/resnets.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Unsqueeze_1_output_0 : Float(1, 1536, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/mid_blocks.0/resnets.0/Unsqueeze_1"](%/mid_blocks.0/resnets.0/Unsqueeze_output_0, %/mid_blocks.0/resnets.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/mid_blocks.0/resnets.0/Shape"](%/mid_blocks.0/resnets.0/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.0/resnets.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/mid_blocks.0/resnets.0/Gather"](%/mid_blocks.0/resnets.0/Shape_output_0, %/mid_blocks.0/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/mid_blocks.0/resnets.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.0/resnets.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/mid_blocks.0/resnets.0/Add"](%/mid_blocks.0/resnets.0/Gather_output_0, %/mid_blocks.0/resnets.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/mid_blocks.0/resnets.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/mid_blocks.0/resnets.0/Div"](%/mid_blocks.0/resnets.0/Add_output_0, %/mid_blocks.0/resnets.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.0/resnets.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/resnets.0/Mul_1"](%/mid_blocks.0/resnets.0/Div_output_0, %/mid_blocks.0/resnets.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Slice_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/mid_blocks.0/resnets.0/Slice"](%/mid_blocks.0/resnets.0/Unsqueeze_1_output_0, %/mid_blocks.0/resnets.0/Constant_3_output_0, %/mid_blocks.0/resnets.0/Mul_1_output_0, %/mid_blocks.0/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/mid_blocks.0/resnets.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/resnets.0/Mul_2"](%/mid_blocks.0/resnets.0/Div_output_0, %/mid_blocks.0/resnets.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/Slice_1_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/mid_blocks.0/resnets.0/Slice_1"](%/mid_blocks.0/resnets.0/Unsqueeze_1_output_0, %/mid_blocks.0/resnets.0/Mul_1_output_0, %/mid_blocks.0/resnets.0/Mul_2_output_0, %/mid_blocks.0/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.0/resnets.0/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/mid_blocks.0/resnets.0/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm2/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/resnets.0/norm2/Reshape"](%/mid_blocks.0/resnets.0/conv1/Conv_output_0, %/mid_blocks.0/resnets.0/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.0/resnets.0/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.0/resnets.0/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm2/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/mid_blocks.0/resnets.0/norm2/InstanceNormalization"](%/mid_blocks.0/resnets.0/norm2/Reshape_output_0, %/mid_blocks.0/resnets.0/norm2/Constant_1_output_0, %/mid_blocks.0/resnets.0/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/mid_blocks.0/resnets.0/norm2/Shape"](%/mid_blocks.0/resnets.0/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm2/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/resnets.0/norm2/Reshape_1"](%/mid_blocks.0/resnets.0/norm2/InstanceNormalization_output_0, %/mid_blocks.0/resnets.0/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm2/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/resnets.0/norm2/Mul"](%/mid_blocks.0/resnets.0/norm2/Reshape_1_output_0, %onnx::Mul_9802), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/norm2/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/resnets.0/norm2/Add"](%/mid_blocks.0/resnets.0/norm2/Mul_output_0, %onnx::Add_9803), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/resnets.0/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.0/resnets.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/mid_blocks.0/resnets.0/Add_1_output_0 : Float(1, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/resnets.0/Add_1"](%/mid_blocks.0/resnets.0/Slice_output_0, %/mid_blocks.0/resnets.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/mid_blocks.0/resnets.0/Mul_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/mid_blocks.0/resnets.0/Mul_3"](%/mid_blocks.0/resnets.0/norm2/Add_output_0, %/mid_blocks.0/resnets.0/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/mid_blocks.0/resnets.0/Add_2_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/resnets.0/Add_2"](%/mid_blocks.0/resnets.0/Mul_3_output_0, %/mid_blocks.0/resnets.0/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/mid_blocks.0/resnets.0/Sigmoid_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/mid_blocks.0/resnets.0/Sigmoid_1"](%/mid_blocks.0/resnets.0/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/mid_blocks.0/resnets.0/Mul_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/mid_blocks.0/resnets.0/Mul_4"](%/mid_blocks.0/resnets.0/Add_2_output_0, %/mid_blocks.0/resnets.0/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/mid_blocks.0/resnets.0/conv2/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/mid_blocks.0/resnets.0/conv2/Conv"](%/mid_blocks.0/resnets.0/Mul_4_output_0, %inner_unet.inner_unet.mid_blocks.0.resnets.0.conv2.weight, %inner_unet.inner_unet.mid_blocks.0.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/mid_blocks.0/resnets.0/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/resnets.0/Add_3"](%/mid_blocks.0/resnets.0/conv2/Conv_output_0, %/down_blocks.2/attn.9/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/mid_blocks.0/attn.0/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/mid_blocks.0/attn.0/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/norm/Reshape"](%/mid_blocks.0/resnets.0/Add_3_output_0, %/mid_blocks.0/attn.0/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.0/attn.0/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.0/attn.0/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/mid_blocks.0/attn.0/norm/InstanceNormalization"](%/mid_blocks.0/attn.0/norm/Reshape_output_0, %/mid_blocks.0/attn.0/norm/Constant_1_output_0, %/mid_blocks.0/attn.0/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/mid_blocks.0/attn.0/norm/Shape"](%/mid_blocks.0/resnets.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/norm/Reshape_1"](%/mid_blocks.0/attn.0/norm/InstanceNormalization_output_0, %/mid_blocks.0/attn.0/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/norm/Mul"](%/mid_blocks.0/attn.0/norm/Reshape_1_output_0, %onnx::Mul_9804), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/attn.0/norm/Add"](%/mid_blocks.0/attn.0/norm/Mul_output_0, %onnx::Add_9805), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/mid_blocks.0/attn.0/qkv/Conv"](%/mid_blocks.0/attn.0/norm/Add_output_0, %inner_unet.inner_unet.mid_blocks.0.attn.0.qkv.weight, %inner_unet.inner_unet.mid_blocks.0.attn.0.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/mid_blocks.0/attn.0/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/mid_blocks.0/attn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/Reshape"](%/mid_blocks.0/attn.0/qkv/Conv_output_0, %/mid_blocks.0/attn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/mid_blocks.0/attn.0/Shape"](%/mid_blocks.0/attn.0/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.0/attn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/mid_blocks.0/attn.0/Gather"](%/mid_blocks.0/attn.0/Shape_output_0, %/mid_blocks.0/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/mid_blocks.0/attn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/mid_blocks.0/attn.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/mid_blocks.0/attn.0/Add"](%/mid_blocks.0/attn.0/Gather_output_0, %/mid_blocks.0/attn.0/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/mid_blocks.0/attn.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/mid_blocks.0/attn.0/Div"](%/mid_blocks.0/attn.0/Add_output_0, %/mid_blocks.0/attn.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.0/attn.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/Mul"](%/mid_blocks.0/attn.0/Div_output_0, %/mid_blocks.0/attn.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/mid_blocks.0/attn.0/Slice"](%/mid_blocks.0/attn.0/Reshape_output_0, %/mid_blocks.0/attn.0/Constant_2_output_0, %/mid_blocks.0/attn.0/Mul_output_0, %/mid_blocks.0/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/mid_blocks.0/attn.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/Mul_1"](%/mid_blocks.0/attn.0/Div_output_0, %/mid_blocks.0/attn.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/mid_blocks.0/attn.0/Slice_1"](%/mid_blocks.0/attn.0/Reshape_output_0, %/mid_blocks.0/attn.0/Mul_output_0, %/mid_blocks.0/attn.0/Mul_1_output_0, %/mid_blocks.0/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/mid_blocks.0/attn.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/Mul_2"](%/mid_blocks.0/attn.0/Div_output_0, %/mid_blocks.0/attn.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/mid_blocks.0/attn.0/Slice_2"](%/mid_blocks.0/attn.0/Reshape_output_0, %/mid_blocks.0/attn.0/Mul_1_output_0, %/mid_blocks.0/attn.0/Mul_2_output_0, %/mid_blocks.0/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/mid_blocks.0/attn.0/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/mid_blocks.0/attn.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/mid_blocks.0/attn.0/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/mid_blocks.0/attn.0/Reciprocal"](%/mid_blocks.0/attn.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/mid_blocks.0/attn.0/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/Mul_3"](%/mid_blocks.0/attn.0/Slice_output_0, %/mid_blocks.0/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/mid_blocks.0/attn.0/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/mid_blocks.0/attn.0/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/mid_blocks.0/attn.0/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/Reshape_1"](%/mid_blocks.0/attn.0/Mul_3_output_0, %/mid_blocks.0/attn.0/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/mid_blocks.0/attn.0/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/Mul_4"](%/mid_blocks.0/attn.0/Slice_1_output_0, %/mid_blocks.0/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/mid_blocks.0/attn.0/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/mid_blocks.0/attn.0/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/mid_blocks.0/attn.0/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/mid_blocks.0/attn.0/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/mid_blocks.0/attn.0/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/mid_blocks.0/attn.0/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/mid_blocks.0/attn.0/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/mid_blocks.0/attn.0/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/mid_blocks.0/attn.0/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/Reshape_2"](%/mid_blocks.0/attn.0/Mul_4_output_0, %/mid_blocks.0/attn.0/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/mid_blocks.0/attn.0/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/mid_blocks.0/attn.0/Einsum"](%/mid_blocks.0/attn.0/Reshape_1_output_0, %/mid_blocks.0/attn.0/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/mid_blocks.0/attn.0/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/mid_blocks.0/attn.0/Cast"](%/mid_blocks.0/attn.0/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/mid_blocks.0/attn.0/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/mid_blocks.0/attn.0/Softmax"](%/mid_blocks.0/attn.0/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/mid_blocks.0/attn.0/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/mid_blocks.0/attn.0/Cast_1"](%/mid_blocks.0/attn.0/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/mid_blocks.0/attn.0/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/Reshape_3"](%/mid_blocks.0/attn.0/Slice_2_output_0, %/mid_blocks.0/attn.0/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/mid_blocks.0/attn.0/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/mid_blocks.0/attn.0/Einsum_1"](%/mid_blocks.0/attn.0/Cast_1_output_0, %/mid_blocks.0/attn.0/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/mid_blocks.0/attn.0/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/mid_blocks.0/attn.0/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/mid_blocks.0/attn.0/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/mid_blocks.0/attn.0/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/mid_blocks.0/attn.0/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/Reshape_4"](%/mid_blocks.0/attn.0/Einsum_1_output_0, %/mid_blocks.0/attn.0/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/mid_blocks.0/attn.0/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/mid_blocks.0/attn.0/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.mid_blocks.0.attn.0.norm_cond.weight, %inner_unet.inner_unet.mid_blocks.0.attn.0.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/mid_blocks.0/attn.0/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/mid_blocks.0/attn.0/kv_cond/MatMul"](%/mid_blocks.0/attn.0/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9838), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/mid_blocks.0/attn.0/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/attn.0/kv_cond/Add"](%inner_unet.inner_unet.mid_blocks.0.attn.0.kv_cond.bias, %/mid_blocks.0/attn.0/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/mid_blocks.0/attn.0/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/mid_blocks.0/attn.0/Transpose"](%/mid_blocks.0/attn.0/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/mid_blocks.0/attn.0/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/mid_blocks.0/attn.0/Shape_1"](%/mid_blocks.0/attn.0/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.0/attn.0/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/mid_blocks.0/attn.0/Gather_1"](%/mid_blocks.0/attn.0/Shape_1_output_0, %/mid_blocks.0/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/mid_blocks.0/attn.0/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.0/attn.0/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/mid_blocks.0/attn.0/Add_1"](%/mid_blocks.0/attn.0/Gather_1_output_0, %/mid_blocks.0/attn.0/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/mid_blocks.0/attn.0/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/mid_blocks.0/attn.0/Div_1"](%/mid_blocks.0/attn.0/Add_1_output_0, %/mid_blocks.0/attn.0/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.0/attn.0/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/Mul_5"](%/mid_blocks.0/attn.0/Div_1_output_0, %/mid_blocks.0/attn.0/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/mid_blocks.0/attn.0/Slice_3"](%/mid_blocks.0/attn.0/Transpose_output_0, %/mid_blocks.0/attn.0/Constant_17_output_0, %/mid_blocks.0/attn.0/Mul_5_output_0, %/mid_blocks.0/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/mid_blocks.0/attn.0/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/Mul_6"](%/mid_blocks.0/attn.0/Div_1_output_0, %/mid_blocks.0/attn.0/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/mid_blocks.0/attn.0/Slice_4"](%/mid_blocks.0/attn.0/Transpose_output_0, %/mid_blocks.0/attn.0/Mul_5_output_0, %/mid_blocks.0/attn.0/Mul_6_output_0, %/mid_blocks.0/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/mid_blocks.0/attn.0/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/Mul_7"](%/mid_blocks.0/attn.0/Slice_3_output_0, %/mid_blocks.0/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/mid_blocks.0/attn.0/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/Reshape_5"](%/mid_blocks.0/attn.0/Mul_7_output_0, %/mid_blocks.0/attn.0/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/mid_blocks.0/attn.0/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/mid_blocks.0/attn.0/Einsum_2"](%/mid_blocks.0/attn.0/Reshape_1_output_0, %/mid_blocks.0/attn.0/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/mid_blocks.0/attn.0/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/mid_blocks.0/attn.0/Cast_2"](%/mid_blocks.0/attn.0/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/mid_blocks.0/attn.0/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/mid_blocks.0/attn.0/Softmax_1"](%/mid_blocks.0/attn.0/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/mid_blocks.0/attn.0/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/mid_blocks.0/attn.0/Cast_3"](%/mid_blocks.0/attn.0/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/mid_blocks.0/attn.0/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/Reshape_6"](%/mid_blocks.0/attn.0/Slice_4_output_0, %/mid_blocks.0/attn.0/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/mid_blocks.0/attn.0/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/mid_blocks.0/attn.0/Einsum_3"](%/mid_blocks.0/attn.0/Cast_3_output_0, %/mid_blocks.0/attn.0/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/mid_blocks.0/attn.0/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/Reshape_7"](%/mid_blocks.0/attn.0/Einsum_3_output_0, %/mid_blocks.0/attn.0/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/mid_blocks.0/attn.0/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/attn.0/Add_2"](%/mid_blocks.0/attn.0/Reshape_4_output_0, %/mid_blocks.0/attn.0/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/mid_blocks.0/attn.0/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/mid_blocks.0/attn.0/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/mid_blocks.0/attn.0/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/Reshape_8"](%/mid_blocks.0/attn.0/Add_2_output_0, %/mid_blocks.0/attn.0/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/mid_blocks.0/attn.0/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/mid_blocks.0/attn.0/proj_out/Conv"](%/mid_blocks.0/attn.0/Reshape_8_output_0, %inner_unet.inner_unet.mid_blocks.0.attn.0.proj_out.weight, %inner_unet.inner_unet.mid_blocks.0.attn.0.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/mid_blocks.0/attn.0/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/attn.0/Add_3"](%/mid_blocks.0/resnets.0/Add_3_output_0, %/mid_blocks.0/attn.0/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/mid_blocks.0/attn.0/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/mid_blocks.0/attn.0/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/ffn/ffn.0/Reshape"](%/mid_blocks.0/attn.0/Add_3_output_0, %/mid_blocks.0/attn.0/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.0/attn.0/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.0/attn.0/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/mid_blocks.0/attn.0/ffn/ffn.0/InstanceNormalization"](%/mid_blocks.0/attn.0/ffn/ffn.0/Reshape_output_0, %/mid_blocks.0/attn.0/ffn/ffn.0/Constant_1_output_0, %/mid_blocks.0/attn.0/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/mid_blocks.0/attn.0/ffn/ffn.0/Shape"](%/mid_blocks.0/attn.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.0/attn.0/ffn/ffn.0/Reshape_1"](%/mid_blocks.0/attn.0/ffn/ffn.0/InstanceNormalization_output_0, %/mid_blocks.0/attn.0/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/ffn/ffn.0/Mul"](%/mid_blocks.0/attn.0/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9844), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/attn.0/ffn/ffn.0/Add"](%/mid_blocks.0/attn.0/ffn/ffn.0/Mul_output_0, %onnx::Add_9845), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.0/attn.0/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/mid_blocks.0/attn.0/ffn/ffn.1/Conv"](%/mid_blocks.0/attn.0/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.mid_blocks.0.attn.0.ffn.1.weight, %inner_unet.inner_unet.mid_blocks.0.attn.0.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/mid_blocks.0/attn.0/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/mid_blocks.0/attn.0/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/mid_blocks.0/attn.0/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/mid_blocks.0/attn.0/ffn/ffn.2/Div"](%/mid_blocks.0/attn.0/ffn/ffn.1/Conv_output_0, %/mid_blocks.0/attn.0/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/mid_blocks.0/attn.0/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/mid_blocks.0/attn.0/ffn/ffn.2/Erf"](%/mid_blocks.0/attn.0/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/mid_blocks.0/attn.0/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.0/attn.0/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/mid_blocks.0/attn.0/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/mid_blocks.0/attn.0/ffn/ffn.2/Add"](%/mid_blocks.0/attn.0/ffn/ffn.2/Erf_output_0, %/mid_blocks.0/attn.0/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/mid_blocks.0/attn.0/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/ffn/ffn.2/Mul"](%/mid_blocks.0/attn.0/ffn/ffn.1/Conv_output_0, %/mid_blocks.0/attn.0/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/mid_blocks.0/attn.0/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/mid_blocks.0/attn.0/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/mid_blocks.0/attn.0/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/mid_blocks.0/attn.0/ffn/ffn.2/Mul_1"](%/mid_blocks.0/attn.0/ffn/ffn.2/Mul_output_0, %/mid_blocks.0/attn.0/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/mid_blocks.0/attn.0/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/mid_blocks.0/attn.0/ffn/ffn.3/Conv"](%/mid_blocks.0/attn.0/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.mid_blocks.0.attn.0.ffn.3.weight, %inner_unet.inner_unet.mid_blocks.0.attn.0.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/mid_blocks.0/attn.0/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.0/attn.0/Add_4"](%/mid_blocks.0/attn.0/ffn/ffn.3/Conv_output_0, %/mid_blocks.0/attn.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/mid_blocks.1/resnets.0/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/mid_blocks.1/resnets.0/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm1/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.1/resnets.0/norm1/Reshape"](%/mid_blocks.0/attn.0/Add_4_output_0, %/mid_blocks.1/resnets.0/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.1/resnets.0/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.1/resnets.0/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm1/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/mid_blocks.1/resnets.0/norm1/InstanceNormalization"](%/mid_blocks.1/resnets.0/norm1/Reshape_output_0, %/mid_blocks.1/resnets.0/norm1/Constant_1_output_0, %/mid_blocks.1/resnets.0/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/mid_blocks.1/resnets.0/norm1/Shape"](%/mid_blocks.0/attn.0/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm1/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.1/resnets.0/norm1/Reshape_1"](%/mid_blocks.1/resnets.0/norm1/InstanceNormalization_output_0, %/mid_blocks.1/resnets.0/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm1/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.1/resnets.0/norm1/Mul"](%/mid_blocks.1/resnets.0/norm1/Reshape_1_output_0, %onnx::Mul_9846), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm1/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.1/resnets.0/norm1/Add"](%/mid_blocks.1/resnets.0/norm1/Mul_output_0, %onnx::Add_9847), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/Sigmoid_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/mid_blocks.1/resnets.0/Sigmoid"](%/mid_blocks.1/resnets.0/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/mid_blocks.1/resnets.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/mid_blocks.1/resnets.0/Mul"](%/mid_blocks.1/resnets.0/norm1/Add_output_0, %/mid_blocks.1/resnets.0/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/mid_blocks.1/resnets.0/conv1/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/mid_blocks.1/resnets.0/conv1/Conv"](%/mid_blocks.1/resnets.0/Mul_output_0, %inner_unet.inner_unet.mid_blocks.1.resnets.0.conv1.weight, %inner_unet.inner_unet.mid_blocks.1.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/mid_blocks.1/resnets.0/time_layer/Gemm_output_0 : Float(1, 1536, strides=[1536, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/mid_blocks.1/resnets.0/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.mid_blocks.1.resnets.0.time_layer.weight, %inner_unet.inner_unet.mid_blocks.1.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/mid_blocks.1/resnets.0/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/mid_blocks.1/resnets.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Unsqueeze_output_0 : Float(1, 1536, 1, strides=[1536, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/mid_blocks.1/resnets.0/Unsqueeze"](%/mid_blocks.1/resnets.0/time_layer/Gemm_output_0, %/mid_blocks.1/resnets.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/mid_blocks.1/resnets.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Unsqueeze_1_output_0 : Float(1, 1536, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/mid_blocks.1/resnets.0/Unsqueeze_1"](%/mid_blocks.1/resnets.0/Unsqueeze_output_0, %/mid_blocks.1/resnets.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/mid_blocks.1/resnets.0/Shape"](%/mid_blocks.1/resnets.0/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.1/resnets.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/mid_blocks.1/resnets.0/Gather"](%/mid_blocks.1/resnets.0/Shape_output_0, %/mid_blocks.1/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/mid_blocks.1/resnets.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.1/resnets.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/mid_blocks.1/resnets.0/Add"](%/mid_blocks.1/resnets.0/Gather_output_0, %/mid_blocks.1/resnets.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/mid_blocks.1/resnets.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/mid_blocks.1/resnets.0/Div"](%/mid_blocks.1/resnets.0/Add_output_0, %/mid_blocks.1/resnets.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.1/resnets.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.1/resnets.0/Mul_1"](%/mid_blocks.1/resnets.0/Div_output_0, %/mid_blocks.1/resnets.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Slice_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/mid_blocks.1/resnets.0/Slice"](%/mid_blocks.1/resnets.0/Unsqueeze_1_output_0, %/mid_blocks.1/resnets.0/Constant_3_output_0, %/mid_blocks.1/resnets.0/Mul_1_output_0, %/mid_blocks.1/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/mid_blocks.1/resnets.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.1/resnets.0/Mul_2"](%/mid_blocks.1/resnets.0/Div_output_0, %/mid_blocks.1/resnets.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/Slice_1_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/mid_blocks.1/resnets.0/Slice_1"](%/mid_blocks.1/resnets.0/Unsqueeze_1_output_0, %/mid_blocks.1/resnets.0/Mul_1_output_0, %/mid_blocks.1/resnets.0/Mul_2_output_0, %/mid_blocks.1/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/mid_blocks.1/resnets.0/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/mid_blocks.1/resnets.0/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm2/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.1/resnets.0/norm2/Reshape"](%/mid_blocks.1/resnets.0/conv1/Conv_output_0, %/mid_blocks.1/resnets.0/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.1/resnets.0/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/mid_blocks.1/resnets.0/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm2/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/mid_blocks.1/resnets.0/norm2/InstanceNormalization"](%/mid_blocks.1/resnets.0/norm2/Reshape_output_0, %/mid_blocks.1/resnets.0/norm2/Constant_1_output_0, %/mid_blocks.1/resnets.0/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/mid_blocks.1/resnets.0/norm2/Shape"](%/mid_blocks.1/resnets.0/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm2/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/mid_blocks.1/resnets.0/norm2/Reshape_1"](%/mid_blocks.1/resnets.0/norm2/InstanceNormalization_output_0, %/mid_blocks.1/resnets.0/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm2/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/mid_blocks.1/resnets.0/norm2/Mul"](%/mid_blocks.1/resnets.0/norm2/Reshape_1_output_0, %onnx::Mul_9848), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/norm2/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.1/resnets.0/norm2/Add"](%/mid_blocks.1/resnets.0/norm2/Mul_output_0, %onnx::Add_9849), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/mid_blocks.1/resnets.0/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/mid_blocks.1/resnets.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/mid_blocks.1/resnets.0/Add_1_output_0 : Float(1, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.1/resnets.0/Add_1"](%/mid_blocks.1/resnets.0/Slice_output_0, %/mid_blocks.1/resnets.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/mid_blocks.1/resnets.0/Mul_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/mid_blocks.1/resnets.0/Mul_3"](%/mid_blocks.1/resnets.0/norm2/Add_output_0, %/mid_blocks.1/resnets.0/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/mid_blocks.1/resnets.0/Add_2_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.1/resnets.0/Add_2"](%/mid_blocks.1/resnets.0/Mul_3_output_0, %/mid_blocks.1/resnets.0/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/mid_blocks.1/resnets.0/Sigmoid_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/mid_blocks.1/resnets.0/Sigmoid_1"](%/mid_blocks.1/resnets.0/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/mid_blocks.1/resnets.0/Mul_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/mid_blocks.1/resnets.0/Mul_4"](%/mid_blocks.1/resnets.0/Add_2_output_0, %/mid_blocks.1/resnets.0/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/mid_blocks.1/resnets.0/conv2/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/mid_blocks.1/resnets.0/conv2/Conv"](%/mid_blocks.1/resnets.0/Mul_4_output_0, %inner_unet.inner_unet.mid_blocks.1.resnets.0.conv2.weight, %inner_unet.inner_unet.mid_blocks.1.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/mid_blocks.1/resnets.0/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/mid_blocks.1/resnets.0/Add_3"](%/mid_blocks.1/resnets.0/conv2/Conv_output_0, %/mid_blocks.0/attn.0/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::mid_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.0/Concat_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.0/Concat"](%/mid_blocks.1/resnets.0/Add_3_output_0, %/down_blocks.2/attn.9/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.0/resnets.0/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.0/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1/Reshape_output_0 : Float(1, 32, 96, strides=[3072, 96, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm1/Reshape"](%/up_blocks.0/Concat_output_0, %/up_blocks.0/resnets.0/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1/InstanceNormalization_output_0 : Float(1, 32, 96, strides=[3072, 96, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.0/norm1/InstanceNormalization"](%/up_blocks.0/resnets.0/norm1/Reshape_output_0, %/up_blocks.0/resnets.0/norm1/Constant_1_output_0, %/up_blocks.0/resnets.0/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.0/norm1/Shape"](%/up_blocks.0/Concat_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1/Reshape_1_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm1/Reshape_1"](%/up_blocks.0/resnets.0/norm1/InstanceNormalization_output_0, %/up_blocks.0/resnets.0/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1/Mul_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/norm1/Mul"](%/up_blocks.0/resnets.0/norm1/Reshape_1_output_0, %onnx::Mul_9850), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1/Add_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0/norm1/Add"](%/up_blocks.0/resnets.0/norm1/Mul_output_0, %onnx::Add_9851), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/Sigmoid_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.0/Sigmoid"](%/up_blocks.0/resnets.0/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0/Mul_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/Mul"](%/up_blocks.0/resnets.0/norm1/Add_output_0, %/up_blocks.0/resnets.0/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0/conv1/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.0/conv1/Conv"](%/up_blocks.0/resnets.0/Mul_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.0.conv1.weight, %inner_unet.inner_unet.up_blocks.0.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.0/time_layer/Gemm_output_0 : Float(1, 1536, strides=[1536, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.0/resnets.0/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.0.time_layer.weight, %inner_unet.inner_unet.up_blocks.0.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/resnets.0/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Unsqueeze_output_0 : Float(1, 1536, 1, strides=[1536, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.0/Unsqueeze"](%/up_blocks.0/resnets.0/time_layer/Gemm_output_0, %/up_blocks.0/resnets.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Unsqueeze_1_output_0 : Float(1, 1536, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.0/Unsqueeze_1"](%/up_blocks.0/resnets.0/Unsqueeze_output_0, %/up_blocks.0/resnets.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.0/Shape"](%/up_blocks.0/resnets.0/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/resnets.0/Gather"](%/up_blocks.0/resnets.0/Shape_output_0, %/up_blocks.0/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/resnets.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/resnets.0/Add"](%/up_blocks.0/resnets.0/Gather_output_0, %/up_blocks.0/resnets.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/resnets.0/Div"](%/up_blocks.0/resnets.0/Add_output_0, %/up_blocks.0/resnets.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/Mul_1"](%/up_blocks.0/resnets.0/Div_output_0, %/up_blocks.0/resnets.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Slice_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.0/Slice"](%/up_blocks.0/resnets.0/Unsqueeze_1_output_0, %/up_blocks.0/resnets.0/Constant_3_output_0, %/up_blocks.0/resnets.0/Mul_1_output_0, %/up_blocks.0/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/Mul_2"](%/up_blocks.0/resnets.0/Div_output_0, %/up_blocks.0/resnets.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/Slice_1_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.0/Slice_1"](%/up_blocks.0/resnets.0/Unsqueeze_1_output_0, %/up_blocks.0/resnets.0/Mul_1_output_0, %/up_blocks.0/resnets.0/Mul_2_output_0, %/up_blocks.0/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.0/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm2/Reshape"](%/up_blocks.0/resnets.0/conv1/Conv_output_0, %/up_blocks.0/resnets.0/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.0/norm2/InstanceNormalization"](%/up_blocks.0/resnets.0/norm2/Reshape_output_0, %/up_blocks.0/resnets.0/norm2/Constant_1_output_0, %/up_blocks.0/resnets.0/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.0/norm2/Shape"](%/up_blocks.0/resnets.0/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm2/Reshape_1"](%/up_blocks.0/resnets.0/norm2/InstanceNormalization_output_0, %/up_blocks.0/resnets.0/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/norm2/Mul"](%/up_blocks.0/resnets.0/norm2/Reshape_1_output_0, %onnx::Mul_9852), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0/norm2/Add"](%/up_blocks.0/resnets.0/norm2/Mul_output_0, %onnx::Add_9853), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0/Add_1_output_0 : Float(1, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0/Add_1"](%/up_blocks.0/resnets.0/Slice_output_0, %/up_blocks.0/resnets.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0/Mul_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/Mul_3"](%/up_blocks.0/resnets.0/norm2/Add_output_0, %/up_blocks.0/resnets.0/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0/Add_2_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0/Add_2"](%/up_blocks.0/resnets.0/Mul_3_output_0, %/up_blocks.0/resnets.0/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0/Sigmoid_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.0/Sigmoid_1"](%/up_blocks.0/resnets.0/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0/Mul_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/Mul_4"](%/up_blocks.0/resnets.0/Add_2_output_0, %/up_blocks.0/resnets.0/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0/conv2/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.0/conv2/Conv"](%/up_blocks.0/resnets.0/Mul_4_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.0.conv2.weight, %inner_unet.inner_unet.up_blocks.0.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.0/conv3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/resnets.0/conv3/Conv"](%/up_blocks.0/Concat_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.0.conv3.weight, %inner_unet.inner_unet.up_blocks.0.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.0/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0/Add_3"](%/up_blocks.0/resnets.0/conv2/Conv_output_0, %/up_blocks.0/resnets.0/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.0/attn.0/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.0/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/norm/Reshape"](%/up_blocks.0/resnets.0/Add_3_output_0, %/up_blocks.0/attn.0/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.0/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.0/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.0/norm/InstanceNormalization"](%/up_blocks.0/attn.0/norm/Reshape_output_0, %/up_blocks.0/attn.0/norm/Constant_1_output_0, %/up_blocks.0/attn.0/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.0/norm/Shape"](%/up_blocks.0/resnets.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/norm/Reshape_1"](%/up_blocks.0/attn.0/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.0/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/norm/Mul"](%/up_blocks.0/attn.0/norm/Reshape_1_output_0, %onnx::Mul_9854), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.0/norm/Add"](%/up_blocks.0/attn.0/norm/Mul_output_0, %onnx::Add_9855), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.0/qkv/Conv"](%/up_blocks.0/attn.0/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.0.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.0.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.0/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/Reshape"](%/up_blocks.0/attn.0/qkv/Conv_output_0, %/up_blocks.0/attn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.0/Shape"](%/up_blocks.0/attn.0/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.0/Gather"](%/up_blocks.0/attn.0/Shape_output_0, %/up_blocks.0/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.0/Add"](%/up_blocks.0/attn.0/Gather_output_0, %/up_blocks.0/attn.0/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.0/Div"](%/up_blocks.0/attn.0/Add_output_0, %/up_blocks.0/attn.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/Mul"](%/up_blocks.0/attn.0/Div_output_0, %/up_blocks.0/attn.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.0/Slice"](%/up_blocks.0/attn.0/Reshape_output_0, %/up_blocks.0/attn.0/Constant_2_output_0, %/up_blocks.0/attn.0/Mul_output_0, %/up_blocks.0/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/Mul_1"](%/up_blocks.0/attn.0/Div_output_0, %/up_blocks.0/attn.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.0/Slice_1"](%/up_blocks.0/attn.0/Reshape_output_0, %/up_blocks.0/attn.0/Mul_output_0, %/up_blocks.0/attn.0/Mul_1_output_0, %/up_blocks.0/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/Mul_2"](%/up_blocks.0/attn.0/Div_output_0, %/up_blocks.0/attn.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.0/Slice_2"](%/up_blocks.0/attn.0/Reshape_output_0, %/up_blocks.0/attn.0/Mul_1_output_0, %/up_blocks.0/attn.0/Mul_2_output_0, %/up_blocks.0/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.0/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.0/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.0/Reciprocal"](%/up_blocks.0/attn.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.0/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/Mul_3"](%/up_blocks.0/attn.0/Slice_output_0, %/up_blocks.0/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.0/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.0/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.0/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/Reshape_1"](%/up_blocks.0/attn.0/Mul_3_output_0, %/up_blocks.0/attn.0/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.0/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/Mul_4"](%/up_blocks.0/attn.0/Slice_1_output_0, %/up_blocks.0/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.0/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.0/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.0/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.0/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.0/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.0/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.0/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.0/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.0/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/Reshape_2"](%/up_blocks.0/attn.0/Mul_4_output_0, %/up_blocks.0/attn.0/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.0/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.0/Einsum"](%/up_blocks.0/attn.0/Reshape_1_output_0, %/up_blocks.0/attn.0/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.0/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.0/Cast"](%/up_blocks.0/attn.0/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.0/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.0/Softmax"](%/up_blocks.0/attn.0/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.0/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.0/Cast_1"](%/up_blocks.0/attn.0/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.0/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/Reshape_3"](%/up_blocks.0/attn.0/Slice_2_output_0, %/up_blocks.0/attn.0/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.0/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.0/Einsum_1"](%/up_blocks.0/attn.0/Cast_1_output_0, %/up_blocks.0/attn.0/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.0/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.0/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.0/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.0/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.0/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/Reshape_4"](%/up_blocks.0/attn.0/Einsum_1_output_0, %/up_blocks.0/attn.0/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.0/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.0/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.0.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.0.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.0/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.0/kv_cond/MatMul"](%/up_blocks.0/attn.0/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9888), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.0/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.0/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.0.kv_cond.bias, %/up_blocks.0/attn.0/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.0/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.0/Transpose"](%/up_blocks.0/attn.0/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.0/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.0/Shape_1"](%/up_blocks.0/attn.0/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.0/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.0/Gather_1"](%/up_blocks.0/attn.0/Shape_1_output_0, %/up_blocks.0/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.0/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.0/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.0/Add_1"](%/up_blocks.0/attn.0/Gather_1_output_0, %/up_blocks.0/attn.0/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.0/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.0/Div_1"](%/up_blocks.0/attn.0/Add_1_output_0, %/up_blocks.0/attn.0/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.0/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/Mul_5"](%/up_blocks.0/attn.0/Div_1_output_0, %/up_blocks.0/attn.0/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.0/Slice_3"](%/up_blocks.0/attn.0/Transpose_output_0, %/up_blocks.0/attn.0/Constant_17_output_0, %/up_blocks.0/attn.0/Mul_5_output_0, %/up_blocks.0/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.0/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/Mul_6"](%/up_blocks.0/attn.0/Div_1_output_0, %/up_blocks.0/attn.0/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.0/Slice_4"](%/up_blocks.0/attn.0/Transpose_output_0, %/up_blocks.0/attn.0/Mul_5_output_0, %/up_blocks.0/attn.0/Mul_6_output_0, %/up_blocks.0/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.0/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/Mul_7"](%/up_blocks.0/attn.0/Slice_3_output_0, %/up_blocks.0/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.0/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/Reshape_5"](%/up_blocks.0/attn.0/Mul_7_output_0, %/up_blocks.0/attn.0/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.0/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.0/Einsum_2"](%/up_blocks.0/attn.0/Reshape_1_output_0, %/up_blocks.0/attn.0/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.0/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.0/Cast_2"](%/up_blocks.0/attn.0/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.0/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.0/Softmax_1"](%/up_blocks.0/attn.0/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.0/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.0/Cast_3"](%/up_blocks.0/attn.0/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.0/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/Reshape_6"](%/up_blocks.0/attn.0/Slice_4_output_0, %/up_blocks.0/attn.0/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.0/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.0/Einsum_3"](%/up_blocks.0/attn.0/Cast_3_output_0, %/up_blocks.0/attn.0/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.0/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/Reshape_7"](%/up_blocks.0/attn.0/Einsum_3_output_0, %/up_blocks.0/attn.0/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.0/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.0/Add_2"](%/up_blocks.0/attn.0/Reshape_4_output_0, %/up_blocks.0/attn.0/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.0/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.0/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.0/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/Reshape_8"](%/up_blocks.0/attn.0/Add_2_output_0, %/up_blocks.0/attn.0/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.0/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.0/proj_out/Conv"](%/up_blocks.0/attn.0/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.0.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.0.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.0/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.0/Add_3"](%/up_blocks.0/resnets.0/Add_3_output_0, %/up_blocks.0/attn.0/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.0/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.0/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.0/Add_3_output_0, %/up_blocks.0/attn.0/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.0/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.0/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.0/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.0/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.0/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.0/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.0/ffn/ffn.0/Shape"](%/up_blocks.0/attn.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.0/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.0/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.0/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/ffn/ffn.0/Mul"](%/up_blocks.0/attn.0/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9894), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.0/ffn/ffn.0/Add"](%/up_blocks.0/attn.0/ffn/ffn.0/Mul_output_0, %onnx::Add_9895), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.0/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.0/ffn/ffn.1/Conv"](%/up_blocks.0/attn.0/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.0.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.0.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.0/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.0/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.0/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.0/ffn/ffn.2/Div"](%/up_blocks.0/attn.0/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.0/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.0/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.0/ffn/ffn.2/Erf"](%/up_blocks.0/attn.0/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.0/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.0/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.0/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.0/ffn/ffn.2/Add"](%/up_blocks.0/attn.0/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.0/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.0/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/ffn/ffn.2/Mul"](%/up_blocks.0/attn.0/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.0/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.0/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.0/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.0/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.0/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.0/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.0/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.0/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.0/ffn/ffn.3/Conv"](%/up_blocks.0/attn.0/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.0.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.0.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.0/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.0/Add_4"](%/up_blocks.0/attn.0/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.1/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.1/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/norm/Reshape"](%/up_blocks.0/attn.0/Add_4_output_0, %/up_blocks.0/attn.1/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.1/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.1/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.1/norm/InstanceNormalization"](%/up_blocks.0/attn.1/norm/Reshape_output_0, %/up_blocks.0/attn.1/norm/Constant_1_output_0, %/up_blocks.0/attn.1/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.1/norm/Shape"](%/up_blocks.0/attn.0/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/norm/Reshape_1"](%/up_blocks.0/attn.1/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.1/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/norm/Mul"](%/up_blocks.0/attn.1/norm/Reshape_1_output_0, %onnx::Mul_9896), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.1/norm/Add"](%/up_blocks.0/attn.1/norm/Mul_output_0, %onnx::Add_9897), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.1/qkv/Conv"](%/up_blocks.0/attn.1/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.1.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.1.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.1/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/Reshape"](%/up_blocks.0/attn.1/qkv/Conv_output_0, %/up_blocks.0/attn.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.1/Shape"](%/up_blocks.0/attn.1/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.1/Gather"](%/up_blocks.0/attn.1/Shape_output_0, %/up_blocks.0/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.1/Add"](%/up_blocks.0/attn.1/Gather_output_0, %/up_blocks.0/attn.1/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.1/Div"](%/up_blocks.0/attn.1/Add_output_0, %/up_blocks.0/attn.1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/Mul"](%/up_blocks.0/attn.1/Div_output_0, %/up_blocks.0/attn.1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.1/Slice"](%/up_blocks.0/attn.1/Reshape_output_0, %/up_blocks.0/attn.1/Constant_2_output_0, %/up_blocks.0/attn.1/Mul_output_0, %/up_blocks.0/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/Mul_1"](%/up_blocks.0/attn.1/Div_output_0, %/up_blocks.0/attn.1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.1/Slice_1"](%/up_blocks.0/attn.1/Reshape_output_0, %/up_blocks.0/attn.1/Mul_output_0, %/up_blocks.0/attn.1/Mul_1_output_0, %/up_blocks.0/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/Mul_2"](%/up_blocks.0/attn.1/Div_output_0, %/up_blocks.0/attn.1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.1/Slice_2"](%/up_blocks.0/attn.1/Reshape_output_0, %/up_blocks.0/attn.1/Mul_1_output_0, %/up_blocks.0/attn.1/Mul_2_output_0, %/up_blocks.0/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.1/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.1/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.1/Reciprocal"](%/up_blocks.0/attn.1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.1/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/Mul_3"](%/up_blocks.0/attn.1/Slice_output_0, %/up_blocks.0/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.1/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.1/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.1/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/Reshape_1"](%/up_blocks.0/attn.1/Mul_3_output_0, %/up_blocks.0/attn.1/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.1/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/Mul_4"](%/up_blocks.0/attn.1/Slice_1_output_0, %/up_blocks.0/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.1/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.1/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.1/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.1/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.1/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.1/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.1/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.1/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.1/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/Reshape_2"](%/up_blocks.0/attn.1/Mul_4_output_0, %/up_blocks.0/attn.1/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.1/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.1/Einsum"](%/up_blocks.0/attn.1/Reshape_1_output_0, %/up_blocks.0/attn.1/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.1/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.1/Cast"](%/up_blocks.0/attn.1/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.1/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.1/Softmax"](%/up_blocks.0/attn.1/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.1/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.1/Cast_1"](%/up_blocks.0/attn.1/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.1/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/Reshape_3"](%/up_blocks.0/attn.1/Slice_2_output_0, %/up_blocks.0/attn.1/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.1/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.1/Einsum_1"](%/up_blocks.0/attn.1/Cast_1_output_0, %/up_blocks.0/attn.1/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.1/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.1/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.1/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.1/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.1/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/Reshape_4"](%/up_blocks.0/attn.1/Einsum_1_output_0, %/up_blocks.0/attn.1/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.1/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.1/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.1.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.1.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.1/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.1/kv_cond/MatMul"](%/up_blocks.0/attn.1/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9930), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.1/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.1/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.1.kv_cond.bias, %/up_blocks.0/attn.1/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.1/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.1/Transpose"](%/up_blocks.0/attn.1/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.1/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.1/Shape_1"](%/up_blocks.0/attn.1/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.1/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.1/Gather_1"](%/up_blocks.0/attn.1/Shape_1_output_0, %/up_blocks.0/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.1/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.1/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.1/Add_1"](%/up_blocks.0/attn.1/Gather_1_output_0, %/up_blocks.0/attn.1/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.1/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.1/Div_1"](%/up_blocks.0/attn.1/Add_1_output_0, %/up_blocks.0/attn.1/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.1/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/Mul_5"](%/up_blocks.0/attn.1/Div_1_output_0, %/up_blocks.0/attn.1/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.1/Slice_3"](%/up_blocks.0/attn.1/Transpose_output_0, %/up_blocks.0/attn.1/Constant_17_output_0, %/up_blocks.0/attn.1/Mul_5_output_0, %/up_blocks.0/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.1/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/Mul_6"](%/up_blocks.0/attn.1/Div_1_output_0, %/up_blocks.0/attn.1/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.1/Slice_4"](%/up_blocks.0/attn.1/Transpose_output_0, %/up_blocks.0/attn.1/Mul_5_output_0, %/up_blocks.0/attn.1/Mul_6_output_0, %/up_blocks.0/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.1/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/Mul_7"](%/up_blocks.0/attn.1/Slice_3_output_0, %/up_blocks.0/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.1/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/Reshape_5"](%/up_blocks.0/attn.1/Mul_7_output_0, %/up_blocks.0/attn.1/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.1/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.1/Einsum_2"](%/up_blocks.0/attn.1/Reshape_1_output_0, %/up_blocks.0/attn.1/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.1/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.1/Cast_2"](%/up_blocks.0/attn.1/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.1/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.1/Softmax_1"](%/up_blocks.0/attn.1/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.1/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.1/Cast_3"](%/up_blocks.0/attn.1/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.1/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/Reshape_6"](%/up_blocks.0/attn.1/Slice_4_output_0, %/up_blocks.0/attn.1/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.1/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.1/Einsum_3"](%/up_blocks.0/attn.1/Cast_3_output_0, %/up_blocks.0/attn.1/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.1/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/Reshape_7"](%/up_blocks.0/attn.1/Einsum_3_output_0, %/up_blocks.0/attn.1/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.1/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.1/Add_2"](%/up_blocks.0/attn.1/Reshape_4_output_0, %/up_blocks.0/attn.1/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.1/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.1/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.1/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/Reshape_8"](%/up_blocks.0/attn.1/Add_2_output_0, %/up_blocks.0/attn.1/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.1/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.1/proj_out/Conv"](%/up_blocks.0/attn.1/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.1.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.1.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.1/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.1/Add_3"](%/up_blocks.0/attn.0/Add_4_output_0, %/up_blocks.0/attn.1/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.1/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.1/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.1/Add_3_output_0, %/up_blocks.0/attn.1/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.1/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.1/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.1/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.1/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.1/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.1/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.1/ffn/ffn.0/Shape"](%/up_blocks.0/attn.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.1/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.1/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.1/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/ffn/ffn.0/Mul"](%/up_blocks.0/attn.1/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9936), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.1/ffn/ffn.0/Add"](%/up_blocks.0/attn.1/ffn/ffn.0/Mul_output_0, %onnx::Add_9937), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.1/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.1/ffn/ffn.1/Conv"](%/up_blocks.0/attn.1/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.1.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.1.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.1/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.1/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.1/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.1/ffn/ffn.2/Div"](%/up_blocks.0/attn.1/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.1/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.1/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.1/ffn/ffn.2/Erf"](%/up_blocks.0/attn.1/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.1/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.1/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.1/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.1/ffn/ffn.2/Add"](%/up_blocks.0/attn.1/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.1/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.1/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/ffn/ffn.2/Mul"](%/up_blocks.0/attn.1/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.1/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.1/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.1/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.1/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.1/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.1/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.1/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.1/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.1/ffn/ffn.3/Conv"](%/up_blocks.0/attn.1/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.1.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.1.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.1/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.1/Add_4"](%/up_blocks.0/attn.1/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.2/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.2/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/norm/Reshape"](%/up_blocks.0/attn.1/Add_4_output_0, %/up_blocks.0/attn.2/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.2/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.2/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.2/norm/InstanceNormalization"](%/up_blocks.0/attn.2/norm/Reshape_output_0, %/up_blocks.0/attn.2/norm/Constant_1_output_0, %/up_blocks.0/attn.2/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.2/norm/Shape"](%/up_blocks.0/attn.1/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/norm/Reshape_1"](%/up_blocks.0/attn.2/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.2/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/norm/Mul"](%/up_blocks.0/attn.2/norm/Reshape_1_output_0, %onnx::Mul_9938), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.2/norm/Add"](%/up_blocks.0/attn.2/norm/Mul_output_0, %onnx::Add_9939), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.2/qkv/Conv"](%/up_blocks.0/attn.2/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.2.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.2.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.2/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/Reshape"](%/up_blocks.0/attn.2/qkv/Conv_output_0, %/up_blocks.0/attn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.2/Shape"](%/up_blocks.0/attn.2/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.2/Gather"](%/up_blocks.0/attn.2/Shape_output_0, %/up_blocks.0/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.2/Add"](%/up_blocks.0/attn.2/Gather_output_0, %/up_blocks.0/attn.2/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.2/Div"](%/up_blocks.0/attn.2/Add_output_0, %/up_blocks.0/attn.2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/Mul"](%/up_blocks.0/attn.2/Div_output_0, %/up_blocks.0/attn.2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.2/Slice"](%/up_blocks.0/attn.2/Reshape_output_0, %/up_blocks.0/attn.2/Constant_2_output_0, %/up_blocks.0/attn.2/Mul_output_0, %/up_blocks.0/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/Mul_1"](%/up_blocks.0/attn.2/Div_output_0, %/up_blocks.0/attn.2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.2/Slice_1"](%/up_blocks.0/attn.2/Reshape_output_0, %/up_blocks.0/attn.2/Mul_output_0, %/up_blocks.0/attn.2/Mul_1_output_0, %/up_blocks.0/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/Mul_2"](%/up_blocks.0/attn.2/Div_output_0, %/up_blocks.0/attn.2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.2/Slice_2"](%/up_blocks.0/attn.2/Reshape_output_0, %/up_blocks.0/attn.2/Mul_1_output_0, %/up_blocks.0/attn.2/Mul_2_output_0, %/up_blocks.0/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.2/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.2/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.2/Reciprocal"](%/up_blocks.0/attn.2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.2/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/Mul_3"](%/up_blocks.0/attn.2/Slice_output_0, %/up_blocks.0/attn.2/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.2/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.2/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.2/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/Reshape_1"](%/up_blocks.0/attn.2/Mul_3_output_0, %/up_blocks.0/attn.2/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.2/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/Mul_4"](%/up_blocks.0/attn.2/Slice_1_output_0, %/up_blocks.0/attn.2/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.2/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.2/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.2/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.2/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.2/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.2/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.2/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.2/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.2/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/Reshape_2"](%/up_blocks.0/attn.2/Mul_4_output_0, %/up_blocks.0/attn.2/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.2/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.2/Einsum"](%/up_blocks.0/attn.2/Reshape_1_output_0, %/up_blocks.0/attn.2/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.2/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.2/Cast"](%/up_blocks.0/attn.2/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.2/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.2/Softmax"](%/up_blocks.0/attn.2/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.2/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.2/Cast_1"](%/up_blocks.0/attn.2/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.2/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/Reshape_3"](%/up_blocks.0/attn.2/Slice_2_output_0, %/up_blocks.0/attn.2/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.2/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.2/Einsum_1"](%/up_blocks.0/attn.2/Cast_1_output_0, %/up_blocks.0/attn.2/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.2/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.2/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.2/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.2/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.2/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/Reshape_4"](%/up_blocks.0/attn.2/Einsum_1_output_0, %/up_blocks.0/attn.2/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.2/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.2/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.2.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.2.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.2/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.2/kv_cond/MatMul"](%/up_blocks.0/attn.2/norm_cond/LayerNormalization_output_0, %onnx::MatMul_9972), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.2/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.2/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.2.kv_cond.bias, %/up_blocks.0/attn.2/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.2/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.2/Transpose"](%/up_blocks.0/attn.2/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.2/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.2/Shape_1"](%/up_blocks.0/attn.2/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.2/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.2/Gather_1"](%/up_blocks.0/attn.2/Shape_1_output_0, %/up_blocks.0/attn.2/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.2/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.2/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.2/Add_1"](%/up_blocks.0/attn.2/Gather_1_output_0, %/up_blocks.0/attn.2/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.2/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.2/Div_1"](%/up_blocks.0/attn.2/Add_1_output_0, %/up_blocks.0/attn.2/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.2/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/Mul_5"](%/up_blocks.0/attn.2/Div_1_output_0, %/up_blocks.0/attn.2/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.2/Slice_3"](%/up_blocks.0/attn.2/Transpose_output_0, %/up_blocks.0/attn.2/Constant_17_output_0, %/up_blocks.0/attn.2/Mul_5_output_0, %/up_blocks.0/attn.2/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.2/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/Mul_6"](%/up_blocks.0/attn.2/Div_1_output_0, %/up_blocks.0/attn.2/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.2/Slice_4"](%/up_blocks.0/attn.2/Transpose_output_0, %/up_blocks.0/attn.2/Mul_5_output_0, %/up_blocks.0/attn.2/Mul_6_output_0, %/up_blocks.0/attn.2/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.2/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/Mul_7"](%/up_blocks.0/attn.2/Slice_3_output_0, %/up_blocks.0/attn.2/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.2/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/Reshape_5"](%/up_blocks.0/attn.2/Mul_7_output_0, %/up_blocks.0/attn.2/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.2/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.2/Einsum_2"](%/up_blocks.0/attn.2/Reshape_1_output_0, %/up_blocks.0/attn.2/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.2/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.2/Cast_2"](%/up_blocks.0/attn.2/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.2/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.2/Softmax_1"](%/up_blocks.0/attn.2/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.2/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.2/Cast_3"](%/up_blocks.0/attn.2/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.2/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/Reshape_6"](%/up_blocks.0/attn.2/Slice_4_output_0, %/up_blocks.0/attn.2/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.2/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.2/Einsum_3"](%/up_blocks.0/attn.2/Cast_3_output_0, %/up_blocks.0/attn.2/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.2/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/Reshape_7"](%/up_blocks.0/attn.2/Einsum_3_output_0, %/up_blocks.0/attn.2/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.2/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.2/Add_2"](%/up_blocks.0/attn.2/Reshape_4_output_0, %/up_blocks.0/attn.2/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.2/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.2/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.2/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/Reshape_8"](%/up_blocks.0/attn.2/Add_2_output_0, %/up_blocks.0/attn.2/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.2/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.2/proj_out/Conv"](%/up_blocks.0/attn.2/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.2.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.2.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.2/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.2/Add_3"](%/up_blocks.0/attn.1/Add_4_output_0, %/up_blocks.0/attn.2/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.2/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.2/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.2/Add_3_output_0, %/up_blocks.0/attn.2/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.2/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.2/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.2/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.2/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.2/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.2/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.2/ffn/ffn.0/Shape"](%/up_blocks.0/attn.2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.2/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.2/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.2/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/ffn/ffn.0/Mul"](%/up_blocks.0/attn.2/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_9978), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.2/ffn/ffn.0/Add"](%/up_blocks.0/attn.2/ffn/ffn.0/Mul_output_0, %onnx::Add_9979), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.2/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.2/ffn/ffn.1/Conv"](%/up_blocks.0/attn.2/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.2.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.2.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.2/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.2/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.2/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.2/ffn/ffn.2/Div"](%/up_blocks.0/attn.2/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.2/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.2/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.2/ffn/ffn.2/Erf"](%/up_blocks.0/attn.2/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.2/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.2/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.2/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.2/ffn/ffn.2/Add"](%/up_blocks.0/attn.2/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.2/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.2/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/ffn/ffn.2/Mul"](%/up_blocks.0/attn.2/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.2/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.2/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.2/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.2/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.2/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.2/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.2/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.2/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.2/ffn/ffn.3/Conv"](%/up_blocks.0/attn.2/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.2.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.2.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.2/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.2/Add_4"](%/up_blocks.0/attn.2/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.3/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.3/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/norm/Reshape"](%/up_blocks.0/attn.2/Add_4_output_0, %/up_blocks.0/attn.3/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.3/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.3/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.3/norm/InstanceNormalization"](%/up_blocks.0/attn.3/norm/Reshape_output_0, %/up_blocks.0/attn.3/norm/Constant_1_output_0, %/up_blocks.0/attn.3/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.3/norm/Shape"](%/up_blocks.0/attn.2/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/norm/Reshape_1"](%/up_blocks.0/attn.3/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.3/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/norm/Mul"](%/up_blocks.0/attn.3/norm/Reshape_1_output_0, %onnx::Mul_9980), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.3/norm/Add"](%/up_blocks.0/attn.3/norm/Mul_output_0, %onnx::Add_9981), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.3/qkv/Conv"](%/up_blocks.0/attn.3/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.3.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.3.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.3/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.3/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/Reshape"](%/up_blocks.0/attn.3/qkv/Conv_output_0, %/up_blocks.0/attn.3/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.3/Shape"](%/up_blocks.0/attn.3/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.3/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.3/Gather"](%/up_blocks.0/attn.3/Shape_output_0, %/up_blocks.0/attn.3/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.3/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.3/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.3/Add"](%/up_blocks.0/attn.3/Gather_output_0, %/up_blocks.0/attn.3/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.3/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.3/Div"](%/up_blocks.0/attn.3/Add_output_0, %/up_blocks.0/attn.3/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.3/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/Mul"](%/up_blocks.0/attn.3/Div_output_0, %/up_blocks.0/attn.3/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.3/Slice"](%/up_blocks.0/attn.3/Reshape_output_0, %/up_blocks.0/attn.3/Constant_2_output_0, %/up_blocks.0/attn.3/Mul_output_0, %/up_blocks.0/attn.3/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.3/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/Mul_1"](%/up_blocks.0/attn.3/Div_output_0, %/up_blocks.0/attn.3/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.3/Slice_1"](%/up_blocks.0/attn.3/Reshape_output_0, %/up_blocks.0/attn.3/Mul_output_0, %/up_blocks.0/attn.3/Mul_1_output_0, %/up_blocks.0/attn.3/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.3/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/Mul_2"](%/up_blocks.0/attn.3/Div_output_0, %/up_blocks.0/attn.3/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.3/Slice_2"](%/up_blocks.0/attn.3/Reshape_output_0, %/up_blocks.0/attn.3/Mul_1_output_0, %/up_blocks.0/attn.3/Mul_2_output_0, %/up_blocks.0/attn.3/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.3/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.3/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.3/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.3/Reciprocal"](%/up_blocks.0/attn.3/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.3/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/Mul_3"](%/up_blocks.0/attn.3/Slice_output_0, %/up_blocks.0/attn.3/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.3/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.3/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.3/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/Reshape_1"](%/up_blocks.0/attn.3/Mul_3_output_0, %/up_blocks.0/attn.3/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.3/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/Mul_4"](%/up_blocks.0/attn.3/Slice_1_output_0, %/up_blocks.0/attn.3/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.3/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.3/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.3/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.3/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.3/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.3/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.3/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.3/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.3/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/Reshape_2"](%/up_blocks.0/attn.3/Mul_4_output_0, %/up_blocks.0/attn.3/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.3/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.3/Einsum"](%/up_blocks.0/attn.3/Reshape_1_output_0, %/up_blocks.0/attn.3/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.3/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.3/Cast"](%/up_blocks.0/attn.3/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.3/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.3/Softmax"](%/up_blocks.0/attn.3/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.3/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.3/Cast_1"](%/up_blocks.0/attn.3/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.3/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/Reshape_3"](%/up_blocks.0/attn.3/Slice_2_output_0, %/up_blocks.0/attn.3/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.3/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.3/Einsum_1"](%/up_blocks.0/attn.3/Cast_1_output_0, %/up_blocks.0/attn.3/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.3/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.3/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.3/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.3/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.3/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/Reshape_4"](%/up_blocks.0/attn.3/Einsum_1_output_0, %/up_blocks.0/attn.3/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.3/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.3/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.3.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.3.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.3/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.3/kv_cond/MatMul"](%/up_blocks.0/attn.3/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10014), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.3/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.3/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.3.kv_cond.bias, %/up_blocks.0/attn.3/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.3/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.3/Transpose"](%/up_blocks.0/attn.3/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.3/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.3/Shape_1"](%/up_blocks.0/attn.3/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.3/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.3/Gather_1"](%/up_blocks.0/attn.3/Shape_1_output_0, %/up_blocks.0/attn.3/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.3/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.3/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.3/Add_1"](%/up_blocks.0/attn.3/Gather_1_output_0, %/up_blocks.0/attn.3/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.3/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.3/Div_1"](%/up_blocks.0/attn.3/Add_1_output_0, %/up_blocks.0/attn.3/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.3/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/Mul_5"](%/up_blocks.0/attn.3/Div_1_output_0, %/up_blocks.0/attn.3/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.3/Slice_3"](%/up_blocks.0/attn.3/Transpose_output_0, %/up_blocks.0/attn.3/Constant_17_output_0, %/up_blocks.0/attn.3/Mul_5_output_0, %/up_blocks.0/attn.3/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.3/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/Mul_6"](%/up_blocks.0/attn.3/Div_1_output_0, %/up_blocks.0/attn.3/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.3/Slice_4"](%/up_blocks.0/attn.3/Transpose_output_0, %/up_blocks.0/attn.3/Mul_5_output_0, %/up_blocks.0/attn.3/Mul_6_output_0, %/up_blocks.0/attn.3/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.3/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/Mul_7"](%/up_blocks.0/attn.3/Slice_3_output_0, %/up_blocks.0/attn.3/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.3/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/Reshape_5"](%/up_blocks.0/attn.3/Mul_7_output_0, %/up_blocks.0/attn.3/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.3/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.3/Einsum_2"](%/up_blocks.0/attn.3/Reshape_1_output_0, %/up_blocks.0/attn.3/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.3/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.3/Cast_2"](%/up_blocks.0/attn.3/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.3/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.3/Softmax_1"](%/up_blocks.0/attn.3/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.3/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.3/Cast_3"](%/up_blocks.0/attn.3/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.3/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/Reshape_6"](%/up_blocks.0/attn.3/Slice_4_output_0, %/up_blocks.0/attn.3/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.3/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.3/Einsum_3"](%/up_blocks.0/attn.3/Cast_3_output_0, %/up_blocks.0/attn.3/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.3/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/Reshape_7"](%/up_blocks.0/attn.3/Einsum_3_output_0, %/up_blocks.0/attn.3/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.3/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.3/Add_2"](%/up_blocks.0/attn.3/Reshape_4_output_0, %/up_blocks.0/attn.3/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.3/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.3/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.3/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/Reshape_8"](%/up_blocks.0/attn.3/Add_2_output_0, %/up_blocks.0/attn.3/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.3/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.3/proj_out/Conv"](%/up_blocks.0/attn.3/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.3.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.3.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.3/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.3/Add_3"](%/up_blocks.0/attn.2/Add_4_output_0, %/up_blocks.0/attn.3/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.3/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.3/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.3/Add_3_output_0, %/up_blocks.0/attn.3/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.3/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.3/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.3/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.3/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.3/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.3/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.3/ffn/ffn.0/Shape"](%/up_blocks.0/attn.3/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.3/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.3/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.3/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/ffn/ffn.0/Mul"](%/up_blocks.0/attn.3/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10020), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.3/ffn/ffn.0/Add"](%/up_blocks.0/attn.3/ffn/ffn.0/Mul_output_0, %onnx::Add_10021), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.3/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.3/ffn/ffn.1/Conv"](%/up_blocks.0/attn.3/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.3.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.3.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.3/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.3/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.3/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.3/ffn/ffn.2/Div"](%/up_blocks.0/attn.3/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.3/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.3/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.3/ffn/ffn.2/Erf"](%/up_blocks.0/attn.3/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.3/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.3/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.3/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.3/ffn/ffn.2/Add"](%/up_blocks.0/attn.3/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.3/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.3/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/ffn/ffn.2/Mul"](%/up_blocks.0/attn.3/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.3/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.3/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.3/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.3/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.3/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.3/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.3/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.3/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.3/ffn/ffn.3/Conv"](%/up_blocks.0/attn.3/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.3.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.3.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.3/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.3/Add_4"](%/up_blocks.0/attn.3/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.3/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.3 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.4/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.4/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/norm/Reshape"](%/up_blocks.0/attn.3/Add_4_output_0, %/up_blocks.0/attn.4/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.4/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.4/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.4/norm/InstanceNormalization"](%/up_blocks.0/attn.4/norm/Reshape_output_0, %/up_blocks.0/attn.4/norm/Constant_1_output_0, %/up_blocks.0/attn.4/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.4/norm/Shape"](%/up_blocks.0/attn.3/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/norm/Reshape_1"](%/up_blocks.0/attn.4/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.4/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/norm/Mul"](%/up_blocks.0/attn.4/norm/Reshape_1_output_0, %onnx::Mul_10022), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.4/norm/Add"](%/up_blocks.0/attn.4/norm/Mul_output_0, %onnx::Add_10023), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.4/qkv/Conv"](%/up_blocks.0/attn.4/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.4.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.4.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.4/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.4/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/Reshape"](%/up_blocks.0/attn.4/qkv/Conv_output_0, %/up_blocks.0/attn.4/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.4/Shape"](%/up_blocks.0/attn.4/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.4/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.4/Gather"](%/up_blocks.0/attn.4/Shape_output_0, %/up_blocks.0/attn.4/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.4/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.4/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.4/Add"](%/up_blocks.0/attn.4/Gather_output_0, %/up_blocks.0/attn.4/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.4/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.4/Div"](%/up_blocks.0/attn.4/Add_output_0, %/up_blocks.0/attn.4/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.4/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/Mul"](%/up_blocks.0/attn.4/Div_output_0, %/up_blocks.0/attn.4/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.4/Slice"](%/up_blocks.0/attn.4/Reshape_output_0, %/up_blocks.0/attn.4/Constant_2_output_0, %/up_blocks.0/attn.4/Mul_output_0, %/up_blocks.0/attn.4/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.4/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/Mul_1"](%/up_blocks.0/attn.4/Div_output_0, %/up_blocks.0/attn.4/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.4/Slice_1"](%/up_blocks.0/attn.4/Reshape_output_0, %/up_blocks.0/attn.4/Mul_output_0, %/up_blocks.0/attn.4/Mul_1_output_0, %/up_blocks.0/attn.4/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.4/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/Mul_2"](%/up_blocks.0/attn.4/Div_output_0, %/up_blocks.0/attn.4/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.4/Slice_2"](%/up_blocks.0/attn.4/Reshape_output_0, %/up_blocks.0/attn.4/Mul_1_output_0, %/up_blocks.0/attn.4/Mul_2_output_0, %/up_blocks.0/attn.4/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.4/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.4/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.4/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.4/Reciprocal"](%/up_blocks.0/attn.4/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.4/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/Mul_3"](%/up_blocks.0/attn.4/Slice_output_0, %/up_blocks.0/attn.4/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.4/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.4/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.4/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/Reshape_1"](%/up_blocks.0/attn.4/Mul_3_output_0, %/up_blocks.0/attn.4/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.4/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/Mul_4"](%/up_blocks.0/attn.4/Slice_1_output_0, %/up_blocks.0/attn.4/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.4/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.4/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.4/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.4/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.4/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.4/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.4/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.4/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.4/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/Reshape_2"](%/up_blocks.0/attn.4/Mul_4_output_0, %/up_blocks.0/attn.4/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.4/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.4/Einsum"](%/up_blocks.0/attn.4/Reshape_1_output_0, %/up_blocks.0/attn.4/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.4/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.4/Cast"](%/up_blocks.0/attn.4/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.4/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.4/Softmax"](%/up_blocks.0/attn.4/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.4/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.4/Cast_1"](%/up_blocks.0/attn.4/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.4/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/Reshape_3"](%/up_blocks.0/attn.4/Slice_2_output_0, %/up_blocks.0/attn.4/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.4/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.4/Einsum_1"](%/up_blocks.0/attn.4/Cast_1_output_0, %/up_blocks.0/attn.4/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.4/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.4/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.4/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.4/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.4/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/Reshape_4"](%/up_blocks.0/attn.4/Einsum_1_output_0, %/up_blocks.0/attn.4/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.4/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.4/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.4.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.4.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.4/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.4/kv_cond/MatMul"](%/up_blocks.0/attn.4/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10056), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.4/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.4/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.4.kv_cond.bias, %/up_blocks.0/attn.4/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.4/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.4/Transpose"](%/up_blocks.0/attn.4/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.4/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.4/Shape_1"](%/up_blocks.0/attn.4/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.4/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.4/Gather_1"](%/up_blocks.0/attn.4/Shape_1_output_0, %/up_blocks.0/attn.4/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.4/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.4/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.4/Add_1"](%/up_blocks.0/attn.4/Gather_1_output_0, %/up_blocks.0/attn.4/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.4/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.4/Div_1"](%/up_blocks.0/attn.4/Add_1_output_0, %/up_blocks.0/attn.4/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.4/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/Mul_5"](%/up_blocks.0/attn.4/Div_1_output_0, %/up_blocks.0/attn.4/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.4/Slice_3"](%/up_blocks.0/attn.4/Transpose_output_0, %/up_blocks.0/attn.4/Constant_17_output_0, %/up_blocks.0/attn.4/Mul_5_output_0, %/up_blocks.0/attn.4/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.4/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/Mul_6"](%/up_blocks.0/attn.4/Div_1_output_0, %/up_blocks.0/attn.4/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.4/Slice_4"](%/up_blocks.0/attn.4/Transpose_output_0, %/up_blocks.0/attn.4/Mul_5_output_0, %/up_blocks.0/attn.4/Mul_6_output_0, %/up_blocks.0/attn.4/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.4/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/Mul_7"](%/up_blocks.0/attn.4/Slice_3_output_0, %/up_blocks.0/attn.4/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.4/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/Reshape_5"](%/up_blocks.0/attn.4/Mul_7_output_0, %/up_blocks.0/attn.4/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.4/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.4/Einsum_2"](%/up_blocks.0/attn.4/Reshape_1_output_0, %/up_blocks.0/attn.4/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.4/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.4/Cast_2"](%/up_blocks.0/attn.4/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.4/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.4/Softmax_1"](%/up_blocks.0/attn.4/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.4/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.4/Cast_3"](%/up_blocks.0/attn.4/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.4/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/Reshape_6"](%/up_blocks.0/attn.4/Slice_4_output_0, %/up_blocks.0/attn.4/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.4/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.4/Einsum_3"](%/up_blocks.0/attn.4/Cast_3_output_0, %/up_blocks.0/attn.4/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.4/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/Reshape_7"](%/up_blocks.0/attn.4/Einsum_3_output_0, %/up_blocks.0/attn.4/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.4/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.4/Add_2"](%/up_blocks.0/attn.4/Reshape_4_output_0, %/up_blocks.0/attn.4/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.4/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.4/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.4/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/Reshape_8"](%/up_blocks.0/attn.4/Add_2_output_0, %/up_blocks.0/attn.4/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.4/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.4/proj_out/Conv"](%/up_blocks.0/attn.4/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.4.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.4.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.4/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.4/Add_3"](%/up_blocks.0/attn.3/Add_4_output_0, %/up_blocks.0/attn.4/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.4/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.4/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.4/Add_3_output_0, %/up_blocks.0/attn.4/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.4/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.4/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.4/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.4/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.4/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.4/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.4/ffn/ffn.0/Shape"](%/up_blocks.0/attn.4/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.4/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.4/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.4/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/ffn/ffn.0/Mul"](%/up_blocks.0/attn.4/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10062), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.4/ffn/ffn.0/Add"](%/up_blocks.0/attn.4/ffn/ffn.0/Mul_output_0, %onnx::Add_10063), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.4/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.4/ffn/ffn.1/Conv"](%/up_blocks.0/attn.4/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.4.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.4.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.4/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.4/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.4/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.4/ffn/ffn.2/Div"](%/up_blocks.0/attn.4/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.4/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.4/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.4/ffn/ffn.2/Erf"](%/up_blocks.0/attn.4/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.4/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.4/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.4/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.4/ffn/ffn.2/Add"](%/up_blocks.0/attn.4/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.4/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.4/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/ffn/ffn.2/Mul"](%/up_blocks.0/attn.4/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.4/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.4/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.4/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.4/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.4/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.4/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.4/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.4/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.4/ffn/ffn.3/Conv"](%/up_blocks.0/attn.4/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.4.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.4.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.4/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.4/Add_4"](%/up_blocks.0/attn.4/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.4/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.4 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/Concat_1_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.0/Concat_1"](%/up_blocks.0/attn.4/Add_4_output_0, %/down_blocks.2/attn.4/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.0/resnets.1/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.1/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1/Reshape_output_0 : Float(1, 32, 96, strides=[3072, 96, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm1/Reshape"](%/up_blocks.0/Concat_1_output_0, %/up_blocks.0/resnets.1/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1/InstanceNormalization_output_0 : Float(1, 32, 96, strides=[3072, 96, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.1/norm1/InstanceNormalization"](%/up_blocks.0/resnets.1/norm1/Reshape_output_0, %/up_blocks.0/resnets.1/norm1/Constant_1_output_0, %/up_blocks.0/resnets.1/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.1/norm1/Shape"](%/up_blocks.0/Concat_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1/Reshape_1_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm1/Reshape_1"](%/up_blocks.0/resnets.1/norm1/InstanceNormalization_output_0, %/up_blocks.0/resnets.1/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1/Mul_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/norm1/Mul"](%/up_blocks.0/resnets.1/norm1/Reshape_1_output_0, %onnx::Mul_10064), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1/Add_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1/norm1/Add"](%/up_blocks.0/resnets.1/norm1/Mul_output_0, %onnx::Add_10065), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/Sigmoid_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.1/Sigmoid"](%/up_blocks.0/resnets.1/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1/Mul_output_0 : Float(1, 1536, 2, 1, strides=[3072, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/Mul"](%/up_blocks.0/resnets.1/norm1/Add_output_0, %/up_blocks.0/resnets.1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1/conv1/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.1/conv1/Conv"](%/up_blocks.0/resnets.1/Mul_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.1.conv1.weight, %inner_unet.inner_unet.up_blocks.0.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.1/time_layer/Gemm_output_0 : Float(1, 1536, strides=[1536, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.0/resnets.1/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.1.time_layer.weight, %inner_unet.inner_unet.up_blocks.0.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/resnets.1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Unsqueeze_output_0 : Float(1, 1536, 1, strides=[1536, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.1/Unsqueeze"](%/up_blocks.0/resnets.1/time_layer/Gemm_output_0, %/up_blocks.0/resnets.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Unsqueeze_1_output_0 : Float(1, 1536, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.1/Unsqueeze_1"](%/up_blocks.0/resnets.1/Unsqueeze_output_0, %/up_blocks.0/resnets.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.1/Shape"](%/up_blocks.0/resnets.1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/resnets.1/Gather"](%/up_blocks.0/resnets.1/Shape_output_0, %/up_blocks.0/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/resnets.1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/resnets.1/Add"](%/up_blocks.0/resnets.1/Gather_output_0, %/up_blocks.0/resnets.1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/resnets.1/Div"](%/up_blocks.0/resnets.1/Add_output_0, %/up_blocks.0/resnets.1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/Mul_1"](%/up_blocks.0/resnets.1/Div_output_0, %/up_blocks.0/resnets.1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Slice_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.1/Slice"](%/up_blocks.0/resnets.1/Unsqueeze_1_output_0, %/up_blocks.0/resnets.1/Constant_3_output_0, %/up_blocks.0/resnets.1/Mul_1_output_0, %/up_blocks.0/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/Mul_2"](%/up_blocks.0/resnets.1/Div_output_0, %/up_blocks.0/resnets.1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/Slice_1_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.1/Slice_1"](%/up_blocks.0/resnets.1/Unsqueeze_1_output_0, %/up_blocks.0/resnets.1/Mul_1_output_0, %/up_blocks.0/resnets.1/Mul_2_output_0, %/up_blocks.0/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.1/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm2/Reshape"](%/up_blocks.0/resnets.1/conv1/Conv_output_0, %/up_blocks.0/resnets.1/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.1/norm2/InstanceNormalization"](%/up_blocks.0/resnets.1/norm2/Reshape_output_0, %/up_blocks.0/resnets.1/norm2/Constant_1_output_0, %/up_blocks.0/resnets.1/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.1/norm2/Shape"](%/up_blocks.0/resnets.1/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm2/Reshape_1"](%/up_blocks.0/resnets.1/norm2/InstanceNormalization_output_0, %/up_blocks.0/resnets.1/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/norm2/Mul"](%/up_blocks.0/resnets.1/norm2/Reshape_1_output_0, %onnx::Mul_10066), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1/norm2/Add"](%/up_blocks.0/resnets.1/norm2/Mul_output_0, %onnx::Add_10067), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1/Add_1_output_0 : Float(1, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1/Add_1"](%/up_blocks.0/resnets.1/Slice_output_0, %/up_blocks.0/resnets.1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1/Mul_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/Mul_3"](%/up_blocks.0/resnets.1/norm2/Add_output_0, %/up_blocks.0/resnets.1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1/Add_2_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1/Add_2"](%/up_blocks.0/resnets.1/Mul_3_output_0, %/up_blocks.0/resnets.1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1/Sigmoid_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.1/Sigmoid_1"](%/up_blocks.0/resnets.1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1/Mul_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/Mul_4"](%/up_blocks.0/resnets.1/Add_2_output_0, %/up_blocks.0/resnets.1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1/conv2/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.1/conv2/Conv"](%/up_blocks.0/resnets.1/Mul_4_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.1.conv2.weight, %inner_unet.inner_unet.up_blocks.0.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.1/conv3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/resnets.1/conv3/Conv"](%/up_blocks.0/Concat_1_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.1.conv3.weight, %inner_unet.inner_unet.up_blocks.0.resnets.1.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.1/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1/Add_3"](%/up_blocks.0/resnets.1/conv2/Conv_output_0, %/up_blocks.0/resnets.1/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.0/attn.5/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.5/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/norm/Reshape"](%/up_blocks.0/resnets.1/Add_3_output_0, %/up_blocks.0/attn.5/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.5/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.5/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.5/norm/InstanceNormalization"](%/up_blocks.0/attn.5/norm/Reshape_output_0, %/up_blocks.0/attn.5/norm/Constant_1_output_0, %/up_blocks.0/attn.5/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.5/norm/Shape"](%/up_blocks.0/resnets.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/norm/Reshape_1"](%/up_blocks.0/attn.5/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.5/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/norm/Mul"](%/up_blocks.0/attn.5/norm/Reshape_1_output_0, %onnx::Mul_10068), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.5/norm/Add"](%/up_blocks.0/attn.5/norm/Mul_output_0, %onnx::Add_10069), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.5/qkv/Conv"](%/up_blocks.0/attn.5/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.5.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.5.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.5/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.5/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/Reshape"](%/up_blocks.0/attn.5/qkv/Conv_output_0, %/up_blocks.0/attn.5/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.5/Shape"](%/up_blocks.0/attn.5/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.5/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.5/Gather"](%/up_blocks.0/attn.5/Shape_output_0, %/up_blocks.0/attn.5/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.5/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.5/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.5/Add"](%/up_blocks.0/attn.5/Gather_output_0, %/up_blocks.0/attn.5/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.5/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.5/Div"](%/up_blocks.0/attn.5/Add_output_0, %/up_blocks.0/attn.5/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.5/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/Mul"](%/up_blocks.0/attn.5/Div_output_0, %/up_blocks.0/attn.5/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.5/Slice"](%/up_blocks.0/attn.5/Reshape_output_0, %/up_blocks.0/attn.5/Constant_2_output_0, %/up_blocks.0/attn.5/Mul_output_0, %/up_blocks.0/attn.5/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.5/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/Mul_1"](%/up_blocks.0/attn.5/Div_output_0, %/up_blocks.0/attn.5/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.5/Slice_1"](%/up_blocks.0/attn.5/Reshape_output_0, %/up_blocks.0/attn.5/Mul_output_0, %/up_blocks.0/attn.5/Mul_1_output_0, %/up_blocks.0/attn.5/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.5/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/Mul_2"](%/up_blocks.0/attn.5/Div_output_0, %/up_blocks.0/attn.5/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.5/Slice_2"](%/up_blocks.0/attn.5/Reshape_output_0, %/up_blocks.0/attn.5/Mul_1_output_0, %/up_blocks.0/attn.5/Mul_2_output_0, %/up_blocks.0/attn.5/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.5/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.5/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.5/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.5/Reciprocal"](%/up_blocks.0/attn.5/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.5/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/Mul_3"](%/up_blocks.0/attn.5/Slice_output_0, %/up_blocks.0/attn.5/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.5/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.5/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.5/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/Reshape_1"](%/up_blocks.0/attn.5/Mul_3_output_0, %/up_blocks.0/attn.5/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.5/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/Mul_4"](%/up_blocks.0/attn.5/Slice_1_output_0, %/up_blocks.0/attn.5/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.5/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.5/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.5/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.5/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.5/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.5/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.5/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.5/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.5/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/Reshape_2"](%/up_blocks.0/attn.5/Mul_4_output_0, %/up_blocks.0/attn.5/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.5/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.5/Einsum"](%/up_blocks.0/attn.5/Reshape_1_output_0, %/up_blocks.0/attn.5/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.5/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.5/Cast"](%/up_blocks.0/attn.5/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.5/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.5/Softmax"](%/up_blocks.0/attn.5/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.5/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.5/Cast_1"](%/up_blocks.0/attn.5/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.5/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/Reshape_3"](%/up_blocks.0/attn.5/Slice_2_output_0, %/up_blocks.0/attn.5/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.5/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.5/Einsum_1"](%/up_blocks.0/attn.5/Cast_1_output_0, %/up_blocks.0/attn.5/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.5/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.5/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.5/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.5/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.5/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/Reshape_4"](%/up_blocks.0/attn.5/Einsum_1_output_0, %/up_blocks.0/attn.5/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.5/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.5/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.5.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.5.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.5/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.5/kv_cond/MatMul"](%/up_blocks.0/attn.5/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10102), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.5/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.5/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.5.kv_cond.bias, %/up_blocks.0/attn.5/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.5/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.5/Transpose"](%/up_blocks.0/attn.5/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.5/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.5/Shape_1"](%/up_blocks.0/attn.5/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.5/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.5/Gather_1"](%/up_blocks.0/attn.5/Shape_1_output_0, %/up_blocks.0/attn.5/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.5/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.5/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.5/Add_1"](%/up_blocks.0/attn.5/Gather_1_output_0, %/up_blocks.0/attn.5/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.5/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.5/Div_1"](%/up_blocks.0/attn.5/Add_1_output_0, %/up_blocks.0/attn.5/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.5/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/Mul_5"](%/up_blocks.0/attn.5/Div_1_output_0, %/up_blocks.0/attn.5/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.5/Slice_3"](%/up_blocks.0/attn.5/Transpose_output_0, %/up_blocks.0/attn.5/Constant_17_output_0, %/up_blocks.0/attn.5/Mul_5_output_0, %/up_blocks.0/attn.5/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.5/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/Mul_6"](%/up_blocks.0/attn.5/Div_1_output_0, %/up_blocks.0/attn.5/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.5/Slice_4"](%/up_blocks.0/attn.5/Transpose_output_0, %/up_blocks.0/attn.5/Mul_5_output_0, %/up_blocks.0/attn.5/Mul_6_output_0, %/up_blocks.0/attn.5/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.5/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/Mul_7"](%/up_blocks.0/attn.5/Slice_3_output_0, %/up_blocks.0/attn.5/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.5/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/Reshape_5"](%/up_blocks.0/attn.5/Mul_7_output_0, %/up_blocks.0/attn.5/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.5/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.5/Einsum_2"](%/up_blocks.0/attn.5/Reshape_1_output_0, %/up_blocks.0/attn.5/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.5/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.5/Cast_2"](%/up_blocks.0/attn.5/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.5/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.5/Softmax_1"](%/up_blocks.0/attn.5/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.5/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.5/Cast_3"](%/up_blocks.0/attn.5/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.5/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/Reshape_6"](%/up_blocks.0/attn.5/Slice_4_output_0, %/up_blocks.0/attn.5/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.5/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.5/Einsum_3"](%/up_blocks.0/attn.5/Cast_3_output_0, %/up_blocks.0/attn.5/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.5/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/Reshape_7"](%/up_blocks.0/attn.5/Einsum_3_output_0, %/up_blocks.0/attn.5/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.5/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.5/Add_2"](%/up_blocks.0/attn.5/Reshape_4_output_0, %/up_blocks.0/attn.5/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.5/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.5/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.5/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/Reshape_8"](%/up_blocks.0/attn.5/Add_2_output_0, %/up_blocks.0/attn.5/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.5/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.5/proj_out/Conv"](%/up_blocks.0/attn.5/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.5.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.5.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.5/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.5/Add_3"](%/up_blocks.0/resnets.1/Add_3_output_0, %/up_blocks.0/attn.5/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.5/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.5/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.5/Add_3_output_0, %/up_blocks.0/attn.5/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.5/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.5/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.5/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.5/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.5/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.5/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.5/ffn/ffn.0/Shape"](%/up_blocks.0/attn.5/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.5/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.5/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.5/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/ffn/ffn.0/Mul"](%/up_blocks.0/attn.5/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10108), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.5/ffn/ffn.0/Add"](%/up_blocks.0/attn.5/ffn/ffn.0/Mul_output_0, %onnx::Add_10109), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.5/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.5/ffn/ffn.1/Conv"](%/up_blocks.0/attn.5/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.5.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.5.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.5/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.5/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.5/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.5/ffn/ffn.2/Div"](%/up_blocks.0/attn.5/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.5/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.5/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.5/ffn/ffn.2/Erf"](%/up_blocks.0/attn.5/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.5/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.5/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.5/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.5/ffn/ffn.2/Add"](%/up_blocks.0/attn.5/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.5/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.5/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/ffn/ffn.2/Mul"](%/up_blocks.0/attn.5/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.5/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.5/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.5/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.5/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.5/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.5/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.5/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.5/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.5/ffn/ffn.3/Conv"](%/up_blocks.0/attn.5/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.5.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.5.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.5/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.5/Add_4"](%/up_blocks.0/attn.5/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.5/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.5 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.6/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.6/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/norm/Reshape"](%/up_blocks.0/attn.5/Add_4_output_0, %/up_blocks.0/attn.6/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.6/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.6/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.6/norm/InstanceNormalization"](%/up_blocks.0/attn.6/norm/Reshape_output_0, %/up_blocks.0/attn.6/norm/Constant_1_output_0, %/up_blocks.0/attn.6/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.6/norm/Shape"](%/up_blocks.0/attn.5/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/norm/Reshape_1"](%/up_blocks.0/attn.6/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.6/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/norm/Mul"](%/up_blocks.0/attn.6/norm/Reshape_1_output_0, %onnx::Mul_10110), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.6/norm/Add"](%/up_blocks.0/attn.6/norm/Mul_output_0, %onnx::Add_10111), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.6/qkv/Conv"](%/up_blocks.0/attn.6/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.6.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.6.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.6/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.6/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/Reshape"](%/up_blocks.0/attn.6/qkv/Conv_output_0, %/up_blocks.0/attn.6/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.6/Shape"](%/up_blocks.0/attn.6/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.6/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.6/Gather"](%/up_blocks.0/attn.6/Shape_output_0, %/up_blocks.0/attn.6/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.6/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.6/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.6/Add"](%/up_blocks.0/attn.6/Gather_output_0, %/up_blocks.0/attn.6/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.6/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.6/Div"](%/up_blocks.0/attn.6/Add_output_0, %/up_blocks.0/attn.6/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.6/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/Mul"](%/up_blocks.0/attn.6/Div_output_0, %/up_blocks.0/attn.6/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.6/Slice"](%/up_blocks.0/attn.6/Reshape_output_0, %/up_blocks.0/attn.6/Constant_2_output_0, %/up_blocks.0/attn.6/Mul_output_0, %/up_blocks.0/attn.6/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.6/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/Mul_1"](%/up_blocks.0/attn.6/Div_output_0, %/up_blocks.0/attn.6/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.6/Slice_1"](%/up_blocks.0/attn.6/Reshape_output_0, %/up_blocks.0/attn.6/Mul_output_0, %/up_blocks.0/attn.6/Mul_1_output_0, %/up_blocks.0/attn.6/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.6/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/Mul_2"](%/up_blocks.0/attn.6/Div_output_0, %/up_blocks.0/attn.6/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.6/Slice_2"](%/up_blocks.0/attn.6/Reshape_output_0, %/up_blocks.0/attn.6/Mul_1_output_0, %/up_blocks.0/attn.6/Mul_2_output_0, %/up_blocks.0/attn.6/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.6/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.6/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.6/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.6/Reciprocal"](%/up_blocks.0/attn.6/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.6/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/Mul_3"](%/up_blocks.0/attn.6/Slice_output_0, %/up_blocks.0/attn.6/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.6/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.6/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.6/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/Reshape_1"](%/up_blocks.0/attn.6/Mul_3_output_0, %/up_blocks.0/attn.6/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.6/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/Mul_4"](%/up_blocks.0/attn.6/Slice_1_output_0, %/up_blocks.0/attn.6/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.6/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.6/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.6/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.6/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.6/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.6/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.6/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.6/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.6/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/Reshape_2"](%/up_blocks.0/attn.6/Mul_4_output_0, %/up_blocks.0/attn.6/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.6/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.6/Einsum"](%/up_blocks.0/attn.6/Reshape_1_output_0, %/up_blocks.0/attn.6/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.6/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.6/Cast"](%/up_blocks.0/attn.6/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.6/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.6/Softmax"](%/up_blocks.0/attn.6/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.6/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.6/Cast_1"](%/up_blocks.0/attn.6/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.6/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/Reshape_3"](%/up_blocks.0/attn.6/Slice_2_output_0, %/up_blocks.0/attn.6/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.6/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.6/Einsum_1"](%/up_blocks.0/attn.6/Cast_1_output_0, %/up_blocks.0/attn.6/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.6/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.6/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.6/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.6/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.6/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/Reshape_4"](%/up_blocks.0/attn.6/Einsum_1_output_0, %/up_blocks.0/attn.6/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.6/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.6/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.6.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.6.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.6/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.6/kv_cond/MatMul"](%/up_blocks.0/attn.6/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10144), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.6/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.6/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.6.kv_cond.bias, %/up_blocks.0/attn.6/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.6/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.6/Transpose"](%/up_blocks.0/attn.6/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.6/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.6/Shape_1"](%/up_blocks.0/attn.6/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.6/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.6/Gather_1"](%/up_blocks.0/attn.6/Shape_1_output_0, %/up_blocks.0/attn.6/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.6/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.6/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.6/Add_1"](%/up_blocks.0/attn.6/Gather_1_output_0, %/up_blocks.0/attn.6/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.6/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.6/Div_1"](%/up_blocks.0/attn.6/Add_1_output_0, %/up_blocks.0/attn.6/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.6/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/Mul_5"](%/up_blocks.0/attn.6/Div_1_output_0, %/up_blocks.0/attn.6/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.6/Slice_3"](%/up_blocks.0/attn.6/Transpose_output_0, %/up_blocks.0/attn.6/Constant_17_output_0, %/up_blocks.0/attn.6/Mul_5_output_0, %/up_blocks.0/attn.6/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.6/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/Mul_6"](%/up_blocks.0/attn.6/Div_1_output_0, %/up_blocks.0/attn.6/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.6/Slice_4"](%/up_blocks.0/attn.6/Transpose_output_0, %/up_blocks.0/attn.6/Mul_5_output_0, %/up_blocks.0/attn.6/Mul_6_output_0, %/up_blocks.0/attn.6/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.6/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/Mul_7"](%/up_blocks.0/attn.6/Slice_3_output_0, %/up_blocks.0/attn.6/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.6/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/Reshape_5"](%/up_blocks.0/attn.6/Mul_7_output_0, %/up_blocks.0/attn.6/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.6/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.6/Einsum_2"](%/up_blocks.0/attn.6/Reshape_1_output_0, %/up_blocks.0/attn.6/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.6/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.6/Cast_2"](%/up_blocks.0/attn.6/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.6/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.6/Softmax_1"](%/up_blocks.0/attn.6/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.6/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.6/Cast_3"](%/up_blocks.0/attn.6/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.6/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/Reshape_6"](%/up_blocks.0/attn.6/Slice_4_output_0, %/up_blocks.0/attn.6/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.6/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.6/Einsum_3"](%/up_blocks.0/attn.6/Cast_3_output_0, %/up_blocks.0/attn.6/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.6/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/Reshape_7"](%/up_blocks.0/attn.6/Einsum_3_output_0, %/up_blocks.0/attn.6/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.6/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.6/Add_2"](%/up_blocks.0/attn.6/Reshape_4_output_0, %/up_blocks.0/attn.6/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.6/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.6/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.6/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/Reshape_8"](%/up_blocks.0/attn.6/Add_2_output_0, %/up_blocks.0/attn.6/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.6/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.6/proj_out/Conv"](%/up_blocks.0/attn.6/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.6.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.6.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.6/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.6/Add_3"](%/up_blocks.0/attn.5/Add_4_output_0, %/up_blocks.0/attn.6/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.6/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.6/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.6/Add_3_output_0, %/up_blocks.0/attn.6/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.6/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.6/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.6/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.6/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.6/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.6/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.6/ffn/ffn.0/Shape"](%/up_blocks.0/attn.6/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.6/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.6/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.6/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/ffn/ffn.0/Mul"](%/up_blocks.0/attn.6/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10150), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.6/ffn/ffn.0/Add"](%/up_blocks.0/attn.6/ffn/ffn.0/Mul_output_0, %onnx::Add_10151), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.6/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.6/ffn/ffn.1/Conv"](%/up_blocks.0/attn.6/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.6.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.6.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.6/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.6/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.6/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.6/ffn/ffn.2/Div"](%/up_blocks.0/attn.6/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.6/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.6/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.6/ffn/ffn.2/Erf"](%/up_blocks.0/attn.6/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.6/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.6/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.6/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.6/ffn/ffn.2/Add"](%/up_blocks.0/attn.6/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.6/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.6/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/ffn/ffn.2/Mul"](%/up_blocks.0/attn.6/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.6/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.6/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.6/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.6/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.6/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.6/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.6/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.6/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.6/ffn/ffn.3/Conv"](%/up_blocks.0/attn.6/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.6.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.6.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.6/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.6/Add_4"](%/up_blocks.0/attn.6/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.6/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.6 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.7/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.7/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/norm/Reshape"](%/up_blocks.0/attn.6/Add_4_output_0, %/up_blocks.0/attn.7/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.7/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.7/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.7/norm/InstanceNormalization"](%/up_blocks.0/attn.7/norm/Reshape_output_0, %/up_blocks.0/attn.7/norm/Constant_1_output_0, %/up_blocks.0/attn.7/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.7/norm/Shape"](%/up_blocks.0/attn.6/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/norm/Reshape_1"](%/up_blocks.0/attn.7/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.7/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/norm/Mul"](%/up_blocks.0/attn.7/norm/Reshape_1_output_0, %onnx::Mul_10152), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.7/norm/Add"](%/up_blocks.0/attn.7/norm/Mul_output_0, %onnx::Add_10153), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.7/qkv/Conv"](%/up_blocks.0/attn.7/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.7.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.7.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.7/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.7/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/Reshape"](%/up_blocks.0/attn.7/qkv/Conv_output_0, %/up_blocks.0/attn.7/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.7/Shape"](%/up_blocks.0/attn.7/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.7/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.7/Gather"](%/up_blocks.0/attn.7/Shape_output_0, %/up_blocks.0/attn.7/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.7/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.7/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.7/Add"](%/up_blocks.0/attn.7/Gather_output_0, %/up_blocks.0/attn.7/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.7/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.7/Div"](%/up_blocks.0/attn.7/Add_output_0, %/up_blocks.0/attn.7/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.7/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/Mul"](%/up_blocks.0/attn.7/Div_output_0, %/up_blocks.0/attn.7/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.7/Slice"](%/up_blocks.0/attn.7/Reshape_output_0, %/up_blocks.0/attn.7/Constant_2_output_0, %/up_blocks.0/attn.7/Mul_output_0, %/up_blocks.0/attn.7/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.7/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/Mul_1"](%/up_blocks.0/attn.7/Div_output_0, %/up_blocks.0/attn.7/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.7/Slice_1"](%/up_blocks.0/attn.7/Reshape_output_0, %/up_blocks.0/attn.7/Mul_output_0, %/up_blocks.0/attn.7/Mul_1_output_0, %/up_blocks.0/attn.7/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.7/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/Mul_2"](%/up_blocks.0/attn.7/Div_output_0, %/up_blocks.0/attn.7/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.7/Slice_2"](%/up_blocks.0/attn.7/Reshape_output_0, %/up_blocks.0/attn.7/Mul_1_output_0, %/up_blocks.0/attn.7/Mul_2_output_0, %/up_blocks.0/attn.7/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.7/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.7/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.7/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.7/Reciprocal"](%/up_blocks.0/attn.7/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.7/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/Mul_3"](%/up_blocks.0/attn.7/Slice_output_0, %/up_blocks.0/attn.7/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.7/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.7/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.7/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/Reshape_1"](%/up_blocks.0/attn.7/Mul_3_output_0, %/up_blocks.0/attn.7/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.7/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/Mul_4"](%/up_blocks.0/attn.7/Slice_1_output_0, %/up_blocks.0/attn.7/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.7/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.7/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.7/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.7/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.7/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.7/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.7/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.7/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.7/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/Reshape_2"](%/up_blocks.0/attn.7/Mul_4_output_0, %/up_blocks.0/attn.7/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.7/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.7/Einsum"](%/up_blocks.0/attn.7/Reshape_1_output_0, %/up_blocks.0/attn.7/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.7/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.7/Cast"](%/up_blocks.0/attn.7/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.7/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.7/Softmax"](%/up_blocks.0/attn.7/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.7/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.7/Cast_1"](%/up_blocks.0/attn.7/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.7/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/Reshape_3"](%/up_blocks.0/attn.7/Slice_2_output_0, %/up_blocks.0/attn.7/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.7/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.7/Einsum_1"](%/up_blocks.0/attn.7/Cast_1_output_0, %/up_blocks.0/attn.7/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.7/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.7/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.7/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.7/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.7/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/Reshape_4"](%/up_blocks.0/attn.7/Einsum_1_output_0, %/up_blocks.0/attn.7/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.7/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.7/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.7.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.7.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.7/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.7/kv_cond/MatMul"](%/up_blocks.0/attn.7/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10186), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.7/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.7/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.7.kv_cond.bias, %/up_blocks.0/attn.7/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.7/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.7/Transpose"](%/up_blocks.0/attn.7/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.7/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.7/Shape_1"](%/up_blocks.0/attn.7/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.7/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.7/Gather_1"](%/up_blocks.0/attn.7/Shape_1_output_0, %/up_blocks.0/attn.7/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.7/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.7/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.7/Add_1"](%/up_blocks.0/attn.7/Gather_1_output_0, %/up_blocks.0/attn.7/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.7/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.7/Div_1"](%/up_blocks.0/attn.7/Add_1_output_0, %/up_blocks.0/attn.7/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.7/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/Mul_5"](%/up_blocks.0/attn.7/Div_1_output_0, %/up_blocks.0/attn.7/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.7/Slice_3"](%/up_blocks.0/attn.7/Transpose_output_0, %/up_blocks.0/attn.7/Constant_17_output_0, %/up_blocks.0/attn.7/Mul_5_output_0, %/up_blocks.0/attn.7/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.7/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/Mul_6"](%/up_blocks.0/attn.7/Div_1_output_0, %/up_blocks.0/attn.7/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.7/Slice_4"](%/up_blocks.0/attn.7/Transpose_output_0, %/up_blocks.0/attn.7/Mul_5_output_0, %/up_blocks.0/attn.7/Mul_6_output_0, %/up_blocks.0/attn.7/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.7/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/Mul_7"](%/up_blocks.0/attn.7/Slice_3_output_0, %/up_blocks.0/attn.7/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.7/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/Reshape_5"](%/up_blocks.0/attn.7/Mul_7_output_0, %/up_blocks.0/attn.7/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.7/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.7/Einsum_2"](%/up_blocks.0/attn.7/Reshape_1_output_0, %/up_blocks.0/attn.7/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.7/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.7/Cast_2"](%/up_blocks.0/attn.7/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.7/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.7/Softmax_1"](%/up_blocks.0/attn.7/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.7/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.7/Cast_3"](%/up_blocks.0/attn.7/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.7/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/Reshape_6"](%/up_blocks.0/attn.7/Slice_4_output_0, %/up_blocks.0/attn.7/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.7/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.7/Einsum_3"](%/up_blocks.0/attn.7/Cast_3_output_0, %/up_blocks.0/attn.7/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.7/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/Reshape_7"](%/up_blocks.0/attn.7/Einsum_3_output_0, %/up_blocks.0/attn.7/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.7/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.7/Add_2"](%/up_blocks.0/attn.7/Reshape_4_output_0, %/up_blocks.0/attn.7/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.7/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.7/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.7/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/Reshape_8"](%/up_blocks.0/attn.7/Add_2_output_0, %/up_blocks.0/attn.7/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.7/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.7/proj_out/Conv"](%/up_blocks.0/attn.7/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.7.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.7.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.7/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.7/Add_3"](%/up_blocks.0/attn.6/Add_4_output_0, %/up_blocks.0/attn.7/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.7/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.7/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.7/Add_3_output_0, %/up_blocks.0/attn.7/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.7/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.7/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.7/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.7/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.7/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.7/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.7/ffn/ffn.0/Shape"](%/up_blocks.0/attn.7/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.7/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.7/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.7/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/ffn/ffn.0/Mul"](%/up_blocks.0/attn.7/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10192), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.7/ffn/ffn.0/Add"](%/up_blocks.0/attn.7/ffn/ffn.0/Mul_output_0, %onnx::Add_10193), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.7/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.7/ffn/ffn.1/Conv"](%/up_blocks.0/attn.7/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.7.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.7.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.7/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.7/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.7/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.7/ffn/ffn.2/Div"](%/up_blocks.0/attn.7/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.7/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.7/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.7/ffn/ffn.2/Erf"](%/up_blocks.0/attn.7/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.7/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.7/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.7/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.7/ffn/ffn.2/Add"](%/up_blocks.0/attn.7/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.7/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.7/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/ffn/ffn.2/Mul"](%/up_blocks.0/attn.7/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.7/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.7/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.7/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.7/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.7/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.7/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.7/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.7/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.7/ffn/ffn.3/Conv"](%/up_blocks.0/attn.7/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.7.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.7.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.7/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.7/Add_4"](%/up_blocks.0/attn.7/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.7/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.7 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.8/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.8/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/norm/Reshape"](%/up_blocks.0/attn.7/Add_4_output_0, %/up_blocks.0/attn.8/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.8/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.8/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.8/norm/InstanceNormalization"](%/up_blocks.0/attn.8/norm/Reshape_output_0, %/up_blocks.0/attn.8/norm/Constant_1_output_0, %/up_blocks.0/attn.8/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.8/norm/Shape"](%/up_blocks.0/attn.7/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/norm/Reshape_1"](%/up_blocks.0/attn.8/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.8/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/norm/Mul"](%/up_blocks.0/attn.8/norm/Reshape_1_output_0, %onnx::Mul_10194), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.8/norm/Add"](%/up_blocks.0/attn.8/norm/Mul_output_0, %onnx::Add_10195), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.8/qkv/Conv"](%/up_blocks.0/attn.8/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.8.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.8.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.8/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.8/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/Reshape"](%/up_blocks.0/attn.8/qkv/Conv_output_0, %/up_blocks.0/attn.8/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.8/Shape"](%/up_blocks.0/attn.8/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.8/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.8/Gather"](%/up_blocks.0/attn.8/Shape_output_0, %/up_blocks.0/attn.8/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.8/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.8/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.8/Add"](%/up_blocks.0/attn.8/Gather_output_0, %/up_blocks.0/attn.8/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.8/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.8/Div"](%/up_blocks.0/attn.8/Add_output_0, %/up_blocks.0/attn.8/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.8/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/Mul"](%/up_blocks.0/attn.8/Div_output_0, %/up_blocks.0/attn.8/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.8/Slice"](%/up_blocks.0/attn.8/Reshape_output_0, %/up_blocks.0/attn.8/Constant_2_output_0, %/up_blocks.0/attn.8/Mul_output_0, %/up_blocks.0/attn.8/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.8/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/Mul_1"](%/up_blocks.0/attn.8/Div_output_0, %/up_blocks.0/attn.8/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.8/Slice_1"](%/up_blocks.0/attn.8/Reshape_output_0, %/up_blocks.0/attn.8/Mul_output_0, %/up_blocks.0/attn.8/Mul_1_output_0, %/up_blocks.0/attn.8/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.8/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/Mul_2"](%/up_blocks.0/attn.8/Div_output_0, %/up_blocks.0/attn.8/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.8/Slice_2"](%/up_blocks.0/attn.8/Reshape_output_0, %/up_blocks.0/attn.8/Mul_1_output_0, %/up_blocks.0/attn.8/Mul_2_output_0, %/up_blocks.0/attn.8/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.8/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.8/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.8/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.8/Reciprocal"](%/up_blocks.0/attn.8/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.8/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/Mul_3"](%/up_blocks.0/attn.8/Slice_output_0, %/up_blocks.0/attn.8/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.8/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.8/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.8/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/Reshape_1"](%/up_blocks.0/attn.8/Mul_3_output_0, %/up_blocks.0/attn.8/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.8/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/Mul_4"](%/up_blocks.0/attn.8/Slice_1_output_0, %/up_blocks.0/attn.8/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.8/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.8/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.8/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.8/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.8/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.8/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.8/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.8/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.8/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/Reshape_2"](%/up_blocks.0/attn.8/Mul_4_output_0, %/up_blocks.0/attn.8/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.8/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.8/Einsum"](%/up_blocks.0/attn.8/Reshape_1_output_0, %/up_blocks.0/attn.8/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.8/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.8/Cast"](%/up_blocks.0/attn.8/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.8/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.8/Softmax"](%/up_blocks.0/attn.8/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.8/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.8/Cast_1"](%/up_blocks.0/attn.8/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.8/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/Reshape_3"](%/up_blocks.0/attn.8/Slice_2_output_0, %/up_blocks.0/attn.8/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.8/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.8/Einsum_1"](%/up_blocks.0/attn.8/Cast_1_output_0, %/up_blocks.0/attn.8/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.8/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.8/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.8/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.8/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.8/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/Reshape_4"](%/up_blocks.0/attn.8/Einsum_1_output_0, %/up_blocks.0/attn.8/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.8/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.8/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.8.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.8.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.8/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.8/kv_cond/MatMul"](%/up_blocks.0/attn.8/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10228), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.8/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.8/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.8.kv_cond.bias, %/up_blocks.0/attn.8/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.8/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.8/Transpose"](%/up_blocks.0/attn.8/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.8/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.8/Shape_1"](%/up_blocks.0/attn.8/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.8/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.8/Gather_1"](%/up_blocks.0/attn.8/Shape_1_output_0, %/up_blocks.0/attn.8/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.8/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.8/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.8/Add_1"](%/up_blocks.0/attn.8/Gather_1_output_0, %/up_blocks.0/attn.8/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.8/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.8/Div_1"](%/up_blocks.0/attn.8/Add_1_output_0, %/up_blocks.0/attn.8/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.8/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/Mul_5"](%/up_blocks.0/attn.8/Div_1_output_0, %/up_blocks.0/attn.8/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.8/Slice_3"](%/up_blocks.0/attn.8/Transpose_output_0, %/up_blocks.0/attn.8/Constant_17_output_0, %/up_blocks.0/attn.8/Mul_5_output_0, %/up_blocks.0/attn.8/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.8/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/Mul_6"](%/up_blocks.0/attn.8/Div_1_output_0, %/up_blocks.0/attn.8/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.8/Slice_4"](%/up_blocks.0/attn.8/Transpose_output_0, %/up_blocks.0/attn.8/Mul_5_output_0, %/up_blocks.0/attn.8/Mul_6_output_0, %/up_blocks.0/attn.8/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.8/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/Mul_7"](%/up_blocks.0/attn.8/Slice_3_output_0, %/up_blocks.0/attn.8/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.8/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/Reshape_5"](%/up_blocks.0/attn.8/Mul_7_output_0, %/up_blocks.0/attn.8/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.8/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.8/Einsum_2"](%/up_blocks.0/attn.8/Reshape_1_output_0, %/up_blocks.0/attn.8/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.8/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.8/Cast_2"](%/up_blocks.0/attn.8/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.8/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.8/Softmax_1"](%/up_blocks.0/attn.8/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.8/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.8/Cast_3"](%/up_blocks.0/attn.8/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.8/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/Reshape_6"](%/up_blocks.0/attn.8/Slice_4_output_0, %/up_blocks.0/attn.8/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.8/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.8/Einsum_3"](%/up_blocks.0/attn.8/Cast_3_output_0, %/up_blocks.0/attn.8/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.8/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/Reshape_7"](%/up_blocks.0/attn.8/Einsum_3_output_0, %/up_blocks.0/attn.8/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.8/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.8/Add_2"](%/up_blocks.0/attn.8/Reshape_4_output_0, %/up_blocks.0/attn.8/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.8/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.8/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.8/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/Reshape_8"](%/up_blocks.0/attn.8/Add_2_output_0, %/up_blocks.0/attn.8/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.8/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.8/proj_out/Conv"](%/up_blocks.0/attn.8/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.8.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.8.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.8/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.8/Add_3"](%/up_blocks.0/attn.7/Add_4_output_0, %/up_blocks.0/attn.8/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.8/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.8/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.8/Add_3_output_0, %/up_blocks.0/attn.8/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.8/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.8/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.8/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.8/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.8/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.8/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.8/ffn/ffn.0/Shape"](%/up_blocks.0/attn.8/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.8/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.8/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.8/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/ffn/ffn.0/Mul"](%/up_blocks.0/attn.8/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10234), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.8/ffn/ffn.0/Add"](%/up_blocks.0/attn.8/ffn/ffn.0/Mul_output_0, %onnx::Add_10235), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.8/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.8/ffn/ffn.1/Conv"](%/up_blocks.0/attn.8/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.8.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.8.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.8/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.8/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.8/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.8/ffn/ffn.2/Div"](%/up_blocks.0/attn.8/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.8/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.8/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.8/ffn/ffn.2/Erf"](%/up_blocks.0/attn.8/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.8/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.8/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.8/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.8/ffn/ffn.2/Add"](%/up_blocks.0/attn.8/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.8/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.8/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/ffn/ffn.2/Mul"](%/up_blocks.0/attn.8/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.8/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.8/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.8/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.8/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.8/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.8/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.8/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.8/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.8/ffn/ffn.3/Conv"](%/up_blocks.0/attn.8/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.8.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.8.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.8/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.8/Add_4"](%/up_blocks.0/attn.8/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.8/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.8 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.9/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.9/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/norm/Reshape"](%/up_blocks.0/attn.8/Add_4_output_0, %/up_blocks.0/attn.9/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.9/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.9/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.9/norm/InstanceNormalization"](%/up_blocks.0/attn.9/norm/Reshape_output_0, %/up_blocks.0/attn.9/norm/Constant_1_output_0, %/up_blocks.0/attn.9/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.9/norm/Shape"](%/up_blocks.0/attn.8/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/norm/Reshape_1"](%/up_blocks.0/attn.9/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.9/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/norm/Mul"](%/up_blocks.0/attn.9/norm/Reshape_1_output_0, %onnx::Mul_10236), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.9/norm/Add"](%/up_blocks.0/attn.9/norm/Mul_output_0, %onnx::Add_10237), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.9/qkv/Conv"](%/up_blocks.0/attn.9/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.9.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.9.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.9/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.9/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/Reshape"](%/up_blocks.0/attn.9/qkv/Conv_output_0, %/up_blocks.0/attn.9/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.9/Shape"](%/up_blocks.0/attn.9/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.9/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.9/Gather"](%/up_blocks.0/attn.9/Shape_output_0, %/up_blocks.0/attn.9/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.9/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.9/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.9/Add"](%/up_blocks.0/attn.9/Gather_output_0, %/up_blocks.0/attn.9/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.9/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.9/Div"](%/up_blocks.0/attn.9/Add_output_0, %/up_blocks.0/attn.9/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.9/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/Mul"](%/up_blocks.0/attn.9/Div_output_0, %/up_blocks.0/attn.9/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.9/Slice"](%/up_blocks.0/attn.9/Reshape_output_0, %/up_blocks.0/attn.9/Constant_2_output_0, %/up_blocks.0/attn.9/Mul_output_0, %/up_blocks.0/attn.9/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.9/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/Mul_1"](%/up_blocks.0/attn.9/Div_output_0, %/up_blocks.0/attn.9/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.9/Slice_1"](%/up_blocks.0/attn.9/Reshape_output_0, %/up_blocks.0/attn.9/Mul_output_0, %/up_blocks.0/attn.9/Mul_1_output_0, %/up_blocks.0/attn.9/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.9/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/Mul_2"](%/up_blocks.0/attn.9/Div_output_0, %/up_blocks.0/attn.9/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.9/Slice_2"](%/up_blocks.0/attn.9/Reshape_output_0, %/up_blocks.0/attn.9/Mul_1_output_0, %/up_blocks.0/attn.9/Mul_2_output_0, %/up_blocks.0/attn.9/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.9/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.9/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.9/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.9/Reciprocal"](%/up_blocks.0/attn.9/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.9/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/Mul_3"](%/up_blocks.0/attn.9/Slice_output_0, %/up_blocks.0/attn.9/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.9/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.9/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.9/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/Reshape_1"](%/up_blocks.0/attn.9/Mul_3_output_0, %/up_blocks.0/attn.9/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.9/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/Mul_4"](%/up_blocks.0/attn.9/Slice_1_output_0, %/up_blocks.0/attn.9/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.9/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.9/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.9/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.9/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.9/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.9/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.9/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.9/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.9/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/Reshape_2"](%/up_blocks.0/attn.9/Mul_4_output_0, %/up_blocks.0/attn.9/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.9/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.9/Einsum"](%/up_blocks.0/attn.9/Reshape_1_output_0, %/up_blocks.0/attn.9/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.9/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.9/Cast"](%/up_blocks.0/attn.9/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.9/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.9/Softmax"](%/up_blocks.0/attn.9/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.9/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.9/Cast_1"](%/up_blocks.0/attn.9/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.9/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/Reshape_3"](%/up_blocks.0/attn.9/Slice_2_output_0, %/up_blocks.0/attn.9/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.9/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.9/Einsum_1"](%/up_blocks.0/attn.9/Cast_1_output_0, %/up_blocks.0/attn.9/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.9/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.9/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.9/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.9/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.9/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/Reshape_4"](%/up_blocks.0/attn.9/Einsum_1_output_0, %/up_blocks.0/attn.9/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.9/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.9/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.9.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.9.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.9/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.9/kv_cond/MatMul"](%/up_blocks.0/attn.9/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10270), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.9/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.9/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.9.kv_cond.bias, %/up_blocks.0/attn.9/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.9/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.9/Transpose"](%/up_blocks.0/attn.9/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.9/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.9/Shape_1"](%/up_blocks.0/attn.9/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.9/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.9/Gather_1"](%/up_blocks.0/attn.9/Shape_1_output_0, %/up_blocks.0/attn.9/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.9/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.9/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.9/Add_1"](%/up_blocks.0/attn.9/Gather_1_output_0, %/up_blocks.0/attn.9/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.9/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.9/Div_1"](%/up_blocks.0/attn.9/Add_1_output_0, %/up_blocks.0/attn.9/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.9/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/Mul_5"](%/up_blocks.0/attn.9/Div_1_output_0, %/up_blocks.0/attn.9/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.9/Slice_3"](%/up_blocks.0/attn.9/Transpose_output_0, %/up_blocks.0/attn.9/Constant_17_output_0, %/up_blocks.0/attn.9/Mul_5_output_0, %/up_blocks.0/attn.9/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.9/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/Mul_6"](%/up_blocks.0/attn.9/Div_1_output_0, %/up_blocks.0/attn.9/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.9/Slice_4"](%/up_blocks.0/attn.9/Transpose_output_0, %/up_blocks.0/attn.9/Mul_5_output_0, %/up_blocks.0/attn.9/Mul_6_output_0, %/up_blocks.0/attn.9/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.9/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/Mul_7"](%/up_blocks.0/attn.9/Slice_3_output_0, %/up_blocks.0/attn.9/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.9/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/Reshape_5"](%/up_blocks.0/attn.9/Mul_7_output_0, %/up_blocks.0/attn.9/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.9/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.9/Einsum_2"](%/up_blocks.0/attn.9/Reshape_1_output_0, %/up_blocks.0/attn.9/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.9/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.9/Cast_2"](%/up_blocks.0/attn.9/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.9/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.9/Softmax_1"](%/up_blocks.0/attn.9/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.9/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.9/Cast_3"](%/up_blocks.0/attn.9/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.9/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/Reshape_6"](%/up_blocks.0/attn.9/Slice_4_output_0, %/up_blocks.0/attn.9/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.9/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.9/Einsum_3"](%/up_blocks.0/attn.9/Cast_3_output_0, %/up_blocks.0/attn.9/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.9/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/Reshape_7"](%/up_blocks.0/attn.9/Einsum_3_output_0, %/up_blocks.0/attn.9/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.9/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.9/Add_2"](%/up_blocks.0/attn.9/Reshape_4_output_0, %/up_blocks.0/attn.9/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.9/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.9/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.9/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/Reshape_8"](%/up_blocks.0/attn.9/Add_2_output_0, %/up_blocks.0/attn.9/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.9/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.9/proj_out/Conv"](%/up_blocks.0/attn.9/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.9.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.9.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.9/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.9/Add_3"](%/up_blocks.0/attn.8/Add_4_output_0, %/up_blocks.0/attn.9/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.9/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.9/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.9/Add_3_output_0, %/up_blocks.0/attn.9/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.9/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.9/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.9/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.9/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.9/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.9/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.9/ffn/ffn.0/Shape"](%/up_blocks.0/attn.9/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.9/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.9/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.9/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/ffn/ffn.0/Mul"](%/up_blocks.0/attn.9/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10276), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.9/ffn/ffn.0/Add"](%/up_blocks.0/attn.9/ffn/ffn.0/Mul_output_0, %onnx::Add_10277), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.9/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.9/ffn/ffn.1/Conv"](%/up_blocks.0/attn.9/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.9.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.9.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.9/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.9/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.9/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.9/ffn/ffn.2/Div"](%/up_blocks.0/attn.9/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.9/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.9/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.9/ffn/ffn.2/Erf"](%/up_blocks.0/attn.9/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.9/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.9/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.9/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.9/ffn/ffn.2/Add"](%/up_blocks.0/attn.9/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.9/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.9/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/ffn/ffn.2/Mul"](%/up_blocks.0/attn.9/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.9/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.9/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.9/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.9/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.9/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.9/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.9/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.9/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.9/ffn/ffn.3/Conv"](%/up_blocks.0/attn.9/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.9.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.9.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.9/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.9/Add_4"](%/up_blocks.0/attn.9/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.9/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.9 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/Concat_2_output_0 : Float(1, 1280, 2, 1, strides=[2560, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.0/Concat_2"](%/up_blocks.0/attn.9/Add_4_output_0, %/down_blocks.1/resample_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.0/resnets.2/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.2/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm1/Reshape_output_0 : Float(1, 32, 80, strides=[2560, 80, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.2/norm1/Reshape"](%/up_blocks.0/Concat_2_output_0, %/up_blocks.0/resnets.2/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.2/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.2/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm1/InstanceNormalization_output_0 : Float(1, 32, 80, strides=[2560, 80, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.2/norm1/InstanceNormalization"](%/up_blocks.0/resnets.2/norm1/Reshape_output_0, %/up_blocks.0/resnets.2/norm1/Constant_1_output_0, %/up_blocks.0/resnets.2/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.2/norm1/Shape"](%/up_blocks.0/Concat_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm1/Reshape_1_output_0 : Float(1, 1280, 2, 1, strides=[2560, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.2/norm1/Reshape_1"](%/up_blocks.0/resnets.2/norm1/InstanceNormalization_output_0, %/up_blocks.0/resnets.2/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm1/Mul_output_0 : Float(1, 1280, 2, 1, strides=[2560, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.2/norm1/Mul"](%/up_blocks.0/resnets.2/norm1/Reshape_1_output_0, %onnx::Mul_10278), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm1/Add_output_0 : Float(1, 1280, 2, 1, strides=[2560, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.2/norm1/Add"](%/up_blocks.0/resnets.2/norm1/Mul_output_0, %onnx::Add_10279), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/Sigmoid_output_0 : Float(1, 1280, 2, 1, strides=[2560, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.2/Sigmoid"](%/up_blocks.0/resnets.2/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.2/Mul_output_0 : Float(1, 1280, 2, 1, strides=[2560, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.2/Mul"](%/up_blocks.0/resnets.2/norm1/Add_output_0, %/up_blocks.0/resnets.2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.2/conv1/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.2/conv1/Conv"](%/up_blocks.0/resnets.2/Mul_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.2.conv1.weight, %inner_unet.inner_unet.up_blocks.0.resnets.2.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.2/time_layer/Gemm_output_0 : Float(1, 1536, strides=[1536, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.0/resnets.2/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.2.time_layer.weight, %inner_unet.inner_unet.up_blocks.0.resnets.2.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/resnets.2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Unsqueeze_output_0 : Float(1, 1536, 1, strides=[1536, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.2/Unsqueeze"](%/up_blocks.0/resnets.2/time_layer/Gemm_output_0, %/up_blocks.0/resnets.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Unsqueeze_1_output_0 : Float(1, 1536, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.2/Unsqueeze_1"](%/up_blocks.0/resnets.2/Unsqueeze_output_0, %/up_blocks.0/resnets.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.2/Shape"](%/up_blocks.0/resnets.2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/resnets.2/Gather"](%/up_blocks.0/resnets.2/Shape_output_0, %/up_blocks.0/resnets.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/resnets.2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/resnets.2/Add"](%/up_blocks.0/resnets.2/Gather_output_0, %/up_blocks.0/resnets.2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/resnets.2/Div"](%/up_blocks.0/resnets.2/Add_output_0, %/up_blocks.0/resnets.2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.2/Mul_1"](%/up_blocks.0/resnets.2/Div_output_0, %/up_blocks.0/resnets.2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Slice_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.2/Slice"](%/up_blocks.0/resnets.2/Unsqueeze_1_output_0, %/up_blocks.0/resnets.2/Constant_3_output_0, %/up_blocks.0/resnets.2/Mul_1_output_0, %/up_blocks.0/resnets.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.2/Mul_2"](%/up_blocks.0/resnets.2/Div_output_0, %/up_blocks.0/resnets.2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/Slice_1_output_0 : Float(1, 768, 1, 1, strides=[1536, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.2/Slice_1"](%/up_blocks.0/resnets.2/Unsqueeze_1_output_0, %/up_blocks.0/resnets.2/Mul_1_output_0, %/up_blocks.0/resnets.2/Mul_2_output_0, %/up_blocks.0/resnets.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.2/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.2/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm2/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.2/norm2/Reshape"](%/up_blocks.0/resnets.2/conv1/Conv_output_0, %/up_blocks.0/resnets.2/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.2/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.2/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm2/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.2/norm2/InstanceNormalization"](%/up_blocks.0/resnets.2/norm2/Reshape_output_0, %/up_blocks.0/resnets.2/norm2/Constant_1_output_0, %/up_blocks.0/resnets.2/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.2/norm2/Shape"](%/up_blocks.0/resnets.2/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm2/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.2/norm2/Reshape_1"](%/up_blocks.0/resnets.2/norm2/InstanceNormalization_output_0, %/up_blocks.0/resnets.2/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm2/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.2/norm2/Mul"](%/up_blocks.0/resnets.2/norm2/Reshape_1_output_0, %onnx::Mul_10280), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/norm2/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.2/norm2/Add"](%/up_blocks.0/resnets.2/norm2/Mul_output_0, %onnx::Add_10281), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.2/Add_1_output_0 : Float(1, 768, 1, 1, strides=[768, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.2/Add_1"](%/up_blocks.0/resnets.2/Slice_output_0, %/up_blocks.0/resnets.2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.2/Mul_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.2/Mul_3"](%/up_blocks.0/resnets.2/norm2/Add_output_0, %/up_blocks.0/resnets.2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.2/Add_2_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.2/Add_2"](%/up_blocks.0/resnets.2/Mul_3_output_0, %/up_blocks.0/resnets.2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.2/Sigmoid_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.2/Sigmoid_1"](%/up_blocks.0/resnets.2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.2/Mul_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.2/Mul_4"](%/up_blocks.0/resnets.2/Add_2_output_0, %/up_blocks.0/resnets.2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.2/conv2/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.2/conv2/Conv"](%/up_blocks.0/resnets.2/Mul_4_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.2.conv2.weight, %inner_unet.inner_unet.up_blocks.0.resnets.2.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.2/conv3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/resnets.2/conv3/Conv"](%/up_blocks.0/Concat_2_output_0, %inner_unet.inner_unet.up_blocks.0.resnets.2.conv3.weight, %inner_unet.inner_unet.up_blocks.0.resnets.2.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.2/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.2/Add_3"](%/up_blocks.0/resnets.2/conv2/Conv_output_0, %/up_blocks.0/resnets.2/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.0/attn.10/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.10/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/norm/Reshape"](%/up_blocks.0/resnets.2/Add_3_output_0, %/up_blocks.0/attn.10/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.10/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.10/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.10/norm/InstanceNormalization"](%/up_blocks.0/attn.10/norm/Reshape_output_0, %/up_blocks.0/attn.10/norm/Constant_1_output_0, %/up_blocks.0/attn.10/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.10/norm/Shape"](%/up_blocks.0/resnets.2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/norm/Reshape_1"](%/up_blocks.0/attn.10/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.10/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/norm/Mul"](%/up_blocks.0/attn.10/norm/Reshape_1_output_0, %onnx::Mul_10282), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.10/norm/Add"](%/up_blocks.0/attn.10/norm/Mul_output_0, %onnx::Add_10283), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.10/qkv/Conv"](%/up_blocks.0/attn.10/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.10.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.10.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.10/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.10/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/Reshape"](%/up_blocks.0/attn.10/qkv/Conv_output_0, %/up_blocks.0/attn.10/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.10/Shape"](%/up_blocks.0/attn.10/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.10/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.10/Gather"](%/up_blocks.0/attn.10/Shape_output_0, %/up_blocks.0/attn.10/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.10/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.10/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.10/Add"](%/up_blocks.0/attn.10/Gather_output_0, %/up_blocks.0/attn.10/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.10/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.10/Div"](%/up_blocks.0/attn.10/Add_output_0, %/up_blocks.0/attn.10/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.10/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/Mul"](%/up_blocks.0/attn.10/Div_output_0, %/up_blocks.0/attn.10/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.10/Slice"](%/up_blocks.0/attn.10/Reshape_output_0, %/up_blocks.0/attn.10/Constant_2_output_0, %/up_blocks.0/attn.10/Mul_output_0, %/up_blocks.0/attn.10/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.10/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/Mul_1"](%/up_blocks.0/attn.10/Div_output_0, %/up_blocks.0/attn.10/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.10/Slice_1"](%/up_blocks.0/attn.10/Reshape_output_0, %/up_blocks.0/attn.10/Mul_output_0, %/up_blocks.0/attn.10/Mul_1_output_0, %/up_blocks.0/attn.10/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.10/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/Mul_2"](%/up_blocks.0/attn.10/Div_output_0, %/up_blocks.0/attn.10/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.10/Slice_2"](%/up_blocks.0/attn.10/Reshape_output_0, %/up_blocks.0/attn.10/Mul_1_output_0, %/up_blocks.0/attn.10/Mul_2_output_0, %/up_blocks.0/attn.10/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.10/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.10/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.10/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.10/Reciprocal"](%/up_blocks.0/attn.10/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.10/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/Mul_3"](%/up_blocks.0/attn.10/Slice_output_0, %/up_blocks.0/attn.10/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.10/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.10/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.10/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/Reshape_1"](%/up_blocks.0/attn.10/Mul_3_output_0, %/up_blocks.0/attn.10/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.10/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/Mul_4"](%/up_blocks.0/attn.10/Slice_1_output_0, %/up_blocks.0/attn.10/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.10/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.10/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.10/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.10/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.10/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.10/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.10/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.10/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.10/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/Reshape_2"](%/up_blocks.0/attn.10/Mul_4_output_0, %/up_blocks.0/attn.10/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.10/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.10/Einsum"](%/up_blocks.0/attn.10/Reshape_1_output_0, %/up_blocks.0/attn.10/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.10/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.10/Cast"](%/up_blocks.0/attn.10/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.10/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.10/Softmax"](%/up_blocks.0/attn.10/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.10/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.10/Cast_1"](%/up_blocks.0/attn.10/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.10/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/Reshape_3"](%/up_blocks.0/attn.10/Slice_2_output_0, %/up_blocks.0/attn.10/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.10/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.10/Einsum_1"](%/up_blocks.0/attn.10/Cast_1_output_0, %/up_blocks.0/attn.10/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.10/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.10/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.10/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.10/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.10/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/Reshape_4"](%/up_blocks.0/attn.10/Einsum_1_output_0, %/up_blocks.0/attn.10/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.10/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.10/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.10.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.10.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.10/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.10/kv_cond/MatMul"](%/up_blocks.0/attn.10/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10316), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.10/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.10/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.10.kv_cond.bias, %/up_blocks.0/attn.10/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.10/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.10/Transpose"](%/up_blocks.0/attn.10/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.10/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.10/Shape_1"](%/up_blocks.0/attn.10/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.10/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.10/Gather_1"](%/up_blocks.0/attn.10/Shape_1_output_0, %/up_blocks.0/attn.10/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.10/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.10/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.10/Add_1"](%/up_blocks.0/attn.10/Gather_1_output_0, %/up_blocks.0/attn.10/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.10/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.10/Div_1"](%/up_blocks.0/attn.10/Add_1_output_0, %/up_blocks.0/attn.10/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.10/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/Mul_5"](%/up_blocks.0/attn.10/Div_1_output_0, %/up_blocks.0/attn.10/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.10/Slice_3"](%/up_blocks.0/attn.10/Transpose_output_0, %/up_blocks.0/attn.10/Constant_17_output_0, %/up_blocks.0/attn.10/Mul_5_output_0, %/up_blocks.0/attn.10/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.10/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/Mul_6"](%/up_blocks.0/attn.10/Div_1_output_0, %/up_blocks.0/attn.10/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.10/Slice_4"](%/up_blocks.0/attn.10/Transpose_output_0, %/up_blocks.0/attn.10/Mul_5_output_0, %/up_blocks.0/attn.10/Mul_6_output_0, %/up_blocks.0/attn.10/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.10/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/Mul_7"](%/up_blocks.0/attn.10/Slice_3_output_0, %/up_blocks.0/attn.10/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.10/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/Reshape_5"](%/up_blocks.0/attn.10/Mul_7_output_0, %/up_blocks.0/attn.10/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.10/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.10/Einsum_2"](%/up_blocks.0/attn.10/Reshape_1_output_0, %/up_blocks.0/attn.10/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.10/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.10/Cast_2"](%/up_blocks.0/attn.10/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.10/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.10/Softmax_1"](%/up_blocks.0/attn.10/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.10/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.10/Cast_3"](%/up_blocks.0/attn.10/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.10/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/Reshape_6"](%/up_blocks.0/attn.10/Slice_4_output_0, %/up_blocks.0/attn.10/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.10/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.10/Einsum_3"](%/up_blocks.0/attn.10/Cast_3_output_0, %/up_blocks.0/attn.10/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.10/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/Reshape_7"](%/up_blocks.0/attn.10/Einsum_3_output_0, %/up_blocks.0/attn.10/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.10/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.10/Add_2"](%/up_blocks.0/attn.10/Reshape_4_output_0, %/up_blocks.0/attn.10/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.10/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.10/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.10/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/Reshape_8"](%/up_blocks.0/attn.10/Add_2_output_0, %/up_blocks.0/attn.10/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.10/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.10/proj_out/Conv"](%/up_blocks.0/attn.10/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.10.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.10.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.10/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.10/Add_3"](%/up_blocks.0/resnets.2/Add_3_output_0, %/up_blocks.0/attn.10/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.10/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.10/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.10/Add_3_output_0, %/up_blocks.0/attn.10/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.10/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.10/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.10/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.10/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.10/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.10/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.10/ffn/ffn.0/Shape"](%/up_blocks.0/attn.10/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.10/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.10/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.10/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/ffn/ffn.0/Mul"](%/up_blocks.0/attn.10/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10322), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.10/ffn/ffn.0/Add"](%/up_blocks.0/attn.10/ffn/ffn.0/Mul_output_0, %onnx::Add_10323), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.10/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.10/ffn/ffn.1/Conv"](%/up_blocks.0/attn.10/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.10.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.10.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.10/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.10/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.10/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.10/ffn/ffn.2/Div"](%/up_blocks.0/attn.10/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.10/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.10/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.10/ffn/ffn.2/Erf"](%/up_blocks.0/attn.10/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.10/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.10/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.10/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.10/ffn/ffn.2/Add"](%/up_blocks.0/attn.10/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.10/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.10/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/ffn/ffn.2/Mul"](%/up_blocks.0/attn.10/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.10/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.10/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.10/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.10/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.10/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.10/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.10/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.10/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.10/ffn/ffn.3/Conv"](%/up_blocks.0/attn.10/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.10.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.10.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.10/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.10/Add_4"](%/up_blocks.0/attn.10/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.10/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.10 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.11/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.11/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/norm/Reshape"](%/up_blocks.0/attn.10/Add_4_output_0, %/up_blocks.0/attn.11/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.11/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.11/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.11/norm/InstanceNormalization"](%/up_blocks.0/attn.11/norm/Reshape_output_0, %/up_blocks.0/attn.11/norm/Constant_1_output_0, %/up_blocks.0/attn.11/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.11/norm/Shape"](%/up_blocks.0/attn.10/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/norm/Reshape_1"](%/up_blocks.0/attn.11/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.11/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/norm/Mul"](%/up_blocks.0/attn.11/norm/Reshape_1_output_0, %onnx::Mul_10324), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.11/norm/Add"](%/up_blocks.0/attn.11/norm/Mul_output_0, %onnx::Add_10325), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.11/qkv/Conv"](%/up_blocks.0/attn.11/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.11.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.11.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.11/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.11/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/Reshape"](%/up_blocks.0/attn.11/qkv/Conv_output_0, %/up_blocks.0/attn.11/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.11/Shape"](%/up_blocks.0/attn.11/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.11/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.11/Gather"](%/up_blocks.0/attn.11/Shape_output_0, %/up_blocks.0/attn.11/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.11/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.11/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.11/Add"](%/up_blocks.0/attn.11/Gather_output_0, %/up_blocks.0/attn.11/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.11/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.11/Div"](%/up_blocks.0/attn.11/Add_output_0, %/up_blocks.0/attn.11/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.11/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/Mul"](%/up_blocks.0/attn.11/Div_output_0, %/up_blocks.0/attn.11/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.11/Slice"](%/up_blocks.0/attn.11/Reshape_output_0, %/up_blocks.0/attn.11/Constant_2_output_0, %/up_blocks.0/attn.11/Mul_output_0, %/up_blocks.0/attn.11/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.11/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/Mul_1"](%/up_blocks.0/attn.11/Div_output_0, %/up_blocks.0/attn.11/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.11/Slice_1"](%/up_blocks.0/attn.11/Reshape_output_0, %/up_blocks.0/attn.11/Mul_output_0, %/up_blocks.0/attn.11/Mul_1_output_0, %/up_blocks.0/attn.11/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.11/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/Mul_2"](%/up_blocks.0/attn.11/Div_output_0, %/up_blocks.0/attn.11/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.11/Slice_2"](%/up_blocks.0/attn.11/Reshape_output_0, %/up_blocks.0/attn.11/Mul_1_output_0, %/up_blocks.0/attn.11/Mul_2_output_0, %/up_blocks.0/attn.11/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.11/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.11/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.11/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.11/Reciprocal"](%/up_blocks.0/attn.11/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.11/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/Mul_3"](%/up_blocks.0/attn.11/Slice_output_0, %/up_blocks.0/attn.11/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.11/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.11/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.11/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/Reshape_1"](%/up_blocks.0/attn.11/Mul_3_output_0, %/up_blocks.0/attn.11/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.11/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/Mul_4"](%/up_blocks.0/attn.11/Slice_1_output_0, %/up_blocks.0/attn.11/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.11/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.11/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.11/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.11/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.11/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.11/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.11/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.11/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.11/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/Reshape_2"](%/up_blocks.0/attn.11/Mul_4_output_0, %/up_blocks.0/attn.11/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.11/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.11/Einsum"](%/up_blocks.0/attn.11/Reshape_1_output_0, %/up_blocks.0/attn.11/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.11/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.11/Cast"](%/up_blocks.0/attn.11/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.11/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.11/Softmax"](%/up_blocks.0/attn.11/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.11/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.11/Cast_1"](%/up_blocks.0/attn.11/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.11/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/Reshape_3"](%/up_blocks.0/attn.11/Slice_2_output_0, %/up_blocks.0/attn.11/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.11/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.11/Einsum_1"](%/up_blocks.0/attn.11/Cast_1_output_0, %/up_blocks.0/attn.11/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.11/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.11/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.11/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.11/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.11/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/Reshape_4"](%/up_blocks.0/attn.11/Einsum_1_output_0, %/up_blocks.0/attn.11/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.11/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.11/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.11.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.11.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.11/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.11/kv_cond/MatMul"](%/up_blocks.0/attn.11/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10358), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.11/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.11/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.11.kv_cond.bias, %/up_blocks.0/attn.11/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.11/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.11/Transpose"](%/up_blocks.0/attn.11/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.11/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.11/Shape_1"](%/up_blocks.0/attn.11/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.11/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.11/Gather_1"](%/up_blocks.0/attn.11/Shape_1_output_0, %/up_blocks.0/attn.11/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.11/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.11/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.11/Add_1"](%/up_blocks.0/attn.11/Gather_1_output_0, %/up_blocks.0/attn.11/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.11/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.11/Div_1"](%/up_blocks.0/attn.11/Add_1_output_0, %/up_blocks.0/attn.11/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.11/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/Mul_5"](%/up_blocks.0/attn.11/Div_1_output_0, %/up_blocks.0/attn.11/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.11/Slice_3"](%/up_blocks.0/attn.11/Transpose_output_0, %/up_blocks.0/attn.11/Constant_17_output_0, %/up_blocks.0/attn.11/Mul_5_output_0, %/up_blocks.0/attn.11/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.11/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/Mul_6"](%/up_blocks.0/attn.11/Div_1_output_0, %/up_blocks.0/attn.11/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.11/Slice_4"](%/up_blocks.0/attn.11/Transpose_output_0, %/up_blocks.0/attn.11/Mul_5_output_0, %/up_blocks.0/attn.11/Mul_6_output_0, %/up_blocks.0/attn.11/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.11/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/Mul_7"](%/up_blocks.0/attn.11/Slice_3_output_0, %/up_blocks.0/attn.11/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.11/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/Reshape_5"](%/up_blocks.0/attn.11/Mul_7_output_0, %/up_blocks.0/attn.11/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.11/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.11/Einsum_2"](%/up_blocks.0/attn.11/Reshape_1_output_0, %/up_blocks.0/attn.11/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.11/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.11/Cast_2"](%/up_blocks.0/attn.11/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.11/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.11/Softmax_1"](%/up_blocks.0/attn.11/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.11/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.11/Cast_3"](%/up_blocks.0/attn.11/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.11/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/Reshape_6"](%/up_blocks.0/attn.11/Slice_4_output_0, %/up_blocks.0/attn.11/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.11/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.11/Einsum_3"](%/up_blocks.0/attn.11/Cast_3_output_0, %/up_blocks.0/attn.11/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.11/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/Reshape_7"](%/up_blocks.0/attn.11/Einsum_3_output_0, %/up_blocks.0/attn.11/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.11/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.11/Add_2"](%/up_blocks.0/attn.11/Reshape_4_output_0, %/up_blocks.0/attn.11/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.11/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.11/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.11/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/Reshape_8"](%/up_blocks.0/attn.11/Add_2_output_0, %/up_blocks.0/attn.11/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.11/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.11/proj_out/Conv"](%/up_blocks.0/attn.11/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.11.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.11.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.11/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.11/Add_3"](%/up_blocks.0/attn.10/Add_4_output_0, %/up_blocks.0/attn.11/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.11/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.11/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.11/Add_3_output_0, %/up_blocks.0/attn.11/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.11/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.11/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.11/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.11/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.11/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.11/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.11/ffn/ffn.0/Shape"](%/up_blocks.0/attn.11/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.11/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.11/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.11/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/ffn/ffn.0/Mul"](%/up_blocks.0/attn.11/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10364), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.11/ffn/ffn.0/Add"](%/up_blocks.0/attn.11/ffn/ffn.0/Mul_output_0, %onnx::Add_10365), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.11/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.11/ffn/ffn.1/Conv"](%/up_blocks.0/attn.11/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.11.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.11.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.11/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.11/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.11/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.11/ffn/ffn.2/Div"](%/up_blocks.0/attn.11/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.11/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.11/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.11/ffn/ffn.2/Erf"](%/up_blocks.0/attn.11/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.11/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.11/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.11/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.11/ffn/ffn.2/Add"](%/up_blocks.0/attn.11/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.11/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.11/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/ffn/ffn.2/Mul"](%/up_blocks.0/attn.11/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.11/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.11/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.11/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.11/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.11/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.11/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.11/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.11/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.11/ffn/ffn.3/Conv"](%/up_blocks.0/attn.11/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.11.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.11.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.11/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.11/Add_4"](%/up_blocks.0/attn.11/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.11/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.11 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.12/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.12/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/norm/Reshape"](%/up_blocks.0/attn.11/Add_4_output_0, %/up_blocks.0/attn.12/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.12/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.12/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.12/norm/InstanceNormalization"](%/up_blocks.0/attn.12/norm/Reshape_output_0, %/up_blocks.0/attn.12/norm/Constant_1_output_0, %/up_blocks.0/attn.12/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.12/norm/Shape"](%/up_blocks.0/attn.11/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/norm/Reshape_1"](%/up_blocks.0/attn.12/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.12/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/norm/Mul"](%/up_blocks.0/attn.12/norm/Reshape_1_output_0, %onnx::Mul_10366), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.12/norm/Add"](%/up_blocks.0/attn.12/norm/Mul_output_0, %onnx::Add_10367), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.12/qkv/Conv"](%/up_blocks.0/attn.12/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.12.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.12.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.12/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.12/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/Reshape"](%/up_blocks.0/attn.12/qkv/Conv_output_0, %/up_blocks.0/attn.12/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.12/Shape"](%/up_blocks.0/attn.12/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.12/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.12/Gather"](%/up_blocks.0/attn.12/Shape_output_0, %/up_blocks.0/attn.12/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.12/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.12/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.12/Add"](%/up_blocks.0/attn.12/Gather_output_0, %/up_blocks.0/attn.12/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.12/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.12/Div"](%/up_blocks.0/attn.12/Add_output_0, %/up_blocks.0/attn.12/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.12/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/Mul"](%/up_blocks.0/attn.12/Div_output_0, %/up_blocks.0/attn.12/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.12/Slice"](%/up_blocks.0/attn.12/Reshape_output_0, %/up_blocks.0/attn.12/Constant_2_output_0, %/up_blocks.0/attn.12/Mul_output_0, %/up_blocks.0/attn.12/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.12/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/Mul_1"](%/up_blocks.0/attn.12/Div_output_0, %/up_blocks.0/attn.12/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.12/Slice_1"](%/up_blocks.0/attn.12/Reshape_output_0, %/up_blocks.0/attn.12/Mul_output_0, %/up_blocks.0/attn.12/Mul_1_output_0, %/up_blocks.0/attn.12/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.12/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/Mul_2"](%/up_blocks.0/attn.12/Div_output_0, %/up_blocks.0/attn.12/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.12/Slice_2"](%/up_blocks.0/attn.12/Reshape_output_0, %/up_blocks.0/attn.12/Mul_1_output_0, %/up_blocks.0/attn.12/Mul_2_output_0, %/up_blocks.0/attn.12/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.12/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.12/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.12/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.12/Reciprocal"](%/up_blocks.0/attn.12/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.12/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/Mul_3"](%/up_blocks.0/attn.12/Slice_output_0, %/up_blocks.0/attn.12/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.12/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.12/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.12/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/Reshape_1"](%/up_blocks.0/attn.12/Mul_3_output_0, %/up_blocks.0/attn.12/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.12/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/Mul_4"](%/up_blocks.0/attn.12/Slice_1_output_0, %/up_blocks.0/attn.12/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.12/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.12/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.12/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.12/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.12/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.12/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.12/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.12/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.12/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/Reshape_2"](%/up_blocks.0/attn.12/Mul_4_output_0, %/up_blocks.0/attn.12/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.12/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.12/Einsum"](%/up_blocks.0/attn.12/Reshape_1_output_0, %/up_blocks.0/attn.12/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.12/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.12/Cast"](%/up_blocks.0/attn.12/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.12/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.12/Softmax"](%/up_blocks.0/attn.12/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.12/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.12/Cast_1"](%/up_blocks.0/attn.12/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.12/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/Reshape_3"](%/up_blocks.0/attn.12/Slice_2_output_0, %/up_blocks.0/attn.12/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.12/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.12/Einsum_1"](%/up_blocks.0/attn.12/Cast_1_output_0, %/up_blocks.0/attn.12/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.12/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.12/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.12/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.12/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.12/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/Reshape_4"](%/up_blocks.0/attn.12/Einsum_1_output_0, %/up_blocks.0/attn.12/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.12/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.12/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.12.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.12.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.12/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.12/kv_cond/MatMul"](%/up_blocks.0/attn.12/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10400), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.12/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.12/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.12.kv_cond.bias, %/up_blocks.0/attn.12/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.12/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.12/Transpose"](%/up_blocks.0/attn.12/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.12/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.12/Shape_1"](%/up_blocks.0/attn.12/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.12/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.12/Gather_1"](%/up_blocks.0/attn.12/Shape_1_output_0, %/up_blocks.0/attn.12/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.12/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.12/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.12/Add_1"](%/up_blocks.0/attn.12/Gather_1_output_0, %/up_blocks.0/attn.12/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.12/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.12/Div_1"](%/up_blocks.0/attn.12/Add_1_output_0, %/up_blocks.0/attn.12/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.12/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/Mul_5"](%/up_blocks.0/attn.12/Div_1_output_0, %/up_blocks.0/attn.12/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.12/Slice_3"](%/up_blocks.0/attn.12/Transpose_output_0, %/up_blocks.0/attn.12/Constant_17_output_0, %/up_blocks.0/attn.12/Mul_5_output_0, %/up_blocks.0/attn.12/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.12/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/Mul_6"](%/up_blocks.0/attn.12/Div_1_output_0, %/up_blocks.0/attn.12/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.12/Slice_4"](%/up_blocks.0/attn.12/Transpose_output_0, %/up_blocks.0/attn.12/Mul_5_output_0, %/up_blocks.0/attn.12/Mul_6_output_0, %/up_blocks.0/attn.12/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.12/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/Mul_7"](%/up_blocks.0/attn.12/Slice_3_output_0, %/up_blocks.0/attn.12/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.12/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/Reshape_5"](%/up_blocks.0/attn.12/Mul_7_output_0, %/up_blocks.0/attn.12/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.12/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.12/Einsum_2"](%/up_blocks.0/attn.12/Reshape_1_output_0, %/up_blocks.0/attn.12/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.12/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.12/Cast_2"](%/up_blocks.0/attn.12/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.12/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.12/Softmax_1"](%/up_blocks.0/attn.12/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.12/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.12/Cast_3"](%/up_blocks.0/attn.12/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.12/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/Reshape_6"](%/up_blocks.0/attn.12/Slice_4_output_0, %/up_blocks.0/attn.12/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.12/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.12/Einsum_3"](%/up_blocks.0/attn.12/Cast_3_output_0, %/up_blocks.0/attn.12/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.12/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/Reshape_7"](%/up_blocks.0/attn.12/Einsum_3_output_0, %/up_blocks.0/attn.12/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.12/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.12/Add_2"](%/up_blocks.0/attn.12/Reshape_4_output_0, %/up_blocks.0/attn.12/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.12/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.12/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.12/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/Reshape_8"](%/up_blocks.0/attn.12/Add_2_output_0, %/up_blocks.0/attn.12/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.12/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.12/proj_out/Conv"](%/up_blocks.0/attn.12/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.12.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.12.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.12/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.12/Add_3"](%/up_blocks.0/attn.11/Add_4_output_0, %/up_blocks.0/attn.12/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.12/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.12/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.12/Add_3_output_0, %/up_blocks.0/attn.12/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.12/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.12/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.12/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.12/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.12/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.12/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.12/ffn/ffn.0/Shape"](%/up_blocks.0/attn.12/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.12/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.12/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.12/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/ffn/ffn.0/Mul"](%/up_blocks.0/attn.12/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10406), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.12/ffn/ffn.0/Add"](%/up_blocks.0/attn.12/ffn/ffn.0/Mul_output_0, %onnx::Add_10407), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.12/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.12/ffn/ffn.1/Conv"](%/up_blocks.0/attn.12/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.12.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.12.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.12/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.12/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.12/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.12/ffn/ffn.2/Div"](%/up_blocks.0/attn.12/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.12/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.12/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.12/ffn/ffn.2/Erf"](%/up_blocks.0/attn.12/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.12/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.12/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.12/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.12/ffn/ffn.2/Add"](%/up_blocks.0/attn.12/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.12/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.12/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/ffn/ffn.2/Mul"](%/up_blocks.0/attn.12/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.12/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.12/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.12/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.12/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.12/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.12/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.12/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.12/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.12/ffn/ffn.3/Conv"](%/up_blocks.0/attn.12/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.12.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.12.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.12/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.12/Add_4"](%/up_blocks.0/attn.12/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.12/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.12 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.13/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.13/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/norm/Reshape"](%/up_blocks.0/attn.12/Add_4_output_0, %/up_blocks.0/attn.13/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.13/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.13/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.13/norm/InstanceNormalization"](%/up_blocks.0/attn.13/norm/Reshape_output_0, %/up_blocks.0/attn.13/norm/Constant_1_output_0, %/up_blocks.0/attn.13/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.13/norm/Shape"](%/up_blocks.0/attn.12/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/norm/Reshape_1"](%/up_blocks.0/attn.13/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.13/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/norm/Mul"](%/up_blocks.0/attn.13/norm/Reshape_1_output_0, %onnx::Mul_10408), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.13/norm/Add"](%/up_blocks.0/attn.13/norm/Mul_output_0, %onnx::Add_10409), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.13/qkv/Conv"](%/up_blocks.0/attn.13/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.13.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.13.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.13/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.13/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/Reshape"](%/up_blocks.0/attn.13/qkv/Conv_output_0, %/up_blocks.0/attn.13/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.13/Shape"](%/up_blocks.0/attn.13/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.13/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.13/Gather"](%/up_blocks.0/attn.13/Shape_output_0, %/up_blocks.0/attn.13/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.13/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.13/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.13/Add"](%/up_blocks.0/attn.13/Gather_output_0, %/up_blocks.0/attn.13/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.13/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.13/Div"](%/up_blocks.0/attn.13/Add_output_0, %/up_blocks.0/attn.13/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.13/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/Mul"](%/up_blocks.0/attn.13/Div_output_0, %/up_blocks.0/attn.13/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.13/Slice"](%/up_blocks.0/attn.13/Reshape_output_0, %/up_blocks.0/attn.13/Constant_2_output_0, %/up_blocks.0/attn.13/Mul_output_0, %/up_blocks.0/attn.13/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.13/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/Mul_1"](%/up_blocks.0/attn.13/Div_output_0, %/up_blocks.0/attn.13/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.13/Slice_1"](%/up_blocks.0/attn.13/Reshape_output_0, %/up_blocks.0/attn.13/Mul_output_0, %/up_blocks.0/attn.13/Mul_1_output_0, %/up_blocks.0/attn.13/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.13/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/Mul_2"](%/up_blocks.0/attn.13/Div_output_0, %/up_blocks.0/attn.13/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.13/Slice_2"](%/up_blocks.0/attn.13/Reshape_output_0, %/up_blocks.0/attn.13/Mul_1_output_0, %/up_blocks.0/attn.13/Mul_2_output_0, %/up_blocks.0/attn.13/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.13/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.13/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.13/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.13/Reciprocal"](%/up_blocks.0/attn.13/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.13/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/Mul_3"](%/up_blocks.0/attn.13/Slice_output_0, %/up_blocks.0/attn.13/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.13/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.13/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.13/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/Reshape_1"](%/up_blocks.0/attn.13/Mul_3_output_0, %/up_blocks.0/attn.13/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.13/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/Mul_4"](%/up_blocks.0/attn.13/Slice_1_output_0, %/up_blocks.0/attn.13/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.13/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.13/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.13/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.13/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.13/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.13/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.13/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.13/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.13/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/Reshape_2"](%/up_blocks.0/attn.13/Mul_4_output_0, %/up_blocks.0/attn.13/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.13/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.13/Einsum"](%/up_blocks.0/attn.13/Reshape_1_output_0, %/up_blocks.0/attn.13/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.13/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.13/Cast"](%/up_blocks.0/attn.13/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.13/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.13/Softmax"](%/up_blocks.0/attn.13/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.13/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.13/Cast_1"](%/up_blocks.0/attn.13/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.13/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/Reshape_3"](%/up_blocks.0/attn.13/Slice_2_output_0, %/up_blocks.0/attn.13/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.13/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.13/Einsum_1"](%/up_blocks.0/attn.13/Cast_1_output_0, %/up_blocks.0/attn.13/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.13/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.13/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.13/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.13/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.13/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/Reshape_4"](%/up_blocks.0/attn.13/Einsum_1_output_0, %/up_blocks.0/attn.13/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.13/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.13/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.13.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.13.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.13/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.13/kv_cond/MatMul"](%/up_blocks.0/attn.13/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10442), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.13/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.13/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.13.kv_cond.bias, %/up_blocks.0/attn.13/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.13/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.13/Transpose"](%/up_blocks.0/attn.13/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.13/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.13/Shape_1"](%/up_blocks.0/attn.13/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.13/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.13/Gather_1"](%/up_blocks.0/attn.13/Shape_1_output_0, %/up_blocks.0/attn.13/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.13/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.13/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.13/Add_1"](%/up_blocks.0/attn.13/Gather_1_output_0, %/up_blocks.0/attn.13/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.13/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.13/Div_1"](%/up_blocks.0/attn.13/Add_1_output_0, %/up_blocks.0/attn.13/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.13/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/Mul_5"](%/up_blocks.0/attn.13/Div_1_output_0, %/up_blocks.0/attn.13/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.13/Slice_3"](%/up_blocks.0/attn.13/Transpose_output_0, %/up_blocks.0/attn.13/Constant_17_output_0, %/up_blocks.0/attn.13/Mul_5_output_0, %/up_blocks.0/attn.13/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.13/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/Mul_6"](%/up_blocks.0/attn.13/Div_1_output_0, %/up_blocks.0/attn.13/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.13/Slice_4"](%/up_blocks.0/attn.13/Transpose_output_0, %/up_blocks.0/attn.13/Mul_5_output_0, %/up_blocks.0/attn.13/Mul_6_output_0, %/up_blocks.0/attn.13/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.13/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/Mul_7"](%/up_blocks.0/attn.13/Slice_3_output_0, %/up_blocks.0/attn.13/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.13/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/Reshape_5"](%/up_blocks.0/attn.13/Mul_7_output_0, %/up_blocks.0/attn.13/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.13/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.13/Einsum_2"](%/up_blocks.0/attn.13/Reshape_1_output_0, %/up_blocks.0/attn.13/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.13/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.13/Cast_2"](%/up_blocks.0/attn.13/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.13/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.13/Softmax_1"](%/up_blocks.0/attn.13/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.13/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.13/Cast_3"](%/up_blocks.0/attn.13/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.13/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/Reshape_6"](%/up_blocks.0/attn.13/Slice_4_output_0, %/up_blocks.0/attn.13/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.13/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.13/Einsum_3"](%/up_blocks.0/attn.13/Cast_3_output_0, %/up_blocks.0/attn.13/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.13/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/Reshape_7"](%/up_blocks.0/attn.13/Einsum_3_output_0, %/up_blocks.0/attn.13/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.13/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.13/Add_2"](%/up_blocks.0/attn.13/Reshape_4_output_0, %/up_blocks.0/attn.13/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.13/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.13/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.13/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/Reshape_8"](%/up_blocks.0/attn.13/Add_2_output_0, %/up_blocks.0/attn.13/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.13/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.13/proj_out/Conv"](%/up_blocks.0/attn.13/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.13.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.13.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.13/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.13/Add_3"](%/up_blocks.0/attn.12/Add_4_output_0, %/up_blocks.0/attn.13/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.13/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.13/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.13/Add_3_output_0, %/up_blocks.0/attn.13/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.13/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.13/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.13/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.13/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.13/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.13/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.13/ffn/ffn.0/Shape"](%/up_blocks.0/attn.13/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.13/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.13/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.13/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/ffn/ffn.0/Mul"](%/up_blocks.0/attn.13/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10448), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.13/ffn/ffn.0/Add"](%/up_blocks.0/attn.13/ffn/ffn.0/Mul_output_0, %onnx::Add_10449), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.13/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.13/ffn/ffn.1/Conv"](%/up_blocks.0/attn.13/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.13.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.13.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.13/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.13/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.13/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.13/ffn/ffn.2/Div"](%/up_blocks.0/attn.13/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.13/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.13/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.13/ffn/ffn.2/Erf"](%/up_blocks.0/attn.13/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.13/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.13/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.13/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.13/ffn/ffn.2/Add"](%/up_blocks.0/attn.13/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.13/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.13/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/ffn/ffn.2/Mul"](%/up_blocks.0/attn.13/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.13/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.13/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.13/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.13/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.13/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.13/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.13/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.13/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.13/ffn/ffn.3/Conv"](%/up_blocks.0/attn.13/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.13.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.13.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.13/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.13/Add_4"](%/up_blocks.0/attn.13/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.13/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.13 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/attn.14/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.14/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/norm/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/norm/Reshape"](%/up_blocks.0/attn.13/Add_4_output_0, %/up_blocks.0/attn.14/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.14/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.14/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/norm/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.14/norm/InstanceNormalization"](%/up_blocks.0/attn.14/norm/Reshape_output_0, %/up_blocks.0/attn.14/norm/Constant_1_output_0, %/up_blocks.0/attn.14/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.14/norm/Shape"](%/up_blocks.0/attn.13/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/norm/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/norm/Reshape_1"](%/up_blocks.0/attn.14/norm/InstanceNormalization_output_0, %/up_blocks.0/attn.14/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/norm/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/norm/Mul"](%/up_blocks.0/attn.14/norm/Reshape_1_output_0, %onnx::Mul_10450), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/norm/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.14/norm/Add"](%/up_blocks.0/attn.14/norm/Mul_output_0, %onnx::Add_10451), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/qkv/Conv_output_0 : Float(1, 2304, 2, 1, strides=[4608, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.14/qkv/Conv"](%/up_blocks.0/attn.14/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.14.qkv.weight, %inner_unet.inner_unet.up_blocks.0.attn.14.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.14/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  2304    -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.14/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Reshape_output_0 : Float(1, 2304, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/Reshape"](%/up_blocks.0/attn.14/qkv/Conv_output_0, %/up_blocks.0/attn.14/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.14/Shape"](%/up_blocks.0/attn.14/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.14/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.14/Gather"](%/up_blocks.0/attn.14/Shape_output_0, %/up_blocks.0/attn.14/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.14/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.14/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.14/Add"](%/up_blocks.0/attn.14/Gather_output_0, %/up_blocks.0/attn.14/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.14/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.14/Div"](%/up_blocks.0/attn.14/Add_output_0, %/up_blocks.0/attn.14/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.14/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/Mul"](%/up_blocks.0/attn.14/Div_output_0, %/up_blocks.0/attn.14/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Slice_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.14/Slice"](%/up_blocks.0/attn.14/Reshape_output_0, %/up_blocks.0/attn.14/Constant_2_output_0, %/up_blocks.0/attn.14/Mul_output_0, %/up_blocks.0/attn.14/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.14/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/Mul_1"](%/up_blocks.0/attn.14/Div_output_0, %/up_blocks.0/attn.14/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Slice_1_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.14/Slice_1"](%/up_blocks.0/attn.14/Reshape_output_0, %/up_blocks.0/attn.14/Mul_output_0, %/up_blocks.0/attn.14/Mul_1_output_0, %/up_blocks.0/attn.14/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.0/attn.14/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/Mul_2"](%/up_blocks.0/attn.14/Div_output_0, %/up_blocks.0/attn.14/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Slice_2_output_0 : Float(1, 768, 2, strides=[4608, 2, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.14/Slice_2"](%/up_blocks.0/attn.14/Reshape_output_0, %/up_blocks.0/attn.14/Mul_1_output_0, %/up_blocks.0/attn.14/Mul_2_output_0, %/up_blocks.0/attn.14/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.0/attn.14/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={3.13017}, onnx_name="/up_blocks.0/attn.14/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.0/attn.14/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.0/attn.14/Reciprocal"](%/up_blocks.0/attn.14/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.0/attn.14/Mul_3_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/Mul_3"](%/up_blocks.0/attn.14/Slice_output_0, %/up_blocks.0/attn.14/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.14/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96   2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.14/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.14/Reshape_1_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/Reshape_1"](%/up_blocks.0/attn.14/Mul_3_output_0, %/up_blocks.0/attn.14/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.0/attn.14/Mul_4_output_0 : Float(1, 768, 2, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/Mul_4"](%/up_blocks.0/attn.14/Slice_1_output_0, %/up_blocks.0/attn.14/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.14/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.14/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.14/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.14/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.14/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.14/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.14/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  96  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.14/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.14/Reshape_2_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/Reshape_2"](%/up_blocks.0/attn.14/Mul_4_output_0, %/up_blocks.0/attn.14/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.14/Einsum_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.14/Einsum"](%/up_blocks.0/attn.14/Reshape_1_output_0, %/up_blocks.0/attn.14/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.14/Cast_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.14/Cast"](%/up_blocks.0/attn.14/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.14/Softmax_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.14/Softmax"](%/up_blocks.0/attn.14/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.14/Cast_1_output_0 : Float(*, *, *, strides=[4, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.14/Cast_1"](%/up_blocks.0/attn.14/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.14/Reshape_3_output_0 : Float(8, 96, 2, strides=[192, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/Reshape_3"](%/up_blocks.0/attn.14/Slice_2_output_0, %/up_blocks.0/attn.14/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.14/Einsum_1_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.14/Einsum_1"](%/up_blocks.0/attn.14/Cast_1_output_0, %/up_blocks.0/attn.14/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.14/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.14/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.14/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  2 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.14/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.14/Reshape_4_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/Reshape_4"](%/up_blocks.0/attn.14/Einsum_1_output_0, %/up_blocks.0/attn.14/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.14/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.14/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.14.norm_cond.weight, %inner_unet.inner_unet.up_blocks.0.attn.14.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.0/attn.14/kv_cond/MatMul_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.0/attn.14/kv_cond/MatMul"](%/up_blocks.0/attn.14/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10484), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.14/kv_cond/Add_output_0 : Float(1, 128, 1536, strides=[196608, 1536, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.14/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.0.attn.14.kv_cond.bias, %/up_blocks.0/attn.14/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/attn.14/Transpose_output_0 : Float(1, 1536, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.0/attn.14/Transpose"](%/up_blocks.0/attn.14/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.0/attn.14/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.14/Shape_1"](%/up_blocks.0/attn.14/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.14/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/attn.14/Gather_1"](%/up_blocks.0/attn.14/Shape_1_output_0, %/up_blocks.0/attn.14/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/attn.14/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.14/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.14/Add_1"](%/up_blocks.0/attn.14/Gather_1_output_0, %/up_blocks.0/attn.14/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.14/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.14/Div_1"](%/up_blocks.0/attn.14/Add_1_output_0, %/up_blocks.0/attn.14/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.14/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/Mul_5"](%/up_blocks.0/attn.14/Div_1_output_0, %/up_blocks.0/attn.14/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Slice_3_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.14/Slice_3"](%/up_blocks.0/attn.14/Transpose_output_0, %/up_blocks.0/attn.14/Constant_17_output_0, %/up_blocks.0/attn.14/Mul_5_output_0, %/up_blocks.0/attn.14/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/attn.14/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/Mul_6"](%/up_blocks.0/attn.14/Div_1_output_0, %/up_blocks.0/attn.14/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Slice_4_output_0 : Float(1, 768, 128, strides=[196608, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/attn.14/Slice_4"](%/up_blocks.0/attn.14/Transpose_output_0, %/up_blocks.0/attn.14/Mul_5_output_0, %/up_blocks.0/attn.14/Mul_6_output_0, %/up_blocks.0/attn.14/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.0/attn.14/Mul_7_output_0 : Float(1, 768, 128, strides=[98304, 1, 768], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/Mul_7"](%/up_blocks.0/attn.14/Slice_3_output_0, %/up_blocks.0/attn.14/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.14/Reshape_5_output_0 : Float(8, 96, 128, strides=[96, 1, 768], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/Reshape_5"](%/up_blocks.0/attn.14/Mul_7_output_0, %/up_blocks.0/attn.14/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.0/attn.14/Einsum_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.0/attn.14/Einsum_2"](%/up_blocks.0/attn.14/Reshape_1_output_0, %/up_blocks.0/attn.14/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.14/Cast_2_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.14/Cast_2"](%/up_blocks.0/attn.14/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.14/Softmax_1_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.0/attn.14/Softmax_1"](%/up_blocks.0/attn.14/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.14/Cast_3_output_0 : Float(*, *, *, strides=[256, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/attn.14/Cast_3"](%/up_blocks.0/attn.14/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.0/attn.14/Reshape_6_output_0 : Float(8, 96, 128, strides=[96, 1, 1536], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/Reshape_6"](%/up_blocks.0/attn.14/Slice_4_output_0, %/up_blocks.0/attn.14/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.0/attn.14/Einsum_3_output_0 : Float(*, *, *, strides=[192, 1, 96], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.0/attn.14/Einsum_3"](%/up_blocks.0/attn.14/Cast_3_output_0, %/up_blocks.0/attn.14/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.0/attn.14/Reshape_7_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/Reshape_7"](%/up_blocks.0/attn.14/Einsum_3_output_0, %/up_blocks.0/attn.14/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.0/attn.14/Add_2_output_0 : Float(*, *, *, strides=[1536, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.14/Add_2"](%/up_blocks.0/attn.14/Reshape_4_output_0, %/up_blocks.0/attn.14/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.0/attn.14/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  768    2    1 [ CPULongType{4} ], onnx_name="/up_blocks.0/attn.14/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.14/Reshape_8_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/Reshape_8"](%/up_blocks.0/attn.14/Add_2_output_0, %/up_blocks.0/attn.14/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.0/attn.14/proj_out/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.14/proj_out/Conv"](%/up_blocks.0/attn.14/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.0.attn.14.proj_out.weight, %inner_unet.inner_unet.up_blocks.0.attn.14.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.14/Add_3_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.14/Add_3"](%/up_blocks.0/attn.13/Add_4_output_0, %/up_blocks.0/attn.14/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.0/attn.14/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/attn.14/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/ffn/ffn.0/Reshape"](%/up_blocks.0/attn.14/Add_3_output_0, %/up_blocks.0/attn.14/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.14/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/attn.14/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 48, strides=[1536, 48, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/attn.14/ffn/ffn.0/InstanceNormalization"](%/up_blocks.0/attn.14/ffn/ffn.0/Reshape_output_0, %/up_blocks.0/attn.14/ffn/ffn.0/Constant_1_output_0, %/up_blocks.0/attn.14/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/attn.14/ffn/ffn.0/Shape"](%/up_blocks.0/attn.14/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/ffn/ffn.0/Reshape_1_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/attn.14/ffn/ffn.0/Reshape_1"](%/up_blocks.0/attn.14/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.0/attn.14/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/ffn/ffn.0/Mul_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/ffn/ffn.0/Mul"](%/up_blocks.0/attn.14/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10490), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/ffn/ffn.0/Add_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.14/ffn/ffn.0/Add"](%/up_blocks.0/attn.14/ffn/ffn.0/Mul_output_0, %onnx::Add_10491), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/attn.14/ffn/ffn.1/Conv_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.14/ffn/ffn.1/Conv"](%/up_blocks.0/attn.14/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.0.attn.14.ffn.1.weight, %inner_unet.inner_unet.up_blocks.0.attn.14.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.14/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.0/attn.14/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.14/ffn/ffn.2/Div_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/attn.14/ffn/ffn.2/Div"](%/up_blocks.0/attn.14/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.14/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.14/ffn/ffn.2/Erf_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.0/attn.14/ffn/ffn.2/Erf"](%/up_blocks.0/attn.14/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.14/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/attn.14/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.14/ffn/ffn.2/Add_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/attn.14/ffn/ffn.2/Add"](%/up_blocks.0/attn.14/ffn/ffn.2/Erf_output_0, %/up_blocks.0/attn.14/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.14/ffn/ffn.2/Mul_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/ffn/ffn.2/Mul"](%/up_blocks.0/attn.14/ffn/ffn.1/Conv_output_0, %/up_blocks.0/attn.14/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.14/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.0/attn.14/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.14/ffn/ffn.2/Mul_1_output_0 : Float(1, 3072, 2, 1, strides=[6144, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/attn.14/ffn/ffn.2/Mul_1"](%/up_blocks.0/attn.14/ffn/ffn.2/Mul_output_0, %/up_blocks.0/attn.14/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.0/attn.14/ffn/ffn.3/Conv_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/attn.14/ffn/ffn.3/Conv"](%/up_blocks.0/attn.14/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.0.attn.14.ffn.3.weight, %inner_unet.inner_unet.up_blocks.0.attn.14.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/attn.14/Add_4_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/attn.14/Add_4"](%/up_blocks.0/attn.14/ffn/ffn.3/Conv_output_0, %/up_blocks.0/attn.14/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.SelfAttention::attn.14 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.0/Cast_output_0 : Float(1, 768, 2, 1, strides=[1536, 2, 1, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/Cast"](%/up_blocks.0/attn.14/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.0/Constant_output_0 : Float(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1  1  2  2 [ CPUFloatType{4} ], onnx_name="/up_blocks.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %onnx::Resize_7319 : Tensor? = prim::Constant(), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.0/Resize_output_0 : Float(1, 768, 4, 2, strides=[6144, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Resize[coordinate_transformation_mode="asymmetric", cubic_coeff_a=-0.75, mode="nearest", nearest_mode="floor", onnx_name="/up_blocks.0/Resize"](%/up_blocks.0/Cast_output_0, %onnx::Resize_7319, %/up_blocks.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.0/Cast_1_output_0 : Float(1, 768, 4, 2, strides=[6144, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0/Cast_1"](%/up_blocks.0/Resize_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.0/resample/Conv_output_0 : Float(1, 768, 4, 2, strides=[6144, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resample/Conv"](%/up_blocks.0/Cast_1_output_0, %inner_unet.inner_unet.up_blocks.0.resample.weight, %inner_unet.inner_unet.up_blocks.0.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/Concat_output_0 : Float(1, 1280, 4, 2, strides=[10240, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.1/Concat"](%/up_blocks.0/resample/Conv_output_0, %/down_blocks.1/attn.1/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.1/resnets.0/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.0/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1/Reshape_output_0 : Float(1, 32, 320, strides=[10240, 320, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm1/Reshape"](%/up_blocks.1/Concat_output_0, %/up_blocks.1/resnets.0/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1/InstanceNormalization_output_0 : Float(1, 32, 320, strides=[10240, 320, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.0/norm1/InstanceNormalization"](%/up_blocks.1/resnets.0/norm1/Reshape_output_0, %/up_blocks.1/resnets.0/norm1/Constant_1_output_0, %/up_blocks.1/resnets.0/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.0/norm1/Shape"](%/up_blocks.1/Concat_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1/Reshape_1_output_0 : Float(1, 1280, 4, 2, strides=[10240, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm1/Reshape_1"](%/up_blocks.1/resnets.0/norm1/InstanceNormalization_output_0, %/up_blocks.1/resnets.0/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1/Mul_output_0 : Float(1, 1280, 4, 2, strides=[10240, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/norm1/Mul"](%/up_blocks.1/resnets.0/norm1/Reshape_1_output_0, %onnx::Mul_10493), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1/Add_output_0 : Float(1, 1280, 4, 2, strides=[10240, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0/norm1/Add"](%/up_blocks.1/resnets.0/norm1/Mul_output_0, %onnx::Add_10494), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/Sigmoid_output_0 : Float(1, 1280, 4, 2, strides=[10240, 8, 2, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.0/Sigmoid"](%/up_blocks.1/resnets.0/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0/Mul_output_0 : Float(1, 1280, 4, 2, strides=[10240, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/Mul"](%/up_blocks.1/resnets.0/norm1/Add_output_0, %/up_blocks.1/resnets.0/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0/conv1/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.0/conv1/Conv"](%/up_blocks.1/resnets.0/Mul_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.0.conv1.weight, %inner_unet.inner_unet.up_blocks.1.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.0/time_layer/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.1/resnets.0/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.0.time_layer.weight, %inner_unet.inner_unet.up_blocks.1.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/resnets.0/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Unsqueeze_output_0 : Float(1, 1024, 1, strides=[1024, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.0/Unsqueeze"](%/up_blocks.1/resnets.0/time_layer/Gemm_output_0, %/up_blocks.1/resnets.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Unsqueeze_1_output_0 : Float(1, 1024, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.0/Unsqueeze_1"](%/up_blocks.1/resnets.0/Unsqueeze_output_0, %/up_blocks.1/resnets.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.0/Shape"](%/up_blocks.1/resnets.0/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/resnets.0/Gather"](%/up_blocks.1/resnets.0/Shape_output_0, %/up_blocks.1/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/resnets.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/resnets.0/Add"](%/up_blocks.1/resnets.0/Gather_output_0, %/up_blocks.1/resnets.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/resnets.0/Div"](%/up_blocks.1/resnets.0/Add_output_0, %/up_blocks.1/resnets.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/Mul_1"](%/up_blocks.1/resnets.0/Div_output_0, %/up_blocks.1/resnets.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Slice_output_0 : Float(1, 512, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.0/Slice"](%/up_blocks.1/resnets.0/Unsqueeze_1_output_0, %/up_blocks.1/resnets.0/Constant_3_output_0, %/up_blocks.1/resnets.0/Mul_1_output_0, %/up_blocks.1/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/Mul_2"](%/up_blocks.1/resnets.0/Div_output_0, %/up_blocks.1/resnets.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/Slice_1_output_0 : Float(1, 512, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.0/Slice_1"](%/up_blocks.1/resnets.0/Unsqueeze_1_output_0, %/up_blocks.1/resnets.0/Mul_1_output_0, %/up_blocks.1/resnets.0/Mul_2_output_0, %/up_blocks.1/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.0/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm2/Reshape"](%/up_blocks.1/resnets.0/conv1/Conv_output_0, %/up_blocks.1/resnets.0/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.0/norm2/InstanceNormalization"](%/up_blocks.1/resnets.0/norm2/Reshape_output_0, %/up_blocks.1/resnets.0/norm2/Constant_1_output_0, %/up_blocks.1/resnets.0/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.0/norm2/Shape"](%/up_blocks.1/resnets.0/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm2/Reshape_1"](%/up_blocks.1/resnets.0/norm2/InstanceNormalization_output_0, %/up_blocks.1/resnets.0/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/norm2/Mul"](%/up_blocks.1/resnets.0/norm2/Reshape_1_output_0, %onnx::Mul_10495), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0/norm2/Add"](%/up_blocks.1/resnets.0/norm2/Mul_output_0, %onnx::Add_10496), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0/Add_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0/Add_1"](%/up_blocks.1/resnets.0/Slice_output_0, %/up_blocks.1/resnets.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0/Mul_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/Mul_3"](%/up_blocks.1/resnets.0/norm2/Add_output_0, %/up_blocks.1/resnets.0/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0/Add_2_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0/Add_2"](%/up_blocks.1/resnets.0/Mul_3_output_0, %/up_blocks.1/resnets.0/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0/Sigmoid_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.0/Sigmoid_1"](%/up_blocks.1/resnets.0/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0/Mul_4_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/Mul_4"](%/up_blocks.1/resnets.0/Add_2_output_0, %/up_blocks.1/resnets.0/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0/conv2/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.0/conv2/Conv"](%/up_blocks.1/resnets.0/Mul_4_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.0.conv2.weight, %inner_unet.inner_unet.up_blocks.1.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.0/conv3/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/resnets.0/conv3/Conv"](%/up_blocks.1/Concat_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.0.conv3.weight, %inner_unet.inner_unet.up_blocks.1.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.0/Add_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0/Add_3"](%/up_blocks.1/resnets.0/conv2/Conv_output_0, %/up_blocks.1/resnets.0/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.1/attn.0/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.0/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/norm/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/norm/Reshape"](%/up_blocks.1/resnets.0/Add_3_output_0, %/up_blocks.1/attn.0/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.0/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.0/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/norm/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/attn.0/norm/InstanceNormalization"](%/up_blocks.1/attn.0/norm/Reshape_output_0, %/up_blocks.1/attn.0/norm/Constant_1_output_0, %/up_blocks.1/attn.0/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.0/norm/Shape"](%/up_blocks.1/resnets.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/norm/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/norm/Reshape_1"](%/up_blocks.1/attn.0/norm/InstanceNormalization_output_0, %/up_blocks.1/attn.0/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/norm/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/norm/Mul"](%/up_blocks.1/attn.0/norm/Reshape_1_output_0, %onnx::Mul_10497), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/norm/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.0/norm/Add"](%/up_blocks.1/attn.0/norm/Mul_output_0, %onnx::Add_10498), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/qkv/Conv_output_0 : Float(1, 1536, 4, 2, strides=[12288, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.0/qkv/Conv"](%/up_blocks.1/attn.0/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.1.attn.0.qkv.weight, %inner_unet.inner_unet.up_blocks.1.attn.0.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.0/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  1536    -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Reshape_output_0 : Float(1, 1536, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/Reshape"](%/up_blocks.1/attn.0/qkv/Conv_output_0, %/up_blocks.1/attn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.0/Shape"](%/up_blocks.1/attn.0/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/attn.0/Gather"](%/up_blocks.1/attn.0/Shape_output_0, %/up_blocks.1/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/attn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/attn.0/Add"](%/up_blocks.1/attn.0/Gather_output_0, %/up_blocks.1/attn.0/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.1/attn.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/attn.0/Div"](%/up_blocks.1/attn.0/Add_output_0, %/up_blocks.1/attn.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/Mul"](%/up_blocks.1/attn.0/Div_output_0, %/up_blocks.1/attn.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Slice_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.0/Slice"](%/up_blocks.1/attn.0/Reshape_output_0, %/up_blocks.1/attn.0/Constant_2_output_0, %/up_blocks.1/attn.0/Mul_output_0, %/up_blocks.1/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/Mul_1"](%/up_blocks.1/attn.0/Div_output_0, %/up_blocks.1/attn.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Slice_1_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.0/Slice_1"](%/up_blocks.1/attn.0/Reshape_output_0, %/up_blocks.1/attn.0/Mul_output_0, %/up_blocks.1/attn.0/Mul_1_output_0, %/up_blocks.1/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.1/attn.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/Mul_2"](%/up_blocks.1/attn.0/Div_output_0, %/up_blocks.1/attn.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Slice_2_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.0/Slice_2"](%/up_blocks.1/attn.0/Reshape_output_0, %/up_blocks.1/attn.0/Mul_1_output_0, %/up_blocks.1/attn.0/Mul_2_output_0, %/up_blocks.1/attn.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.0/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={2.82843}, onnx_name="/up_blocks.1/attn.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.1/attn.0/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.1/attn.0/Reciprocal"](%/up_blocks.1/attn.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.1/attn.0/Mul_3_output_0 : Float(1, 512, 8, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/Mul_3"](%/up_blocks.1/attn.0/Slice_output_0, %/up_blocks.1/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.1/attn.0/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64   8 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.0/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.1/attn.0/Reshape_1_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/Reshape_1"](%/up_blocks.1/attn.0/Mul_3_output_0, %/up_blocks.1/attn.0/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.1/attn.0/Mul_4_output_0 : Float(1, 512, 8, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/Mul_4"](%/up_blocks.1/attn.0/Slice_1_output_0, %/up_blocks.1/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.0/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.0/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.0/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.0/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.0/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.0/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.0/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.0/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.0/Reshape_2_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/Reshape_2"](%/up_blocks.1/attn.0/Mul_4_output_0, %/up_blocks.1/attn.0/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.0/Einsum_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.1/attn.0/Einsum"](%/up_blocks.1/attn.0/Reshape_1_output_0, %/up_blocks.1/attn.0/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.0/Cast_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.0/Cast"](%/up_blocks.1/attn.0/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.0/Softmax_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.1/attn.0/Softmax"](%/up_blocks.1/attn.0/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.0/Cast_1_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.0/Cast_1"](%/up_blocks.1/attn.0/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.0/Reshape_3_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/Reshape_3"](%/up_blocks.1/attn.0/Slice_2_output_0, %/up_blocks.1/attn.0/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.0/Einsum_1_output_0 : Float(*, *, *, strides=[512, 1, 64], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.1/attn.0/Einsum_1"](%/up_blocks.1/attn.0/Cast_1_output_0, %/up_blocks.1/attn.0/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.0/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  8 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.0/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.0/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  8 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.0/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.0/Reshape_4_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/Reshape_4"](%/up_blocks.1/attn.0/Einsum_1_output_0, %/up_blocks.1/attn.0/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.0/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/attn.0/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.1.attn.0.norm_cond.weight, %inner_unet.inner_unet.up_blocks.1.attn.0.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.1/attn.0/kv_cond/MatMul_output_0 : Float(1, 128, 1024, strides=[131072, 1024, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.1/attn.0/kv_cond/MatMul"](%/up_blocks.1/attn.0/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10531), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/attn.0/kv_cond/Add_output_0 : Float(1, 128, 1024, strides=[131072, 1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.0/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.1.attn.0.kv_cond.bias, %/up_blocks.1/attn.0/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/attn.0/Transpose_output_0 : Float(1, 1024, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.1/attn.0/Transpose"](%/up_blocks.1/attn.0/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.1/attn.0/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.0/Shape_1"](%/up_blocks.1/attn.0/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.0/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/attn.0/Gather_1"](%/up_blocks.1/attn.0/Shape_1_output_0, %/up_blocks.1/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/attn.0/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.0/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/attn.0/Add_1"](%/up_blocks.1/attn.0/Gather_1_output_0, %/up_blocks.1/attn.0/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.0/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/attn.0/Div_1"](%/up_blocks.1/attn.0/Add_1_output_0, %/up_blocks.1/attn.0/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.0/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/Mul_5"](%/up_blocks.1/attn.0/Div_1_output_0, %/up_blocks.1/attn.0/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Slice_3_output_0 : Float(1, 512, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.0/Slice_3"](%/up_blocks.1/attn.0/Transpose_output_0, %/up_blocks.1/attn.0/Constant_17_output_0, %/up_blocks.1/attn.0/Mul_5_output_0, %/up_blocks.1/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.0/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/Mul_6"](%/up_blocks.1/attn.0/Div_1_output_0, %/up_blocks.1/attn.0/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Slice_4_output_0 : Float(1, 512, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.0/Slice_4"](%/up_blocks.1/attn.0/Transpose_output_0, %/up_blocks.1/attn.0/Mul_5_output_0, %/up_blocks.1/attn.0/Mul_6_output_0, %/up_blocks.1/attn.0/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.0/Mul_7_output_0 : Float(1, 512, 128, strides=[65536, 1, 512], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/Mul_7"](%/up_blocks.1/attn.0/Slice_3_output_0, %/up_blocks.1/attn.0/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.0/Reshape_5_output_0 : Float(8, 64, 128, strides=[64, 1, 512], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/Reshape_5"](%/up_blocks.1/attn.0/Mul_7_output_0, %/up_blocks.1/attn.0/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.0/Einsum_2_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.1/attn.0/Einsum_2"](%/up_blocks.1/attn.0/Reshape_1_output_0, %/up_blocks.1/attn.0/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.0/Cast_2_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.0/Cast_2"](%/up_blocks.1/attn.0/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.0/Softmax_1_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.1/attn.0/Softmax_1"](%/up_blocks.1/attn.0/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.0/Cast_3_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.0/Cast_3"](%/up_blocks.1/attn.0/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.0/Reshape_6_output_0 : Float(8, 64, 128, strides=[64, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/Reshape_6"](%/up_blocks.1/attn.0/Slice_4_output_0, %/up_blocks.1/attn.0/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.0/Einsum_3_output_0 : Float(*, *, *, strides=[512, 1, 64], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.1/attn.0/Einsum_3"](%/up_blocks.1/attn.0/Cast_3_output_0, %/up_blocks.1/attn.0/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.0/Reshape_7_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/Reshape_7"](%/up_blocks.1/attn.0/Einsum_3_output_0, %/up_blocks.1/attn.0/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.0/Add_2_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.0/Add_2"](%/up_blocks.1/attn.0/Reshape_4_output_0, %/up_blocks.1/attn.0/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.1/attn.0/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  512    4    2 [ CPULongType{4} ], onnx_name="/up_blocks.1/attn.0/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.1/attn.0/Reshape_8_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/Reshape_8"](%/up_blocks.1/attn.0/Add_2_output_0, %/up_blocks.1/attn.0/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.1/attn.0/proj_out/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.0/proj_out/Conv"](%/up_blocks.1/attn.0/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.1.attn.0.proj_out.weight, %inner_unet.inner_unet.up_blocks.1.attn.0.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.0/Add_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.0/Add_3"](%/up_blocks.1/resnets.0/Add_3_output_0, %/up_blocks.1/attn.0/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.1/attn.0/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.0/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/ffn/ffn.0/Reshape"](%/up_blocks.1/attn.0/Add_3_output_0, %/up_blocks.1/attn.0/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.0/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.0/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/attn.0/ffn/ffn.0/InstanceNormalization"](%/up_blocks.1/attn.0/ffn/ffn.0/Reshape_output_0, %/up_blocks.1/attn.0/ffn/ffn.0/Constant_1_output_0, %/up_blocks.1/attn.0/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.0/ffn/ffn.0/Shape"](%/up_blocks.1/attn.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/ffn/ffn.0/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.0/ffn/ffn.0/Reshape_1"](%/up_blocks.1/attn.0/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.1/attn.0/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/ffn/ffn.0/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/ffn/ffn.0/Mul"](%/up_blocks.1/attn.0/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10537), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/ffn/ffn.0/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.0/ffn/ffn.0/Add"](%/up_blocks.1/attn.0/ffn/ffn.0/Mul_output_0, %onnx::Add_10538), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.0/ffn/ffn.1/Conv_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.0/ffn/ffn.1/Conv"](%/up_blocks.1/attn.0/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.1.attn.0.ffn.1.weight, %inner_unet.inner_unet.up_blocks.1.attn.0.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.0/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.1/attn.0/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.0/ffn/ffn.2/Div_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/attn.0/ffn/ffn.2/Div"](%/up_blocks.1/attn.0/ffn/ffn.1/Conv_output_0, %/up_blocks.1/attn.0/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.0/ffn/ffn.2/Erf_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.1/attn.0/ffn/ffn.2/Erf"](%/up_blocks.1/attn.0/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.0/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.0/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.0/ffn/ffn.2/Add_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/attn.0/ffn/ffn.2/Add"](%/up_blocks.1/attn.0/ffn/ffn.2/Erf_output_0, %/up_blocks.1/attn.0/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.0/ffn/ffn.2/Mul_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/ffn/ffn.2/Mul"](%/up_blocks.1/attn.0/ffn/ffn.1/Conv_output_0, %/up_blocks.1/attn.0/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.0/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.1/attn.0/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.0/ffn/ffn.2/Mul_1_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.0/ffn/ffn.2/Mul_1"](%/up_blocks.1/attn.0/ffn/ffn.2/Mul_output_0, %/up_blocks.1/attn.0/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.0/ffn/ffn.3/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.0/ffn/ffn.3/Conv"](%/up_blocks.1/attn.0/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.1.attn.0.ffn.3.weight, %inner_unet.inner_unet.up_blocks.1.attn.0.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.0/Add_4_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.0/Add_4"](%/up_blocks.1/attn.0/ffn/ffn.3/Conv_output_0, %/up_blocks.1/attn.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.1/Concat_1_output_0 : Float(1, 1024, 4, 2, strides=[8192, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.1/Concat_1"](%/up_blocks.1/attn.0/Add_4_output_0, %/down_blocks.1/attn.0/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.1/resnets.1/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.1/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm1/Reshape"](%/up_blocks.1/Concat_1_output_0, %/up_blocks.1/resnets.1/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.1/norm1/InstanceNormalization"](%/up_blocks.1/resnets.1/norm1/Reshape_output_0, %/up_blocks.1/resnets.1/norm1/Constant_1_output_0, %/up_blocks.1/resnets.1/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.1/norm1/Shape"](%/up_blocks.1/Concat_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1/Reshape_1_output_0 : Float(1, 1024, 4, 2, strides=[8192, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm1/Reshape_1"](%/up_blocks.1/resnets.1/norm1/InstanceNormalization_output_0, %/up_blocks.1/resnets.1/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1/Mul_output_0 : Float(1, 1024, 4, 2, strides=[8192, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/norm1/Mul"](%/up_blocks.1/resnets.1/norm1/Reshape_1_output_0, %onnx::Mul_10539), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1/Add_output_0 : Float(1, 1024, 4, 2, strides=[8192, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1/norm1/Add"](%/up_blocks.1/resnets.1/norm1/Mul_output_0, %onnx::Add_10540), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/Sigmoid_output_0 : Float(1, 1024, 4, 2, strides=[8192, 8, 2, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.1/Sigmoid"](%/up_blocks.1/resnets.1/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1/Mul_output_0 : Float(1, 1024, 4, 2, strides=[8192, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/Mul"](%/up_blocks.1/resnets.1/norm1/Add_output_0, %/up_blocks.1/resnets.1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1/conv1/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.1/conv1/Conv"](%/up_blocks.1/resnets.1/Mul_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.1.conv1.weight, %inner_unet.inner_unet.up_blocks.1.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.1/time_layer/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.1/resnets.1/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.1.time_layer.weight, %inner_unet.inner_unet.up_blocks.1.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/resnets.1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Unsqueeze_output_0 : Float(1, 1024, 1, strides=[1024, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.1/Unsqueeze"](%/up_blocks.1/resnets.1/time_layer/Gemm_output_0, %/up_blocks.1/resnets.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Unsqueeze_1_output_0 : Float(1, 1024, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.1/Unsqueeze_1"](%/up_blocks.1/resnets.1/Unsqueeze_output_0, %/up_blocks.1/resnets.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.1/Shape"](%/up_blocks.1/resnets.1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/resnets.1/Gather"](%/up_blocks.1/resnets.1/Shape_output_0, %/up_blocks.1/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/resnets.1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/resnets.1/Add"](%/up_blocks.1/resnets.1/Gather_output_0, %/up_blocks.1/resnets.1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/resnets.1/Div"](%/up_blocks.1/resnets.1/Add_output_0, %/up_blocks.1/resnets.1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/Mul_1"](%/up_blocks.1/resnets.1/Div_output_0, %/up_blocks.1/resnets.1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Slice_output_0 : Float(1, 512, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.1/Slice"](%/up_blocks.1/resnets.1/Unsqueeze_1_output_0, %/up_blocks.1/resnets.1/Constant_3_output_0, %/up_blocks.1/resnets.1/Mul_1_output_0, %/up_blocks.1/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/Mul_2"](%/up_blocks.1/resnets.1/Div_output_0, %/up_blocks.1/resnets.1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/Slice_1_output_0 : Float(1, 512, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.1/Slice_1"](%/up_blocks.1/resnets.1/Unsqueeze_1_output_0, %/up_blocks.1/resnets.1/Mul_1_output_0, %/up_blocks.1/resnets.1/Mul_2_output_0, %/up_blocks.1/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.1/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm2/Reshape"](%/up_blocks.1/resnets.1/conv1/Conv_output_0, %/up_blocks.1/resnets.1/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.1/norm2/InstanceNormalization"](%/up_blocks.1/resnets.1/norm2/Reshape_output_0, %/up_blocks.1/resnets.1/norm2/Constant_1_output_0, %/up_blocks.1/resnets.1/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.1/norm2/Shape"](%/up_blocks.1/resnets.1/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm2/Reshape_1"](%/up_blocks.1/resnets.1/norm2/InstanceNormalization_output_0, %/up_blocks.1/resnets.1/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/norm2/Mul"](%/up_blocks.1/resnets.1/norm2/Reshape_1_output_0, %onnx::Mul_10541), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1/norm2/Add"](%/up_blocks.1/resnets.1/norm2/Mul_output_0, %onnx::Add_10542), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1/Add_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1/Add_1"](%/up_blocks.1/resnets.1/Slice_output_0, %/up_blocks.1/resnets.1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1/Mul_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/Mul_3"](%/up_blocks.1/resnets.1/norm2/Add_output_0, %/up_blocks.1/resnets.1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1/Add_2_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1/Add_2"](%/up_blocks.1/resnets.1/Mul_3_output_0, %/up_blocks.1/resnets.1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1/Sigmoid_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.1/Sigmoid_1"](%/up_blocks.1/resnets.1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1/Mul_4_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/Mul_4"](%/up_blocks.1/resnets.1/Add_2_output_0, %/up_blocks.1/resnets.1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1/conv2/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.1/conv2/Conv"](%/up_blocks.1/resnets.1/Mul_4_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.1.conv2.weight, %inner_unet.inner_unet.up_blocks.1.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.1/conv3/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/resnets.1/conv3/Conv"](%/up_blocks.1/Concat_1_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.1.conv3.weight, %inner_unet.inner_unet.up_blocks.1.resnets.1.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.1/Add_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1/Add_3"](%/up_blocks.1/resnets.1/conv2/Conv_output_0, %/up_blocks.1/resnets.1/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.1/attn.1/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.1/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/norm/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/norm/Reshape"](%/up_blocks.1/resnets.1/Add_3_output_0, %/up_blocks.1/attn.1/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.1/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.1/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/norm/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/attn.1/norm/InstanceNormalization"](%/up_blocks.1/attn.1/norm/Reshape_output_0, %/up_blocks.1/attn.1/norm/Constant_1_output_0, %/up_blocks.1/attn.1/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.1/norm/Shape"](%/up_blocks.1/resnets.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/norm/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/norm/Reshape_1"](%/up_blocks.1/attn.1/norm/InstanceNormalization_output_0, %/up_blocks.1/attn.1/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/norm/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/norm/Mul"](%/up_blocks.1/attn.1/norm/Reshape_1_output_0, %onnx::Mul_10543), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/norm/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.1/norm/Add"](%/up_blocks.1/attn.1/norm/Mul_output_0, %onnx::Add_10544), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/qkv/Conv_output_0 : Float(1, 1536, 4, 2, strides=[12288, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.1/qkv/Conv"](%/up_blocks.1/attn.1/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.1.attn.1.qkv.weight, %inner_unet.inner_unet.up_blocks.1.attn.1.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.1/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  1536    -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Reshape_output_0 : Float(1, 1536, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/Reshape"](%/up_blocks.1/attn.1/qkv/Conv_output_0, %/up_blocks.1/attn.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.1/Shape"](%/up_blocks.1/attn.1/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/attn.1/Gather"](%/up_blocks.1/attn.1/Shape_output_0, %/up_blocks.1/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/attn.1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/attn.1/Add"](%/up_blocks.1/attn.1/Gather_output_0, %/up_blocks.1/attn.1/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.1/attn.1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/attn.1/Div"](%/up_blocks.1/attn.1/Add_output_0, %/up_blocks.1/attn.1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/Mul"](%/up_blocks.1/attn.1/Div_output_0, %/up_blocks.1/attn.1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Slice_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.1/Slice"](%/up_blocks.1/attn.1/Reshape_output_0, %/up_blocks.1/attn.1/Constant_2_output_0, %/up_blocks.1/attn.1/Mul_output_0, %/up_blocks.1/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/Mul_1"](%/up_blocks.1/attn.1/Div_output_0, %/up_blocks.1/attn.1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Slice_1_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.1/Slice_1"](%/up_blocks.1/attn.1/Reshape_output_0, %/up_blocks.1/attn.1/Mul_output_0, %/up_blocks.1/attn.1/Mul_1_output_0, %/up_blocks.1/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.1/attn.1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/Mul_2"](%/up_blocks.1/attn.1/Div_output_0, %/up_blocks.1/attn.1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Slice_2_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.1/Slice_2"](%/up_blocks.1/attn.1/Reshape_output_0, %/up_blocks.1/attn.1/Mul_1_output_0, %/up_blocks.1/attn.1/Mul_2_output_0, %/up_blocks.1/attn.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.1/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={2.82843}, onnx_name="/up_blocks.1/attn.1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.1/attn.1/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.1/attn.1/Reciprocal"](%/up_blocks.1/attn.1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.1/attn.1/Mul_3_output_0 : Float(1, 512, 8, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/Mul_3"](%/up_blocks.1/attn.1/Slice_output_0, %/up_blocks.1/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.1/attn.1/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64   8 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.1/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.1/attn.1/Reshape_1_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/Reshape_1"](%/up_blocks.1/attn.1/Mul_3_output_0, %/up_blocks.1/attn.1/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.1/attn.1/Mul_4_output_0 : Float(1, 512, 8, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/Mul_4"](%/up_blocks.1/attn.1/Slice_1_output_0, %/up_blocks.1/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.1/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.1/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.1/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.1/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.1/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.1/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.1/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.1/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.1/Reshape_2_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/Reshape_2"](%/up_blocks.1/attn.1/Mul_4_output_0, %/up_blocks.1/attn.1/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.1/Einsum_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.1/attn.1/Einsum"](%/up_blocks.1/attn.1/Reshape_1_output_0, %/up_blocks.1/attn.1/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.1/Cast_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.1/Cast"](%/up_blocks.1/attn.1/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.1/Softmax_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.1/attn.1/Softmax"](%/up_blocks.1/attn.1/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.1/Cast_1_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.1/Cast_1"](%/up_blocks.1/attn.1/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.1/Reshape_3_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/Reshape_3"](%/up_blocks.1/attn.1/Slice_2_output_0, %/up_blocks.1/attn.1/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.1/Einsum_1_output_0 : Float(*, *, *, strides=[512, 1, 64], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.1/attn.1/Einsum_1"](%/up_blocks.1/attn.1/Cast_1_output_0, %/up_blocks.1/attn.1/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.1/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  8 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.1/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.1/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  8 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.1/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.1/Reshape_4_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/Reshape_4"](%/up_blocks.1/attn.1/Einsum_1_output_0, %/up_blocks.1/attn.1/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.1/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/attn.1/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.1.attn.1.norm_cond.weight, %inner_unet.inner_unet.up_blocks.1.attn.1.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.1/attn.1/kv_cond/MatMul_output_0 : Float(1, 128, 1024, strides=[131072, 1024, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.1/attn.1/kv_cond/MatMul"](%/up_blocks.1/attn.1/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10577), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/attn.1/kv_cond/Add_output_0 : Float(1, 128, 1024, strides=[131072, 1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.1/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.1.attn.1.kv_cond.bias, %/up_blocks.1/attn.1/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/attn.1/Transpose_output_0 : Float(1, 1024, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.1/attn.1/Transpose"](%/up_blocks.1/attn.1/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.1/attn.1/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.1/Shape_1"](%/up_blocks.1/attn.1/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.1/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/attn.1/Gather_1"](%/up_blocks.1/attn.1/Shape_1_output_0, %/up_blocks.1/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/attn.1/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.1/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/attn.1/Add_1"](%/up_blocks.1/attn.1/Gather_1_output_0, %/up_blocks.1/attn.1/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.1/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/attn.1/Div_1"](%/up_blocks.1/attn.1/Add_1_output_0, %/up_blocks.1/attn.1/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.1/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/Mul_5"](%/up_blocks.1/attn.1/Div_1_output_0, %/up_blocks.1/attn.1/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Slice_3_output_0 : Float(1, 512, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.1/Slice_3"](%/up_blocks.1/attn.1/Transpose_output_0, %/up_blocks.1/attn.1/Constant_17_output_0, %/up_blocks.1/attn.1/Mul_5_output_0, %/up_blocks.1/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.1/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/Mul_6"](%/up_blocks.1/attn.1/Div_1_output_0, %/up_blocks.1/attn.1/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Slice_4_output_0 : Float(1, 512, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.1/Slice_4"](%/up_blocks.1/attn.1/Transpose_output_0, %/up_blocks.1/attn.1/Mul_5_output_0, %/up_blocks.1/attn.1/Mul_6_output_0, %/up_blocks.1/attn.1/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.1/Mul_7_output_0 : Float(1, 512, 128, strides=[65536, 1, 512], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/Mul_7"](%/up_blocks.1/attn.1/Slice_3_output_0, %/up_blocks.1/attn.1/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.1/Reshape_5_output_0 : Float(8, 64, 128, strides=[64, 1, 512], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/Reshape_5"](%/up_blocks.1/attn.1/Mul_7_output_0, %/up_blocks.1/attn.1/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.1/Einsum_2_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.1/attn.1/Einsum_2"](%/up_blocks.1/attn.1/Reshape_1_output_0, %/up_blocks.1/attn.1/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.1/Cast_2_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.1/Cast_2"](%/up_blocks.1/attn.1/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.1/Softmax_1_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.1/attn.1/Softmax_1"](%/up_blocks.1/attn.1/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.1/Cast_3_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.1/Cast_3"](%/up_blocks.1/attn.1/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.1/Reshape_6_output_0 : Float(8, 64, 128, strides=[64, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/Reshape_6"](%/up_blocks.1/attn.1/Slice_4_output_0, %/up_blocks.1/attn.1/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.1/Einsum_3_output_0 : Float(*, *, *, strides=[512, 1, 64], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.1/attn.1/Einsum_3"](%/up_blocks.1/attn.1/Cast_3_output_0, %/up_blocks.1/attn.1/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.1/Reshape_7_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/Reshape_7"](%/up_blocks.1/attn.1/Einsum_3_output_0, %/up_blocks.1/attn.1/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.1/Add_2_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.1/Add_2"](%/up_blocks.1/attn.1/Reshape_4_output_0, %/up_blocks.1/attn.1/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.1/attn.1/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  512    4    2 [ CPULongType{4} ], onnx_name="/up_blocks.1/attn.1/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.1/attn.1/Reshape_8_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/Reshape_8"](%/up_blocks.1/attn.1/Add_2_output_0, %/up_blocks.1/attn.1/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.1/attn.1/proj_out/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.1/proj_out/Conv"](%/up_blocks.1/attn.1/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.1.attn.1.proj_out.weight, %inner_unet.inner_unet.up_blocks.1.attn.1.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.1/Add_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.1/Add_3"](%/up_blocks.1/resnets.1/Add_3_output_0, %/up_blocks.1/attn.1/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.1/attn.1/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.1/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/ffn/ffn.0/Reshape"](%/up_blocks.1/attn.1/Add_3_output_0, %/up_blocks.1/attn.1/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.1/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.1/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/attn.1/ffn/ffn.0/InstanceNormalization"](%/up_blocks.1/attn.1/ffn/ffn.0/Reshape_output_0, %/up_blocks.1/attn.1/ffn/ffn.0/Constant_1_output_0, %/up_blocks.1/attn.1/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.1/ffn/ffn.0/Shape"](%/up_blocks.1/attn.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/ffn/ffn.0/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.1/ffn/ffn.0/Reshape_1"](%/up_blocks.1/attn.1/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.1/attn.1/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/ffn/ffn.0/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/ffn/ffn.0/Mul"](%/up_blocks.1/attn.1/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10583), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/ffn/ffn.0/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.1/ffn/ffn.0/Add"](%/up_blocks.1/attn.1/ffn/ffn.0/Mul_output_0, %onnx::Add_10584), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.1/ffn/ffn.1/Conv_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.1/ffn/ffn.1/Conv"](%/up_blocks.1/attn.1/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.1.attn.1.ffn.1.weight, %inner_unet.inner_unet.up_blocks.1.attn.1.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.1/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.1/attn.1/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.1/ffn/ffn.2/Div_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/attn.1/ffn/ffn.2/Div"](%/up_blocks.1/attn.1/ffn/ffn.1/Conv_output_0, %/up_blocks.1/attn.1/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.1/ffn/ffn.2/Erf_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.1/attn.1/ffn/ffn.2/Erf"](%/up_blocks.1/attn.1/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.1/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.1/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.1/ffn/ffn.2/Add_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/attn.1/ffn/ffn.2/Add"](%/up_blocks.1/attn.1/ffn/ffn.2/Erf_output_0, %/up_blocks.1/attn.1/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.1/ffn/ffn.2/Mul_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/ffn/ffn.2/Mul"](%/up_blocks.1/attn.1/ffn/ffn.1/Conv_output_0, %/up_blocks.1/attn.1/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.1/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.1/attn.1/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.1/ffn/ffn.2/Mul_1_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.1/ffn/ffn.2/Mul_1"](%/up_blocks.1/attn.1/ffn/ffn.2/Mul_output_0, %/up_blocks.1/attn.1/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.1/ffn/ffn.3/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.1/ffn/ffn.3/Conv"](%/up_blocks.1/attn.1/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.1.attn.1.ffn.3.weight, %inner_unet.inner_unet.up_blocks.1.attn.1.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.1/Add_4_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.1/Add_4"](%/up_blocks.1/attn.1/ffn/ffn.3/Conv_output_0, %/up_blocks.1/attn.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.1/Concat_2_output_0 : Float(1, 768, 4, 2, strides=[6144, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.1/Concat_2"](%/up_blocks.1/attn.1/Add_4_output_0, %/down_blocks.0/resample_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.1/resnets.2/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.2/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1/Reshape_output_0 : Float(1, 32, 192, strides=[6144, 192, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm1/Reshape"](%/up_blocks.1/Concat_2_output_0, %/up_blocks.1/resnets.2/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1/InstanceNormalization_output_0 : Float(1, 32, 192, strides=[6144, 192, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.2/norm1/InstanceNormalization"](%/up_blocks.1/resnets.2/norm1/Reshape_output_0, %/up_blocks.1/resnets.2/norm1/Constant_1_output_0, %/up_blocks.1/resnets.2/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.2/norm1/Shape"](%/up_blocks.1/Concat_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1/Reshape_1_output_0 : Float(1, 768, 4, 2, strides=[6144, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm1/Reshape_1"](%/up_blocks.1/resnets.2/norm1/InstanceNormalization_output_0, %/up_blocks.1/resnets.2/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1/Mul_output_0 : Float(1, 768, 4, 2, strides=[6144, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/norm1/Mul"](%/up_blocks.1/resnets.2/norm1/Reshape_1_output_0, %onnx::Mul_10585), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1/Add_output_0 : Float(1, 768, 4, 2, strides=[6144, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2/norm1/Add"](%/up_blocks.1/resnets.2/norm1/Mul_output_0, %onnx::Add_10586), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/Sigmoid_output_0 : Float(1, 768, 4, 2, strides=[6144, 8, 2, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.2/Sigmoid"](%/up_blocks.1/resnets.2/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2/Mul_output_0 : Float(1, 768, 4, 2, strides=[6144, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/Mul"](%/up_blocks.1/resnets.2/norm1/Add_output_0, %/up_blocks.1/resnets.2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2/conv1/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.2/conv1/Conv"](%/up_blocks.1/resnets.2/Mul_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.2.conv1.weight, %inner_unet.inner_unet.up_blocks.1.resnets.2.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.2/time_layer/Gemm_output_0 : Float(1, 1024, strides=[1024, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.1/resnets.2/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.2.time_layer.weight, %inner_unet.inner_unet.up_blocks.1.resnets.2.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/resnets.2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Unsqueeze_output_0 : Float(1, 1024, 1, strides=[1024, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.2/Unsqueeze"](%/up_blocks.1/resnets.2/time_layer/Gemm_output_0, %/up_blocks.1/resnets.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Unsqueeze_1_output_0 : Float(1, 1024, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.2/Unsqueeze_1"](%/up_blocks.1/resnets.2/Unsqueeze_output_0, %/up_blocks.1/resnets.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.2/Shape"](%/up_blocks.1/resnets.2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/resnets.2/Gather"](%/up_blocks.1/resnets.2/Shape_output_0, %/up_blocks.1/resnets.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/resnets.2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/resnets.2/Add"](%/up_blocks.1/resnets.2/Gather_output_0, %/up_blocks.1/resnets.2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/resnets.2/Div"](%/up_blocks.1/resnets.2/Add_output_0, %/up_blocks.1/resnets.2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/Mul_1"](%/up_blocks.1/resnets.2/Div_output_0, %/up_blocks.1/resnets.2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Slice_output_0 : Float(1, 512, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.2/Slice"](%/up_blocks.1/resnets.2/Unsqueeze_1_output_0, %/up_blocks.1/resnets.2/Constant_3_output_0, %/up_blocks.1/resnets.2/Mul_1_output_0, %/up_blocks.1/resnets.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/Mul_2"](%/up_blocks.1/resnets.2/Div_output_0, %/up_blocks.1/resnets.2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/Slice_1_output_0 : Float(1, 512, 1, 1, strides=[1024, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.2/Slice_1"](%/up_blocks.1/resnets.2/Unsqueeze_1_output_0, %/up_blocks.1/resnets.2/Mul_1_output_0, %/up_blocks.1/resnets.2/Mul_2_output_0, %/up_blocks.1/resnets.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.2/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm2/Reshape"](%/up_blocks.1/resnets.2/conv1/Conv_output_0, %/up_blocks.1/resnets.2/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.2/norm2/InstanceNormalization"](%/up_blocks.1/resnets.2/norm2/Reshape_output_0, %/up_blocks.1/resnets.2/norm2/Constant_1_output_0, %/up_blocks.1/resnets.2/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.2/norm2/Shape"](%/up_blocks.1/resnets.2/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm2/Reshape_1"](%/up_blocks.1/resnets.2/norm2/InstanceNormalization_output_0, %/up_blocks.1/resnets.2/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/norm2/Mul"](%/up_blocks.1/resnets.2/norm2/Reshape_1_output_0, %onnx::Mul_10587), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2/norm2/Add"](%/up_blocks.1/resnets.2/norm2/Mul_output_0, %onnx::Add_10588), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2/Add_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2/Add_1"](%/up_blocks.1/resnets.2/Slice_output_0, %/up_blocks.1/resnets.2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2/Mul_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/Mul_3"](%/up_blocks.1/resnets.2/norm2/Add_output_0, %/up_blocks.1/resnets.2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2/Add_2_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2/Add_2"](%/up_blocks.1/resnets.2/Mul_3_output_0, %/up_blocks.1/resnets.2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2/Sigmoid_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.2/Sigmoid_1"](%/up_blocks.1/resnets.2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2/Mul_4_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/Mul_4"](%/up_blocks.1/resnets.2/Add_2_output_0, %/up_blocks.1/resnets.2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2/conv2/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.2/conv2/Conv"](%/up_blocks.1/resnets.2/Mul_4_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.2.conv2.weight, %inner_unet.inner_unet.up_blocks.1.resnets.2.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.2/conv3/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/resnets.2/conv3/Conv"](%/up_blocks.1/Concat_2_output_0, %inner_unet.inner_unet.up_blocks.1.resnets.2.conv3.weight, %inner_unet.inner_unet.up_blocks.1.resnets.2.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.2/Add_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2/Add_3"](%/up_blocks.1/resnets.2/conv2/Conv_output_0, %/up_blocks.1/resnets.2/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.1/attn.2/norm/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.2/norm/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/norm/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/norm/Reshape"](%/up_blocks.1/resnets.2/Add_3_output_0, %/up_blocks.1/attn.2/norm/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/norm/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.2/norm/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/norm/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.2/norm/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/norm/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/attn.2/norm/InstanceNormalization"](%/up_blocks.1/attn.2/norm/Reshape_output_0, %/up_blocks.1/attn.2/norm/Constant_1_output_0, %/up_blocks.1/attn.2/norm/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/norm/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.2/norm/Shape"](%/up_blocks.1/resnets.2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/norm/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/norm/Reshape_1"](%/up_blocks.1/attn.2/norm/InstanceNormalization_output_0, %/up_blocks.1/attn.2/norm/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/norm/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/norm/Mul"](%/up_blocks.1/attn.2/norm/Reshape_1_output_0, %onnx::Mul_10589), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/norm/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.2/norm/Add"](%/up_blocks.1/attn.2/norm/Mul_output_0, %onnx::Add_10590), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.GroupNorm::norm # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/qkv/Conv_output_0 : Float(1, 1536, 4, 2, strides=[12288, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.2/qkv/Conv"](%/up_blocks.1/attn.2/norm/Add_output_0, %inner_unet.inner_unet.up_blocks.1.attn.2.qkv.weight, %inner_unet.inner_unet.up_blocks.1.attn.2.qkv.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.conv.Conv2d::qkv # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.2/Constant_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=    1  1536    -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Reshape_output_0 : Float(1, 1536, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/Reshape"](%/up_blocks.1/attn.2/qkv/Conv_output_0, %/up_blocks.1/attn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Shape_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.2/Shape"](%/up_blocks.1/attn.2/Reshape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/attn.2/Gather"](%/up_blocks.1/attn.2/Shape_output_0, %/up_blocks.1/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/attn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Constant_3_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/attn.2/Add"](%/up_blocks.1/attn.2/Gather_output_0, %/up_blocks.1/attn.2/Constant_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.1/attn.2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/attn.2/Div"](%/up_blocks.1/attn.2/Add_output_0, %/up_blocks.1/attn.2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Mul_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/Mul"](%/up_blocks.1/attn.2/Div_output_0, %/up_blocks.1/attn.2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Slice_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.2/Slice"](%/up_blocks.1/attn.2/Reshape_output_0, %/up_blocks.1/attn.2/Constant_2_output_0, %/up_blocks.1/attn.2/Mul_output_0, %/up_blocks.1/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/Mul_1"](%/up_blocks.1/attn.2/Div_output_0, %/up_blocks.1/attn.2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Slice_1_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.2/Slice_1"](%/up_blocks.1/attn.2/Reshape_output_0, %/up_blocks.1/attn.2/Mul_output_0, %/up_blocks.1/attn.2/Mul_1_output_0, %/up_blocks.1/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={3}, onnx_name="/up_blocks.1/attn.2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/Mul_2"](%/up_blocks.1/attn.2/Div_output_0, %/up_blocks.1/attn.2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Slice_2_output_0 : Float(1, 512, 8, strides=[12288, 8, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.2/Slice_2"](%/up_blocks.1/attn.2/Reshape_output_0, %/up_blocks.1/attn.2/Mul_1_output_0, %/up_blocks.1/attn.2/Mul_2_output_0, %/up_blocks.1/attn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:346:0
  %/up_blocks.1/attn.2/Constant_8_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Constant[value={2.82843}, onnx_name="/up_blocks.1/attn.2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:296:0
  %/up_blocks.1/attn.2/Reciprocal_output_0 : Float(requires_grad=0, device=cuda:0) = onnx::Reciprocal[onnx_name="/up_blocks.1/attn.2/Reciprocal"](%/up_blocks.1/attn.2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/_tensor.py:970:0
  %/up_blocks.1/attn.2/Mul_3_output_0 : Float(1, 512, 8, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/Mul_3"](%/up_blocks.1/attn.2/Slice_output_0, %/up_blocks.1/attn.2/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.1/attn.2/Constant_9_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64   8 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.2/Constant_9"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.1/attn.2/Reshape_1_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/Reshape_1"](%/up_blocks.1/attn.2/Mul_3_output_0, %/up_blocks.1/attn.2/Constant_9_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:299:0
  %/up_blocks.1/attn.2/Mul_4_output_0 : Float(1, 512, 8, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/Mul_4"](%/up_blocks.1/attn.2/Slice_1_output_0, %/up_blocks.1/attn.2/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.2/Constant_10_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.2/Constant_10"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.2/Constant_11_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.2/Constant_11"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.2/Constant_12_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.2/Constant_12"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.2/Constant_13_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=  8  64  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.2/Constant_13"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.2/Reshape_2_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/Reshape_2"](%/up_blocks.1/attn.2/Mul_4_output_0, %/up_blocks.1/attn.2/Constant_10_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.2/Einsum_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.1/attn.2/Einsum"](%/up_blocks.1/attn.2/Reshape_1_output_0, %/up_blocks.1/attn.2/Reshape_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.2/Cast_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.2/Cast"](%/up_blocks.1/attn.2/Einsum_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.2/Softmax_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.1/attn.2/Softmax"](%/up_blocks.1/attn.2/Cast_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.2/Cast_1_output_0 : Float(*, *, *, strides=[64, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.2/Cast_1"](%/up_blocks.1/attn.2/Softmax_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.2/Reshape_3_output_0 : Float(8, 64, 8, strides=[512, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/Reshape_3"](%/up_blocks.1/attn.2/Slice_2_output_0, %/up_blocks.1/attn.2/Constant_11_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.2/Einsum_1_output_0 : Float(*, *, *, strides=[512, 1, 64], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.1/attn.2/Einsum_1"](%/up_blocks.1/attn.2/Cast_1_output_0, %/up_blocks.1/attn.2/Reshape_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.2/Constant_14_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  8 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.2/Constant_14"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.2/Constant_15_output_0 : Long(3, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1 -1  8 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.2/Constant_15"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.2/Reshape_4_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/Reshape_4"](%/up_blocks.1/attn.2/Einsum_1_output_0, %/up_blocks.1/attn.2/Constant_14_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.2/norm_cond/LayerNormalization_output_0 : Float(1, 128, 2048, strides=[262144, 2048, 1], requires_grad=0, device=cuda:0) = onnx::LayerNormalization[axis=-1, epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/attn.2/norm_cond/LayerNormalization"](%/lm_proj/Add_output_0, %inner_unet.inner_unet.up_blocks.1.attn.2.norm_cond.weight, %inner_unet.inner_unet.up_blocks.1.attn.2.norm_cond.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.normalization.LayerNorm::norm_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2573:0
  %/up_blocks.1/attn.2/kv_cond/MatMul_output_0 : Float(1, 128, 1024, strides=[131072, 1024, 1], device=cpu) = onnx::MatMul[onnx_name="/up_blocks.1/attn.2/kv_cond/MatMul"](%/up_blocks.1/attn.2/norm_cond/LayerNormalization_output_0, %onnx::MatMul_10623), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/attn.2/kv_cond/Add_output_0 : Float(1, 128, 1024, strides=[131072, 1024, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.2/kv_cond/Add"](%inner_unet.inner_unet.up_blocks.1.attn.2.kv_cond.bias, %/up_blocks.1/attn.2/kv_cond/MatMul_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.linear.Linear::kv_cond # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/attn.2/Transpose_output_0 : Float(1, 1024, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Transpose[perm=[0, 2, 1], onnx_name="/up_blocks.1/attn.2/Transpose"](%/up_blocks.1/attn.2/kv_cond/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:368:0
  %/up_blocks.1/attn.2/Shape_1_output_0 : Long(3, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.2/Shape_1"](%/up_blocks.1/attn.2/Transpose_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Constant_16_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.2/Constant_16"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Gather_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/attn.2/Gather_1"](%/up_blocks.1/attn.2/Shape_1_output_0, %/up_blocks.1/attn.2/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Constant_17_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/attn.2/Constant_17"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Constant_18_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.2/Constant_18"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Add_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/attn.2/Add_1"](%/up_blocks.1/attn.2/Gather_1_output_0, %/up_blocks.1/attn.2/Constant_18_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Constant_19_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.2/Constant_19"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Div_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/attn.2/Div_1"](%/up_blocks.1/attn.2/Add_1_output_0, %/up_blocks.1/attn.2/Constant_19_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Constant_20_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.2/Constant_20"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Mul_5_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/Mul_5"](%/up_blocks.1/attn.2/Div_1_output_0, %/up_blocks.1/attn.2/Constant_20_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Slice_3_output_0 : Float(1, 512, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.2/Slice_3"](%/up_blocks.1/attn.2/Transpose_output_0, %/up_blocks.1/attn.2/Constant_17_output_0, %/up_blocks.1/attn.2/Mul_5_output_0, %/up_blocks.1/attn.2/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Constant_21_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/attn.2/Constant_21"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Mul_6_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/Mul_6"](%/up_blocks.1/attn.2/Div_1_output_0, %/up_blocks.1/attn.2/Constant_21_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Slice_4_output_0 : Float(1, 512, 128, strides=[131072, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/attn.2/Slice_4"](%/up_blocks.1/attn.2/Transpose_output_0, %/up_blocks.1/attn.2/Mul_5_output_0, %/up_blocks.1/attn.2/Mul_6_output_0, %/up_blocks.1/attn.2/Constant_16_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:369:0
  %/up_blocks.1/attn.2/Mul_7_output_0 : Float(1, 512, 128, strides=[65536, 1, 512], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/Mul_7"](%/up_blocks.1/attn.2/Slice_3_output_0, %/up_blocks.1/attn.2/Reciprocal_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.2/Reshape_5_output_0 : Float(8, 64, 128, strides=[64, 1, 512], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/Reshape_5"](%/up_blocks.1/attn.2/Mul_7_output_0, %/up_blocks.1/attn.2/Constant_12_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:300:0
  %/up_blocks.1/attn.2/Einsum_2_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bct,bcs->bts", onnx_name="/up_blocks.1/attn.2/Einsum_2"](%/up_blocks.1/attn.2/Reshape_1_output_0, %/up_blocks.1/attn.2/Reshape_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.2/Cast_2_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.2/Cast_2"](%/up_blocks.1/attn.2/Einsum_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.2/Softmax_1_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Softmax[axis=-1, onnx_name="/up_blocks.1/attn.2/Softmax_1"](%/up_blocks.1/attn.2/Cast_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.2/Cast_3_output_0 : Float(*, *, *, strides=[1024, 128, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/attn.2/Cast_3"](%/up_blocks.1/attn.2/Softmax_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:309:0
  %/up_blocks.1/attn.2/Reshape_6_output_0 : Float(8, 64, 128, strides=[64, 1, 1024], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/Reshape_6"](%/up_blocks.1/attn.2/Slice_4_output_0, %/up_blocks.1/attn.2/Constant_13_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:310:0
  %/up_blocks.1/attn.2/Einsum_3_output_0 : Float(*, *, *, strides=[512, 1, 64], requires_grad=0, device=cuda:0) = onnx::Einsum[equation="bts,bcs->bct", onnx_name="/up_blocks.1/attn.2/Einsum_3"](%/up_blocks.1/attn.2/Cast_3_output_0, %/up_blocks.1/attn.2/Reshape_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/functional.py:385:0
  %/up_blocks.1/attn.2/Reshape_7_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/Reshape_7"](%/up_blocks.1/attn.2/Einsum_3_output_0, %/up_blocks.1/attn.2/Constant_15_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:311:0
  %/up_blocks.1/attn.2/Add_2_output_0 : Float(*, *, *, strides=[4096, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.2/Add_2"](%/up_blocks.1/attn.2/Reshape_4_output_0, %/up_blocks.1/attn.2/Reshape_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:371:0
  %/up_blocks.1/attn.2/Constant_22_output_0 : Long(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value=   1  512    4    2 [ CPULongType{4} ], onnx_name="/up_blocks.1/attn.2/Constant_22"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.1/attn.2/Reshape_8_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/Reshape_8"](%/up_blocks.1/attn.2/Add_2_output_0, %/up_blocks.1/attn.2/Constant_22_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:372:0
  %/up_blocks.1/attn.2/proj_out/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.2/proj_out/Conv"](%/up_blocks.1/attn.2/Reshape_8_output_0, %inner_unet.inner_unet.up_blocks.1.attn.2.proj_out.weight, %inner_unet.inner_unet.up_blocks.1.attn.2.proj_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.conv.Conv2d::proj_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.2/Add_3_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.2/Add_3"](%/up_blocks.1/resnets.2/Add_3_output_0, %/up_blocks.1/attn.2/proj_out/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:374:0
  %/up_blocks.1/attn.2/ffn/ffn.0/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/attn.2/ffn/ffn.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/ffn/ffn.0/Reshape_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/ffn/ffn.0/Reshape"](%/up_blocks.1/attn.2/Add_3_output_0, %/up_blocks.1/attn.2/ffn/ffn.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/ffn/ffn.0/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.2/ffn/ffn.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/ffn/ffn.0/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/attn.2/ffn/ffn.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/ffn/ffn.0/InstanceNormalization_output_0 : Float(1, 32, 128, strides=[4096, 128, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/attn.2/ffn/ffn.0/InstanceNormalization"](%/up_blocks.1/attn.2/ffn/ffn.0/Reshape_output_0, %/up_blocks.1/attn.2/ffn/ffn.0/Constant_1_output_0, %/up_blocks.1/attn.2/ffn/ffn.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/ffn/ffn.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/attn.2/ffn/ffn.0/Shape"](%/up_blocks.1/attn.2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/ffn/ffn.0/Reshape_1_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/attn.2/ffn/ffn.0/Reshape_1"](%/up_blocks.1/attn.2/ffn/ffn.0/InstanceNormalization_output_0, %/up_blocks.1/attn.2/ffn/ffn.0/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/ffn/ffn.0/Mul_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/ffn/ffn.0/Mul"](%/up_blocks.1/attn.2/ffn/ffn.0/Reshape_1_output_0, %onnx::Mul_10629), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/ffn/ffn.0/Add_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.2/ffn/ffn.0/Add"](%/up_blocks.1/attn.2/ffn/ffn.0/Mul_output_0, %onnx::Add_10630), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.normalization.GroupNorm::ffn.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/attn.2/ffn/ffn.1/Conv_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.2/ffn/ffn.1/Conv"](%/up_blocks.1/attn.2/ffn/ffn.0/Add_output_0, %inner_unet.inner_unet.up_blocks.1.attn.2.ffn.1.weight, %inner_unet.inner_unet.up_blocks.1.attn.2.ffn.1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.2/ffn/ffn.2/Constant_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1.41421}, onnx_name="/up_blocks.1/attn.2/ffn/ffn.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.2/ffn/ffn.2/Div_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/attn.2/ffn/ffn.2/Div"](%/up_blocks.1/attn.2/ffn/ffn.1/Conv_output_0, %/up_blocks.1/attn.2/ffn/ffn.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.2/ffn/ffn.2/Erf_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Erf[onnx_name="/up_blocks.1/attn.2/ffn/ffn.2/Erf"](%/up_blocks.1/attn.2/ffn/ffn.2/Div_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.2/ffn/ffn.2/Constant_1_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/attn.2/ffn/ffn.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.2/ffn/ffn.2/Add_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/attn.2/ffn/ffn.2/Add"](%/up_blocks.1/attn.2/ffn/ffn.2/Erf_output_0, %/up_blocks.1/attn.2/ffn/ffn.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.2/ffn/ffn.2/Mul_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/ffn/ffn.2/Mul"](%/up_blocks.1/attn.2/ffn/ffn.1/Conv_output_0, %/up_blocks.1/attn.2/ffn/ffn.2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.2/ffn/ffn.2/Constant_2_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={0.5}, onnx_name="/up_blocks.1/attn.2/ffn/ffn.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.2/ffn/ffn.2/Mul_1_output_0 : Float(1, 2048, 4, 2, strides=[16384, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/attn.2/ffn/ffn.2/Mul_1"](%/up_blocks.1/attn.2/ffn/ffn.2/Mul_output_0, %/up_blocks.1/attn.2/ffn/ffn.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.activation.GELU::ffn.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/activation.py:696:0
  %/up_blocks.1/attn.2/ffn/ffn.3/Conv_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/attn.2/ffn/ffn.3/Conv"](%/up_blocks.1/attn.2/ffn/ffn.2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.1.attn.2.ffn.3.weight, %inner_unet.inner_unet.up_blocks.1.attn.2.ffn.3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2/torch.nn.modules.container.Sequential::ffn/torch.nn.modules.conv.Conv2d::ffn.3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/attn.2/Add_4_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/attn.2/Add_4"](%/up_blocks.1/attn.2/ffn/ffn.3/Conv_output_0, %/up_blocks.1/attn.2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.SelfAttention::attn.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:376:0
  %/up_blocks.1/Cast_output_0 : Float(1, 512, 4, 2, strides=[4096, 8, 2, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/Cast"](%/up_blocks.1/attn.2/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.1/Constant_output_0 : Float(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1  1  2  2 [ CPUFloatType{4} ], onnx_name="/up_blocks.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %onnx::Resize_8026 : Tensor? = prim::Constant(), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.1/Resize_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Resize[coordinate_transformation_mode="asymmetric", cubic_coeff_a=-0.75, mode="nearest", nearest_mode="floor", onnx_name="/up_blocks.1/Resize"](%/up_blocks.1/Cast_output_0, %onnx::Resize_8026, %/up_blocks.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.1/Cast_1_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1/Cast_1"](%/up_blocks.1/Resize_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.1/resample/Conv_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resample/Conv"](%/up_blocks.1/Cast_1_output_0, %inner_unet.inner_unet.up_blocks.1.resample.weight, %inner_unet.inner_unet.up_blocks.1.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/Concat_output_0 : Float(1, 768, 8, 4, strides=[24576, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.2/Concat"](%/up_blocks.1/resample/Conv_output_0, %/down_blocks.0/resnets.1_2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.2/resnets.0/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.0/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1/Reshape_output_0 : Float(1, 32, 768, strides=[24576, 768, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm1/Reshape"](%/up_blocks.2/Concat_output_0, %/up_blocks.2/resnets.0/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1/InstanceNormalization_output_0 : Float(1, 32, 768, strides=[24576, 768, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.0/norm1/InstanceNormalization"](%/up_blocks.2/resnets.0/norm1/Reshape_output_0, %/up_blocks.2/resnets.0/norm1/Constant_1_output_0, %/up_blocks.2/resnets.0/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.0/norm1/Shape"](%/up_blocks.2/Concat_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1/Reshape_1_output_0 : Float(1, 768, 8, 4, strides=[24576, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm1/Reshape_1"](%/up_blocks.2/resnets.0/norm1/InstanceNormalization_output_0, %/up_blocks.2/resnets.0/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1/Mul_output_0 : Float(1, 768, 8, 4, strides=[24576, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/norm1/Mul"](%/up_blocks.2/resnets.0/norm1/Reshape_1_output_0, %onnx::Mul_10632), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1/Add_output_0 : Float(1, 768, 8, 4, strides=[24576, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0/norm1/Add"](%/up_blocks.2/resnets.0/norm1/Mul_output_0, %onnx::Add_10633), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/Sigmoid_output_0 : Float(1, 768, 8, 4, strides=[24576, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.0/Sigmoid"](%/up_blocks.2/resnets.0/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0/Mul_output_0 : Float(1, 768, 8, 4, strides=[24576, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/Mul"](%/up_blocks.2/resnets.0/norm1/Add_output_0, %/up_blocks.2/resnets.0/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0/conv1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.0/conv1/Conv"](%/up_blocks.2/resnets.0/Mul_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.0.conv1.weight, %inner_unet.inner_unet.up_blocks.2.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.0/time_layer/Gemm_output_0 : Float(1, 512, strides=[512, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.2/resnets.0/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.0.time_layer.weight, %inner_unet.inner_unet.up_blocks.2.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.2/resnets.0/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.0/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Unsqueeze_output_0 : Float(1, 512, 1, strides=[512, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.0/Unsqueeze"](%/up_blocks.2/resnets.0/time_layer/Gemm_output_0, %/up_blocks.2/resnets.0/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.0/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Unsqueeze_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.0/Unsqueeze_1"](%/up_blocks.2/resnets.0/Unsqueeze_output_0, %/up_blocks.2/resnets.0/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.0/Shape"](%/up_blocks.2/resnets.0/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.2/resnets.0/Gather"](%/up_blocks.2/resnets.0/Shape_output_0, %/up_blocks.2/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.2/resnets.0/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.2/resnets.0/Add"](%/up_blocks.2/resnets.0/Gather_output_0, %/up_blocks.2/resnets.0/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.0/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.2/resnets.0/Div"](%/up_blocks.2/resnets.0/Add_output_0, %/up_blocks.2/resnets.0/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/Mul_1"](%/up_blocks.2/resnets.0/Div_output_0, %/up_blocks.2/resnets.0/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Slice_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.0/Slice"](%/up_blocks.2/resnets.0/Unsqueeze_1_output_0, %/up_blocks.2/resnets.0/Constant_3_output_0, %/up_blocks.2/resnets.0/Mul_1_output_0, %/up_blocks.2/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.0/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/Mul_2"](%/up_blocks.2/resnets.0/Div_output_0, %/up_blocks.2/resnets.0/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/Slice_1_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.0/Slice_1"](%/up_blocks.2/resnets.0/Unsqueeze_1_output_0, %/up_blocks.2/resnets.0/Mul_1_output_0, %/up_blocks.2/resnets.0/Mul_2_output_0, %/up_blocks.2/resnets.0/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.0/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm2/Reshape"](%/up_blocks.2/resnets.0/conv1/Conv_output_0, %/up_blocks.2/resnets.0/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.0/norm2/InstanceNormalization"](%/up_blocks.2/resnets.0/norm2/Reshape_output_0, %/up_blocks.2/resnets.0/norm2/Constant_1_output_0, %/up_blocks.2/resnets.0/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.0/norm2/Shape"](%/up_blocks.2/resnets.0/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm2/Reshape_1"](%/up_blocks.2/resnets.0/norm2/InstanceNormalization_output_0, %/up_blocks.2/resnets.0/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/norm2/Mul"](%/up_blocks.2/resnets.0/norm2/Reshape_1_output_0, %onnx::Mul_10634), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0/norm2/Add"](%/up_blocks.2/resnets.0/norm2/Mul_output_0, %onnx::Add_10635), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0/Add_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0/Add_1"](%/up_blocks.2/resnets.0/Slice_output_0, %/up_blocks.2/resnets.0/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0/Mul_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/Mul_3"](%/up_blocks.2/resnets.0/norm2/Add_output_0, %/up_blocks.2/resnets.0/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0/Add_2_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0/Add_2"](%/up_blocks.2/resnets.0/Mul_3_output_0, %/up_blocks.2/resnets.0/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0/Sigmoid_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.0/Sigmoid_1"](%/up_blocks.2/resnets.0/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0/Mul_4_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/Mul_4"](%/up_blocks.2/resnets.0/Add_2_output_0, %/up_blocks.2/resnets.0/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0/conv2/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.0/conv2/Conv"](%/up_blocks.2/resnets.0/Mul_4_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.0.conv2.weight, %inner_unet.inner_unet.up_blocks.2.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.0/conv3/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.2/resnets.0/conv3/Conv"](%/up_blocks.2/Concat_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.0.conv3.weight, %inner_unet.inner_unet.up_blocks.2.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.0/Add_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0/Add_3"](%/up_blocks.2/resnets.0/conv2/Conv_output_0, %/up_blocks.2/resnets.0/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.2/Concat_1_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.2/Concat_1"](%/up_blocks.2/resnets.0/Add_3_output_0, %/down_blocks.0/resnets.0_2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.2/resnets.1/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.1/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1/Reshape_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm1/Reshape"](%/up_blocks.2/Concat_1_output_0, %/up_blocks.2/resnets.1/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1/InstanceNormalization_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.1/norm1/InstanceNormalization"](%/up_blocks.2/resnets.1/norm1/Reshape_output_0, %/up_blocks.2/resnets.1/norm1/Constant_1_output_0, %/up_blocks.2/resnets.1/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.1/norm1/Shape"](%/up_blocks.2/Concat_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1/Reshape_1_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm1/Reshape_1"](%/up_blocks.2/resnets.1/norm1/InstanceNormalization_output_0, %/up_blocks.2/resnets.1/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1/Mul_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/norm1/Mul"](%/up_blocks.2/resnets.1/norm1/Reshape_1_output_0, %onnx::Mul_10636), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1/Add_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1/norm1/Add"](%/up_blocks.2/resnets.1/norm1/Mul_output_0, %onnx::Add_10637), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/Sigmoid_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.1/Sigmoid"](%/up_blocks.2/resnets.1/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1/Mul_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/Mul"](%/up_blocks.2/resnets.1/norm1/Add_output_0, %/up_blocks.2/resnets.1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1/conv1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.1/conv1/Conv"](%/up_blocks.2/resnets.1/Mul_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.1.conv1.weight, %inner_unet.inner_unet.up_blocks.2.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.1/time_layer/Gemm_output_0 : Float(1, 512, strides=[512, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.2/resnets.1/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.1.time_layer.weight, %inner_unet.inner_unet.up_blocks.2.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.2/resnets.1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Unsqueeze_output_0 : Float(1, 512, 1, strides=[512, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.1/Unsqueeze"](%/up_blocks.2/resnets.1/time_layer/Gemm_output_0, %/up_blocks.2/resnets.1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Unsqueeze_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.1/Unsqueeze_1"](%/up_blocks.2/resnets.1/Unsqueeze_output_0, %/up_blocks.2/resnets.1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.1/Shape"](%/up_blocks.2/resnets.1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.2/resnets.1/Gather"](%/up_blocks.2/resnets.1/Shape_output_0, %/up_blocks.2/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.2/resnets.1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.2/resnets.1/Add"](%/up_blocks.2/resnets.1/Gather_output_0, %/up_blocks.2/resnets.1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.2/resnets.1/Div"](%/up_blocks.2/resnets.1/Add_output_0, %/up_blocks.2/resnets.1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/Mul_1"](%/up_blocks.2/resnets.1/Div_output_0, %/up_blocks.2/resnets.1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Slice_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.1/Slice"](%/up_blocks.2/resnets.1/Unsqueeze_1_output_0, %/up_blocks.2/resnets.1/Constant_3_output_0, %/up_blocks.2/resnets.1/Mul_1_output_0, %/up_blocks.2/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/Mul_2"](%/up_blocks.2/resnets.1/Div_output_0, %/up_blocks.2/resnets.1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/Slice_1_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.1/Slice_1"](%/up_blocks.2/resnets.1/Unsqueeze_1_output_0, %/up_blocks.2/resnets.1/Mul_1_output_0, %/up_blocks.2/resnets.1/Mul_2_output_0, %/up_blocks.2/resnets.1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.1/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm2/Reshape"](%/up_blocks.2/resnets.1/conv1/Conv_output_0, %/up_blocks.2/resnets.1/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.1/norm2/InstanceNormalization"](%/up_blocks.2/resnets.1/norm2/Reshape_output_0, %/up_blocks.2/resnets.1/norm2/Constant_1_output_0, %/up_blocks.2/resnets.1/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.1/norm2/Shape"](%/up_blocks.2/resnets.1/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm2/Reshape_1"](%/up_blocks.2/resnets.1/norm2/InstanceNormalization_output_0, %/up_blocks.2/resnets.1/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/norm2/Mul"](%/up_blocks.2/resnets.1/norm2/Reshape_1_output_0, %onnx::Mul_10638), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1/norm2/Add"](%/up_blocks.2/resnets.1/norm2/Mul_output_0, %onnx::Add_10639), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1/Add_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1/Add_1"](%/up_blocks.2/resnets.1/Slice_output_0, %/up_blocks.2/resnets.1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1/Mul_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/Mul_3"](%/up_blocks.2/resnets.1/norm2/Add_output_0, %/up_blocks.2/resnets.1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1/Add_2_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1/Add_2"](%/up_blocks.2/resnets.1/Mul_3_output_0, %/up_blocks.2/resnets.1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1/Sigmoid_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.1/Sigmoid_1"](%/up_blocks.2/resnets.1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1/Mul_4_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/Mul_4"](%/up_blocks.2/resnets.1/Add_2_output_0, %/up_blocks.2/resnets.1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1/conv2/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.1/conv2/Conv"](%/up_blocks.2/resnets.1/Mul_4_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.1.conv2.weight, %inner_unet.inner_unet.up_blocks.2.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.1/conv3/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.2/resnets.1/conv3/Conv"](%/up_blocks.2/Concat_1_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.1.conv3.weight, %inner_unet.inner_unet.up_blocks.2.resnets.1.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.1/Add_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1/Add_3"](%/up_blocks.2/resnets.1/conv2/Conv_output_0, %/up_blocks.2/resnets.1/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.2/Concat_2_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.2/Concat_2"](%/up_blocks.2/resnets.1/Add_3_output_0, %/Add_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.2/resnets.2/norm1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.2/norm1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1/Reshape_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm1/Reshape"](%/up_blocks.2/Concat_2_output_0, %/up_blocks.2/resnets.2/norm1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1/InstanceNormalization_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.2/norm1/InstanceNormalization"](%/up_blocks.2/resnets.2/norm1/Reshape_output_0, %/up_blocks.2/resnets.2/norm1/Constant_1_output_0, %/up_blocks.2/resnets.2/norm1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.2/norm1/Shape"](%/up_blocks.2/Concat_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1/Reshape_1_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm1/Reshape_1"](%/up_blocks.2/resnets.2/norm1/InstanceNormalization_output_0, %/up_blocks.2/resnets.2/norm1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1/Mul_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/norm1/Mul"](%/up_blocks.2/resnets.2/norm1/Reshape_1_output_0, %onnx::Mul_10640), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1/Add_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2/norm1/Add"](%/up_blocks.2/resnets.2/norm1/Mul_output_0, %onnx::Add_10641), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/Sigmoid_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.2/Sigmoid"](%/up_blocks.2/resnets.2/norm1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2/Mul_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/Mul"](%/up_blocks.2/resnets.2/norm1/Add_output_0, %/up_blocks.2/resnets.2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2/conv1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.2/conv1/Conv"](%/up_blocks.2/resnets.2/Mul_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.2.conv1.weight, %inner_unet.inner_unet.up_blocks.2.resnets.2.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.2/time_layer/Gemm_output_0 : Float(1, 512, strides=[512, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.2/resnets.2/time_layer/Gemm"](%/down_blocks.0/resnets.0_2/Mul_1_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.2.time_layer.weight, %inner_unet.inner_unet.up_blocks.2.resnets.2.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.2/resnets.2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Unsqueeze_output_0 : Float(1, 512, 1, strides=[512, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.2/Unsqueeze"](%/up_blocks.2/resnets.2/time_layer/Gemm_output_0, %/up_blocks.2/resnets.2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Unsqueeze_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.2/Unsqueeze_1"](%/up_blocks.2/resnets.2/Unsqueeze_output_0, %/up_blocks.2/resnets.2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.2/Shape"](%/up_blocks.2/resnets.2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.2/resnets.2/Gather"](%/up_blocks.2/resnets.2/Shape_output_0, %/up_blocks.2/resnets.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.2/resnets.2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.2/resnets.2/Add"](%/up_blocks.2/resnets.2/Gather_output_0, %/up_blocks.2/resnets.2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.2/resnets.2/Div"](%/up_blocks.2/resnets.2/Add_output_0, %/up_blocks.2/resnets.2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/Mul_1"](%/up_blocks.2/resnets.2/Div_output_0, %/up_blocks.2/resnets.2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Slice_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.2/Slice"](%/up_blocks.2/resnets.2/Unsqueeze_1_output_0, %/up_blocks.2/resnets.2/Constant_3_output_0, %/up_blocks.2/resnets.2/Mul_1_output_0, %/up_blocks.2/resnets.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/Mul_2"](%/up_blocks.2/resnets.2/Div_output_0, %/up_blocks.2/resnets.2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/Slice_1_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.2/Slice_1"](%/up_blocks.2/resnets.2/Unsqueeze_1_output_0, %/up_blocks.2/resnets.2/Mul_1_output_0, %/up_blocks.2/resnets.2/Mul_2_output_0, %/up_blocks.2/resnets.2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/norm2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.2/norm2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm2/Reshape"](%/up_blocks.2/resnets.2/conv1/Conv_output_0, %/up_blocks.2/resnets.2/norm2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.2/norm2/InstanceNormalization"](%/up_blocks.2/resnets.2/norm2/Reshape_output_0, %/up_blocks.2/resnets.2/norm2/Constant_1_output_0, %/up_blocks.2/resnets.2/norm2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.2/norm2/Shape"](%/up_blocks.2/resnets.2/conv1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm2/Reshape_1"](%/up_blocks.2/resnets.2/norm2/InstanceNormalization_output_0, %/up_blocks.2/resnets.2/norm2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/norm2/Mul"](%/up_blocks.2/resnets.2/norm2/Reshape_1_output_0, %onnx::Mul_10642), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2/norm2/Add"](%/up_blocks.2/resnets.2/norm2/Mul_output_0, %onnx::Add_10643), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2/Add_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2/Add_1"](%/up_blocks.2/resnets.2/Slice_output_0, %/up_blocks.2/resnets.2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2/Mul_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/Mul_3"](%/up_blocks.2/resnets.2/norm2/Add_output_0, %/up_blocks.2/resnets.2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2/Add_2_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2/Add_2"](%/up_blocks.2/resnets.2/Mul_3_output_0, %/up_blocks.2/resnets.2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2/Sigmoid_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.2/Sigmoid_1"](%/up_blocks.2/resnets.2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2/Mul_4_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/Mul_4"](%/up_blocks.2/resnets.2/Add_2_output_0, %/up_blocks.2/resnets.2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2/conv2/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.2/conv2/Conv"](%/up_blocks.2/resnets.2/Mul_4_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.2.conv2.weight, %inner_unet.inner_unet.up_blocks.2.resnets.2.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.2/conv3/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.2/resnets.2/conv3/Conv"](%/up_blocks.2/Concat_2_output_0, %inner_unet.inner_unet.up_blocks.2.resnets.2.conv3.weight, %inner_unet.inner_unet.up_blocks.2.resnets.2.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.2/Add_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2/Add_3"](%/up_blocks.2/resnets.2/conv2/Conv_output_0, %/up_blocks.2/resnets.2/conv3/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/norm_out/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/norm_out/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/norm_out/Reshape"](%/up_blocks.2/resnets.2/Add_3_output_0, %/norm_out/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/norm_out/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/norm_out/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/norm_out/InstanceNormalization"](%/norm_out/Reshape_output_0, %/norm_out/Constant_1_output_0, %/norm_out/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/norm_out/Shape"](%/up_blocks.2/resnets.2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/norm_out/Reshape_1"](%/norm_out/InstanceNormalization_output_0, %/norm_out/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/norm_out/Mul"](%/norm_out/Reshape_1_output_0, %onnx::Mul_10644), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/norm_out/Add"](%/norm_out/Mul_output_0, %onnx::Add_10645), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/Sigmoid_6_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/Sigmoid_6"](%/norm_out/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/Mul_16_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_16"](%/norm_out/Add_output_0, %/Sigmoid_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %ot_3 : Float(1, 3, 8, 4, strides=[96, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/conv_out/Conv"](%/Mul_16_output_0, %inner_unet.inner_unet.conv_out.weight, %inner_unet.inner_unet.conv_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.conv.Conv2d::conv_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/out_adapter/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/out_adapter/Conv"](%/up_blocks.2/resnets.2/Add_3_output_0, %inner_unet.out_adapter.weight, %inner_unet.out_adapter.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.conv.Conv2d::out_adapter # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/Add_8_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/Add_8"](%/down_blocks.2/resnets.0_1/Add_3_output_0, %/out_adapter/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:216:0
  %/up_blocks.0_1/Concat_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.0_1/Concat"](%/Add_8_output_0, %/down_blocks.2/resnets.0_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.0/resnets.0/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.0/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_1/Reshape_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm1_1/Reshape"](%/up_blocks.0_1/Concat_output_0, %/up_blocks.0/resnets.0/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.0/norm1_1/InstanceNormalization"](%/up_blocks.0/resnets.0/norm1_1/Reshape_output_0, %/up_blocks.0/resnets.0/norm1_1/Constant_1_output_0, %/up_blocks.0/resnets.0/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.0/norm1_1/Shape"](%/up_blocks.0_1/Concat_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_1/Reshape_1_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm1_1/Reshape_1"](%/up_blocks.0/resnets.0/norm1_1/InstanceNormalization_output_0, %/up_blocks.0/resnets.0/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_1/Mul_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/norm1_1/Mul"](%/up_blocks.0/resnets.0/norm1_1/Reshape_1_output_0, %onnx::Mul_10646), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_1/Add_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0/norm1_1/Add"](%/up_blocks.0/resnets.0/norm1_1/Mul_output_0, %onnx::Add_10647), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0_1/Sigmoid_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.0_1/Sigmoid"](%/up_blocks.0/resnets.0/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0_1/Mul_output_0 : Float(1, 512, 8, 4, strides=[16384, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0_1/Mul"](%/up_blocks.0/resnets.0/norm1_1/Add_output_0, %/up_blocks.0/resnets.0_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0/conv1_1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.0/conv1_1/Conv"](%/up_blocks.0/resnets.0_1/Mul_output_0, %inner_unet.up_blocks.0.resnets.0.conv1.weight, %inner_unet.up_blocks.0.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.0/time_layer_1/Gemm_output_0 : Float(1, 512, strides=[512, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.0/resnets.0/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.up_blocks.0.resnets.0.time_layer.weight, %inner_unet.up_blocks.0.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/resnets.0_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.0_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Unsqueeze_output_0 : Float(1, 512, 1, strides=[512, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.0_1/Unsqueeze"](%/up_blocks.0/resnets.0/time_layer_1/Gemm_output_0, %/up_blocks.0/resnets.0_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.0_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Unsqueeze_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.0_1/Unsqueeze_1"](%/up_blocks.0/resnets.0_1/Unsqueeze_output_0, %/up_blocks.0/resnets.0_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.0_1/Shape"](%/up_blocks.0/resnets.0_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/resnets.0_1/Gather"](%/up_blocks.0/resnets.0_1/Shape_output_0, %/up_blocks.0/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/resnets.0_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/resnets.0_1/Add"](%/up_blocks.0/resnets.0_1/Gather_output_0, %/up_blocks.0/resnets.0_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.0_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/resnets.0_1/Div"](%/up_blocks.0/resnets.0_1/Add_output_0, %/up_blocks.0/resnets.0_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0_1/Mul_1"](%/up_blocks.0/resnets.0_1/Div_output_0, %/up_blocks.0/resnets.0_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Slice_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.0_1/Slice"](%/up_blocks.0/resnets.0_1/Unsqueeze_1_output_0, %/up_blocks.0/resnets.0_1/Constant_3_output_0, %/up_blocks.0/resnets.0_1/Mul_1_output_0, %/up_blocks.0/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.0_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0_1/Mul_2"](%/up_blocks.0/resnets.0_1/Div_output_0, %/up_blocks.0/resnets.0_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_1/Slice_1_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.0_1/Slice_1"](%/up_blocks.0/resnets.0_1/Unsqueeze_1_output_0, %/up_blocks.0/resnets.0_1/Mul_1_output_0, %/up_blocks.0/resnets.0_1/Mul_2_output_0, %/up_blocks.0/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.0/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_1/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm2_1/Reshape"](%/up_blocks.0/resnets.0/conv1_1/Conv_output_0, %/up_blocks.0/resnets.0/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.0/norm2_1/InstanceNormalization"](%/up_blocks.0/resnets.0/norm2_1/Reshape_output_0, %/up_blocks.0/resnets.0/norm2_1/Constant_1_output_0, %/up_blocks.0/resnets.0/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.0/norm2_1/Shape"](%/up_blocks.0/resnets.0/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_1/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm2_1/Reshape_1"](%/up_blocks.0/resnets.0/norm2_1/InstanceNormalization_output_0, %/up_blocks.0/resnets.0/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_1/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/norm2_1/Mul"](%/up_blocks.0/resnets.0/norm2_1/Reshape_1_output_0, %onnx::Mul_10648), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_1/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0/norm2_1/Add"](%/up_blocks.0/resnets.0/norm2_1/Mul_output_0, %onnx::Add_10649), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0_1/Add_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0_1/Add_1"](%/up_blocks.0/resnets.0_1/Slice_output_0, %/up_blocks.0/resnets.0_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0_1/Mul_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0_1/Mul_3"](%/up_blocks.0/resnets.0/norm2_1/Add_output_0, %/up_blocks.0/resnets.0_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0_1/Add_2_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0_1/Add_2"](%/up_blocks.0/resnets.0_1/Mul_3_output_0, %/up_blocks.0/resnets.0_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0_1/Sigmoid_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.0_1/Sigmoid_1"](%/up_blocks.0/resnets.0_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0_1/Mul_4_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0_1/Mul_4"](%/up_blocks.0/resnets.0_1/Add_2_output_0, %/up_blocks.0/resnets.0_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0/conv2_1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.0/conv2_1/Conv"](%/up_blocks.0/resnets.0_1/Mul_4_output_0, %inner_unet.up_blocks.0.resnets.0.conv2.weight, %inner_unet.up_blocks.0.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.0/conv3_1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/resnets.0/conv3_1/Conv"](%/up_blocks.0_1/Concat_output_0, %inner_unet.up_blocks.0.resnets.0.conv3.weight, %inner_unet.up_blocks.0.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.0_1/Add_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0_1/Add_3"](%/up_blocks.0/resnets.0/conv2_1/Conv_output_0, %/up_blocks.0/resnets.0/conv3_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.0_1/Concat_1_output_0 : Float(1, 384, 8, 4, strides=[12288, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.0_1/Concat_1"](%/up_blocks.0/resnets.0_1/Add_3_output_0, %/down_blocks.1/resample_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.0/resnets.1/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.1/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_1/Reshape_output_0 : Float(1, 32, 384, strides=[12288, 384, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm1_1/Reshape"](%/up_blocks.0_1/Concat_1_output_0, %/up_blocks.0/resnets.1/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 384, strides=[12288, 384, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.1/norm1_1/InstanceNormalization"](%/up_blocks.0/resnets.1/norm1_1/Reshape_output_0, %/up_blocks.0/resnets.1/norm1_1/Constant_1_output_0, %/up_blocks.0/resnets.1/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.1/norm1_1/Shape"](%/up_blocks.0_1/Concat_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_1/Reshape_1_output_0 : Float(1, 384, 8, 4, strides=[12288, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm1_1/Reshape_1"](%/up_blocks.0/resnets.1/norm1_1/InstanceNormalization_output_0, %/up_blocks.0/resnets.1/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_1/Mul_output_0 : Float(1, 384, 8, 4, strides=[12288, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/norm1_1/Mul"](%/up_blocks.0/resnets.1/norm1_1/Reshape_1_output_0, %onnx::Mul_10650), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_1/Add_output_0 : Float(1, 384, 8, 4, strides=[12288, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1/norm1_1/Add"](%/up_blocks.0/resnets.1/norm1_1/Mul_output_0, %onnx::Add_10651), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1_1/Sigmoid_output_0 : Float(1, 384, 8, 4, strides=[12288, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.1_1/Sigmoid"](%/up_blocks.0/resnets.1/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1_1/Mul_output_0 : Float(1, 384, 8, 4, strides=[12288, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1_1/Mul"](%/up_blocks.0/resnets.1/norm1_1/Add_output_0, %/up_blocks.0/resnets.1_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1/conv1_1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.1/conv1_1/Conv"](%/up_blocks.0/resnets.1_1/Mul_output_0, %inner_unet.up_blocks.0.resnets.1.conv1.weight, %inner_unet.up_blocks.0.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.1/time_layer_1/Gemm_output_0 : Float(1, 512, strides=[512, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.0/resnets.1/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.up_blocks.0.resnets.1.time_layer.weight, %inner_unet.up_blocks.0.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/resnets.1_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Unsqueeze_output_0 : Float(1, 512, 1, strides=[512, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.1_1/Unsqueeze"](%/up_blocks.0/resnets.1/time_layer_1/Gemm_output_0, %/up_blocks.0/resnets.1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Unsqueeze_1_output_0 : Float(1, 512, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.1_1/Unsqueeze_1"](%/up_blocks.0/resnets.1_1/Unsqueeze_output_0, %/up_blocks.0/resnets.1_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.1_1/Shape"](%/up_blocks.0/resnets.1_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/resnets.1_1/Gather"](%/up_blocks.0/resnets.1_1/Shape_output_0, %/up_blocks.0/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/resnets.1_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/resnets.1_1/Add"](%/up_blocks.0/resnets.1_1/Gather_output_0, %/up_blocks.0/resnets.1_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.1_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/resnets.1_1/Div"](%/up_blocks.0/resnets.1_1/Add_output_0, %/up_blocks.0/resnets.1_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1_1/Mul_1"](%/up_blocks.0/resnets.1_1/Div_output_0, %/up_blocks.0/resnets.1_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Slice_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.1_1/Slice"](%/up_blocks.0/resnets.1_1/Unsqueeze_1_output_0, %/up_blocks.0/resnets.1_1/Constant_3_output_0, %/up_blocks.0/resnets.1_1/Mul_1_output_0, %/up_blocks.0/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.1_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1_1/Mul_2"](%/up_blocks.0/resnets.1_1/Div_output_0, %/up_blocks.0/resnets.1_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_1/Slice_1_output_0 : Float(1, 256, 1, 1, strides=[512, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.1_1/Slice_1"](%/up_blocks.0/resnets.1_1/Unsqueeze_1_output_0, %/up_blocks.0/resnets.1_1/Mul_1_output_0, %/up_blocks.0/resnets.1_1/Mul_2_output_0, %/up_blocks.0/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.1/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_1/Reshape_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm2_1/Reshape"](%/up_blocks.0/resnets.1/conv1_1/Conv_output_0, %/up_blocks.0/resnets.1/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 256, strides=[8192, 256, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.1/norm2_1/InstanceNormalization"](%/up_blocks.0/resnets.1/norm2_1/Reshape_output_0, %/up_blocks.0/resnets.1/norm2_1/Constant_1_output_0, %/up_blocks.0/resnets.1/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.1/norm2_1/Shape"](%/up_blocks.0/resnets.1/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_1/Reshape_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm2_1/Reshape_1"](%/up_blocks.0/resnets.1/norm2_1/InstanceNormalization_output_0, %/up_blocks.0/resnets.1/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_1/Mul_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/norm2_1/Mul"](%/up_blocks.0/resnets.1/norm2_1/Reshape_1_output_0, %onnx::Mul_10652), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_1/Add_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1/norm2_1/Add"](%/up_blocks.0/resnets.1/norm2_1/Mul_output_0, %onnx::Add_10653), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1_1/Add_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1_1/Add_1"](%/up_blocks.0/resnets.1_1/Slice_output_0, %/up_blocks.0/resnets.1_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1_1/Mul_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1_1/Mul_3"](%/up_blocks.0/resnets.1/norm2_1/Add_output_0, %/up_blocks.0/resnets.1_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1_1/Add_2_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1_1/Add_2"](%/up_blocks.0/resnets.1_1/Mul_3_output_0, %/up_blocks.0/resnets.1_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1_1/Sigmoid_1_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.1_1/Sigmoid_1"](%/up_blocks.0/resnets.1_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1_1/Mul_4_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1_1/Mul_4"](%/up_blocks.0/resnets.1_1/Add_2_output_0, %/up_blocks.0/resnets.1_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1/conv2_1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.1/conv2_1/Conv"](%/up_blocks.0/resnets.1_1/Mul_4_output_0, %inner_unet.up_blocks.0.resnets.1.conv2.weight, %inner_unet.up_blocks.0.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.1/conv3_1/Conv_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/resnets.1/conv3_1/Conv"](%/up_blocks.0_1/Concat_1_output_0, %inner_unet.up_blocks.0.resnets.1.conv3.weight, %inner_unet.up_blocks.0.resnets.1.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.1_1/Add_3_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1_1/Add_3"](%/up_blocks.0/resnets.1/conv2_1/Conv_output_0, %/up_blocks.0/resnets.1/conv3_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.0_1/Cast_output_0 : Float(1, 256, 8, 4, strides=[8192, 32, 4, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0_1/Cast"](%/up_blocks.0/resnets.1_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.0_1/Constant_output_0 : Float(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1  1  2  2 [ CPUFloatType{4} ], onnx_name="/up_blocks.0_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %onnx::Resize_8342 : Tensor? = prim::Constant(), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.0_1/Resize_output_0 : Float(1, 256, 16, 8, strides=[32768, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Resize[coordinate_transformation_mode="asymmetric", cubic_coeff_a=-0.75, mode="nearest", nearest_mode="floor", onnx_name="/up_blocks.0_1/Resize"](%/up_blocks.0_1/Cast_output_0, %onnx::Resize_8342, %/up_blocks.0_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.0_1/Cast_1_output_0 : Float(1, 256, 16, 8, strides=[32768, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0_1/Cast_1"](%/up_blocks.0_1/Resize_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.0/resample_1/Conv_output_0 : Float(1, 256, 16, 8, strides=[32768, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resample_1/Conv"](%/up_blocks.0_1/Cast_1_output_0, %inner_unet.up_blocks.0.resample.weight, %inner_unet.up_blocks.0.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1_1/Concat_output_0 : Float(1, 384, 16, 8, strides=[49152, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.1_1/Concat"](%/up_blocks.0/resample_1/Conv_output_0, %/down_blocks.1/resnets.1_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.1/resnets.0/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.0/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_1/Reshape_output_0 : Float(1, 32, 1536, strides=[49152, 1536, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm1_1/Reshape"](%/up_blocks.1_1/Concat_output_0, %/up_blocks.1/resnets.0/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 1536, strides=[49152, 1536, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.0/norm1_1/InstanceNormalization"](%/up_blocks.1/resnets.0/norm1_1/Reshape_output_0, %/up_blocks.1/resnets.0/norm1_1/Constant_1_output_0, %/up_blocks.1/resnets.0/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.0/norm1_1/Shape"](%/up_blocks.1_1/Concat_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_1/Reshape_1_output_0 : Float(1, 384, 16, 8, strides=[49152, 128, 8, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm1_1/Reshape_1"](%/up_blocks.1/resnets.0/norm1_1/InstanceNormalization_output_0, %/up_blocks.1/resnets.0/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_1/Mul_output_0 : Float(1, 384, 16, 8, strides=[49152, 128, 8, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/norm1_1/Mul"](%/up_blocks.1/resnets.0/norm1_1/Reshape_1_output_0, %onnx::Mul_10655), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_1/Add_output_0 : Float(1, 384, 16, 8, strides=[49152, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0/norm1_1/Add"](%/up_blocks.1/resnets.0/norm1_1/Mul_output_0, %onnx::Add_10656), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0_1/Sigmoid_output_0 : Float(1, 384, 16, 8, strides=[49152, 128, 8, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.0_1/Sigmoid"](%/up_blocks.1/resnets.0/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0_1/Mul_output_0 : Float(1, 384, 16, 8, strides=[49152, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0_1/Mul"](%/up_blocks.1/resnets.0/norm1_1/Add_output_0, %/up_blocks.1/resnets.0_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0/conv1_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.0/conv1_1/Conv"](%/up_blocks.1/resnets.0_1/Mul_output_0, %inner_unet.up_blocks.1.resnets.0.conv1.weight, %inner_unet.up_blocks.1.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.0/time_layer_1/Gemm_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.1/resnets.0/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.up_blocks.1.resnets.0.time_layer.weight, %inner_unet.up_blocks.1.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/resnets.0_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.0_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Unsqueeze_output_0 : Float(1, 256, 1, strides=[256, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.0_1/Unsqueeze"](%/up_blocks.1/resnets.0/time_layer_1/Gemm_output_0, %/up_blocks.1/resnets.0_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.0_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Unsqueeze_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.0_1/Unsqueeze_1"](%/up_blocks.1/resnets.0_1/Unsqueeze_output_0, %/up_blocks.1/resnets.0_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.0_1/Shape"](%/up_blocks.1/resnets.0_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/resnets.0_1/Gather"](%/up_blocks.1/resnets.0_1/Shape_output_0, %/up_blocks.1/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/resnets.0_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/resnets.0_1/Add"](%/up_blocks.1/resnets.0_1/Gather_output_0, %/up_blocks.1/resnets.0_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.0_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/resnets.0_1/Div"](%/up_blocks.1/resnets.0_1/Add_output_0, %/up_blocks.1/resnets.0_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0_1/Mul_1"](%/up_blocks.1/resnets.0_1/Div_output_0, %/up_blocks.1/resnets.0_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Slice_output_0 : Float(1, 128, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.0_1/Slice"](%/up_blocks.1/resnets.0_1/Unsqueeze_1_output_0, %/up_blocks.1/resnets.0_1/Constant_3_output_0, %/up_blocks.1/resnets.0_1/Mul_1_output_0, %/up_blocks.1/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.0_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0_1/Mul_2"](%/up_blocks.1/resnets.0_1/Div_output_0, %/up_blocks.1/resnets.0_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_1/Slice_1_output_0 : Float(1, 128, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.0_1/Slice_1"](%/up_blocks.1/resnets.0_1/Unsqueeze_1_output_0, %/up_blocks.1/resnets.0_1/Mul_1_output_0, %/up_blocks.1/resnets.0_1/Mul_2_output_0, %/up_blocks.1/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.0/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_1/Reshape_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm2_1/Reshape"](%/up_blocks.1/resnets.0/conv1_1/Conv_output_0, %/up_blocks.1/resnets.0/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.0/norm2_1/InstanceNormalization"](%/up_blocks.1/resnets.0/norm2_1/Reshape_output_0, %/up_blocks.1/resnets.0/norm2_1/Constant_1_output_0, %/up_blocks.1/resnets.0/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.0/norm2_1/Shape"](%/up_blocks.1/resnets.0/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_1/Reshape_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm2_1/Reshape_1"](%/up_blocks.1/resnets.0/norm2_1/InstanceNormalization_output_0, %/up_blocks.1/resnets.0/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_1/Mul_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/norm2_1/Mul"](%/up_blocks.1/resnets.0/norm2_1/Reshape_1_output_0, %onnx::Mul_10657), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_1/Add_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0/norm2_1/Add"](%/up_blocks.1/resnets.0/norm2_1/Mul_output_0, %onnx::Add_10658), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0_1/Add_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0_1/Add_1"](%/up_blocks.1/resnets.0_1/Slice_output_0, %/up_blocks.1/resnets.0_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0_1/Mul_3_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0_1/Mul_3"](%/up_blocks.1/resnets.0/norm2_1/Add_output_0, %/up_blocks.1/resnets.0_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0_1/Add_2_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0_1/Add_2"](%/up_blocks.1/resnets.0_1/Mul_3_output_0, %/up_blocks.1/resnets.0_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0_1/Sigmoid_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.0_1/Sigmoid_1"](%/up_blocks.1/resnets.0_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0_1/Mul_4_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0_1/Mul_4"](%/up_blocks.1/resnets.0_1/Add_2_output_0, %/up_blocks.1/resnets.0_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0/conv2_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.0/conv2_1/Conv"](%/up_blocks.1/resnets.0_1/Mul_4_output_0, %inner_unet.up_blocks.1.resnets.0.conv2.weight, %inner_unet.up_blocks.1.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.0/conv3_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/resnets.0/conv3_1/Conv"](%/up_blocks.1_1/Concat_output_0, %inner_unet.up_blocks.1.resnets.0.conv3.weight, %inner_unet.up_blocks.1.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.0_1/Add_3_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0_1/Add_3"](%/up_blocks.1/resnets.0/conv2_1/Conv_output_0, %/up_blocks.1/resnets.0/conv3_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.1_1/Concat_1_output_0 : Float(1, 256, 16, 8, strides=[32768, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.1_1/Concat_1"](%/up_blocks.1/resnets.0_1/Add_3_output_0, %/down_blocks.1/resnets.0_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.1/resnets.1/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.1/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_1/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm1_1/Reshape"](%/up_blocks.1_1/Concat_1_output_0, %/up_blocks.1/resnets.1/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.1/norm1_1/InstanceNormalization"](%/up_blocks.1/resnets.1/norm1_1/Reshape_output_0, %/up_blocks.1/resnets.1/norm1_1/Constant_1_output_0, %/up_blocks.1/resnets.1/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.1/norm1_1/Shape"](%/up_blocks.1_1/Concat_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_1/Reshape_1_output_0 : Float(1, 256, 16, 8, strides=[32768, 128, 8, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm1_1/Reshape_1"](%/up_blocks.1/resnets.1/norm1_1/InstanceNormalization_output_0, %/up_blocks.1/resnets.1/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_1/Mul_output_0 : Float(1, 256, 16, 8, strides=[32768, 128, 8, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/norm1_1/Mul"](%/up_blocks.1/resnets.1/norm1_1/Reshape_1_output_0, %onnx::Mul_10659), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_1/Add_output_0 : Float(1, 256, 16, 8, strides=[32768, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1/norm1_1/Add"](%/up_blocks.1/resnets.1/norm1_1/Mul_output_0, %onnx::Add_10660), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1_1/Sigmoid_output_0 : Float(1, 256, 16, 8, strides=[32768, 128, 8, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.1_1/Sigmoid"](%/up_blocks.1/resnets.1/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1_1/Mul_output_0 : Float(1, 256, 16, 8, strides=[32768, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1_1/Mul"](%/up_blocks.1/resnets.1/norm1_1/Add_output_0, %/up_blocks.1/resnets.1_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1/conv1_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.1/conv1_1/Conv"](%/up_blocks.1/resnets.1_1/Mul_output_0, %inner_unet.up_blocks.1.resnets.1.conv1.weight, %inner_unet.up_blocks.1.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.1/time_layer_1/Gemm_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.1/resnets.1/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.up_blocks.1.resnets.1.time_layer.weight, %inner_unet.up_blocks.1.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/resnets.1_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Unsqueeze_output_0 : Float(1, 256, 1, strides=[256, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.1_1/Unsqueeze"](%/up_blocks.1/resnets.1/time_layer_1/Gemm_output_0, %/up_blocks.1/resnets.1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Unsqueeze_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.1_1/Unsqueeze_1"](%/up_blocks.1/resnets.1_1/Unsqueeze_output_0, %/up_blocks.1/resnets.1_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.1_1/Shape"](%/up_blocks.1/resnets.1_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/resnets.1_1/Gather"](%/up_blocks.1/resnets.1_1/Shape_output_0, %/up_blocks.1/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/resnets.1_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/resnets.1_1/Add"](%/up_blocks.1/resnets.1_1/Gather_output_0, %/up_blocks.1/resnets.1_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.1_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/resnets.1_1/Div"](%/up_blocks.1/resnets.1_1/Add_output_0, %/up_blocks.1/resnets.1_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1_1/Mul_1"](%/up_blocks.1/resnets.1_1/Div_output_0, %/up_blocks.1/resnets.1_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Slice_output_0 : Float(1, 128, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.1_1/Slice"](%/up_blocks.1/resnets.1_1/Unsqueeze_1_output_0, %/up_blocks.1/resnets.1_1/Constant_3_output_0, %/up_blocks.1/resnets.1_1/Mul_1_output_0, %/up_blocks.1/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.1_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1_1/Mul_2"](%/up_blocks.1/resnets.1_1/Div_output_0, %/up_blocks.1/resnets.1_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_1/Slice_1_output_0 : Float(1, 128, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.1_1/Slice_1"](%/up_blocks.1/resnets.1_1/Unsqueeze_1_output_0, %/up_blocks.1/resnets.1_1/Mul_1_output_0, %/up_blocks.1/resnets.1_1/Mul_2_output_0, %/up_blocks.1/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.1/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_1/Reshape_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm2_1/Reshape"](%/up_blocks.1/resnets.1/conv1_1/Conv_output_0, %/up_blocks.1/resnets.1/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.1/norm2_1/InstanceNormalization"](%/up_blocks.1/resnets.1/norm2_1/Reshape_output_0, %/up_blocks.1/resnets.1/norm2_1/Constant_1_output_0, %/up_blocks.1/resnets.1/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.1/norm2_1/Shape"](%/up_blocks.1/resnets.1/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_1/Reshape_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm2_1/Reshape_1"](%/up_blocks.1/resnets.1/norm2_1/InstanceNormalization_output_0, %/up_blocks.1/resnets.1/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_1/Mul_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/norm2_1/Mul"](%/up_blocks.1/resnets.1/norm2_1/Reshape_1_output_0, %onnx::Mul_10661), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_1/Add_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1/norm2_1/Add"](%/up_blocks.1/resnets.1/norm2_1/Mul_output_0, %onnx::Add_10662), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1_1/Add_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1_1/Add_1"](%/up_blocks.1/resnets.1_1/Slice_output_0, %/up_blocks.1/resnets.1_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1_1/Mul_3_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1_1/Mul_3"](%/up_blocks.1/resnets.1/norm2_1/Add_output_0, %/up_blocks.1/resnets.1_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1_1/Add_2_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1_1/Add_2"](%/up_blocks.1/resnets.1_1/Mul_3_output_0, %/up_blocks.1/resnets.1_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1_1/Sigmoid_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.1_1/Sigmoid_1"](%/up_blocks.1/resnets.1_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1_1/Mul_4_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1_1/Mul_4"](%/up_blocks.1/resnets.1_1/Add_2_output_0, %/up_blocks.1/resnets.1_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1/conv2_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.1/conv2_1/Conv"](%/up_blocks.1/resnets.1_1/Mul_4_output_0, %inner_unet.up_blocks.1.resnets.1.conv2.weight, %inner_unet.up_blocks.1.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.1/conv3_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/resnets.1/conv3_1/Conv"](%/up_blocks.1_1/Concat_1_output_0, %inner_unet.up_blocks.1.resnets.1.conv3.weight, %inner_unet.up_blocks.1.resnets.1.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.1_1/Add_3_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1_1/Add_3"](%/up_blocks.1/resnets.1/conv2_1/Conv_output_0, %/up_blocks.1/resnets.1/conv3_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.1_1/Concat_2_output_0 : Float(1, 192, 16, 8, strides=[24576, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.1_1/Concat_2"](%/up_blocks.1/resnets.1_1/Add_3_output_0, %/down_blocks.0/resample_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.1/resnets.2/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.2/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_1/Reshape_output_0 : Float(1, 32, 768, strides=[24576, 768, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm1_1/Reshape"](%/up_blocks.1_1/Concat_2_output_0, %/up_blocks.1/resnets.2/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 768, strides=[24576, 768, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.2/norm1_1/InstanceNormalization"](%/up_blocks.1/resnets.2/norm1_1/Reshape_output_0, %/up_blocks.1/resnets.2/norm1_1/Constant_1_output_0, %/up_blocks.1/resnets.2/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.2/norm1_1/Shape"](%/up_blocks.1_1/Concat_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_1/Reshape_1_output_0 : Float(1, 192, 16, 8, strides=[24576, 128, 8, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm1_1/Reshape_1"](%/up_blocks.1/resnets.2/norm1_1/InstanceNormalization_output_0, %/up_blocks.1/resnets.2/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_1/Mul_output_0 : Float(1, 192, 16, 8, strides=[24576, 128, 8, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/norm1_1/Mul"](%/up_blocks.1/resnets.2/norm1_1/Reshape_1_output_0, %onnx::Mul_10663), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_1/Add_output_0 : Float(1, 192, 16, 8, strides=[24576, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2/norm1_1/Add"](%/up_blocks.1/resnets.2/norm1_1/Mul_output_0, %onnx::Add_10664), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2_1/Sigmoid_output_0 : Float(1, 192, 16, 8, strides=[24576, 128, 8, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.2_1/Sigmoid"](%/up_blocks.1/resnets.2/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2_1/Mul_output_0 : Float(1, 192, 16, 8, strides=[24576, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2_1/Mul"](%/up_blocks.1/resnets.2/norm1_1/Add_output_0, %/up_blocks.1/resnets.2_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2/conv1_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.2/conv1_1/Conv"](%/up_blocks.1/resnets.2_1/Mul_output_0, %inner_unet.up_blocks.1.resnets.2.conv1.weight, %inner_unet.up_blocks.1.resnets.2.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.2/time_layer_1/Gemm_output_0 : Float(1, 256, strides=[256, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.1/resnets.2/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.up_blocks.1.resnets.2.time_layer.weight, %inner_unet.up_blocks.1.resnets.2.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/resnets.2_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Unsqueeze_output_0 : Float(1, 256, 1, strides=[256, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.2_1/Unsqueeze"](%/up_blocks.1/resnets.2/time_layer_1/Gemm_output_0, %/up_blocks.1/resnets.2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Unsqueeze_1_output_0 : Float(1, 256, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.2_1/Unsqueeze_1"](%/up_blocks.1/resnets.2_1/Unsqueeze_output_0, %/up_blocks.1/resnets.2_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.2_1/Shape"](%/up_blocks.1/resnets.2_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/resnets.2_1/Gather"](%/up_blocks.1/resnets.2_1/Shape_output_0, %/up_blocks.1/resnets.2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/resnets.2_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/resnets.2_1/Add"](%/up_blocks.1/resnets.2_1/Gather_output_0, %/up_blocks.1/resnets.2_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.2_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/resnets.2_1/Div"](%/up_blocks.1/resnets.2_1/Add_output_0, %/up_blocks.1/resnets.2_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2_1/Mul_1"](%/up_blocks.1/resnets.2_1/Div_output_0, %/up_blocks.1/resnets.2_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Slice_output_0 : Float(1, 128, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.2_1/Slice"](%/up_blocks.1/resnets.2_1/Unsqueeze_1_output_0, %/up_blocks.1/resnets.2_1/Constant_3_output_0, %/up_blocks.1/resnets.2_1/Mul_1_output_0, %/up_blocks.1/resnets.2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.2_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2_1/Mul_2"](%/up_blocks.1/resnets.2_1/Div_output_0, %/up_blocks.1/resnets.2_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_1/Slice_1_output_0 : Float(1, 128, 1, 1, strides=[256, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.2_1/Slice_1"](%/up_blocks.1/resnets.2_1/Unsqueeze_1_output_0, %/up_blocks.1/resnets.2_1/Mul_1_output_0, %/up_blocks.1/resnets.2_1/Mul_2_output_0, %/up_blocks.1/resnets.2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.2/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_1/Reshape_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm2_1/Reshape"](%/up_blocks.1/resnets.2/conv1_1/Conv_output_0, %/up_blocks.1/resnets.2/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 512, strides=[16384, 512, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.2/norm2_1/InstanceNormalization"](%/up_blocks.1/resnets.2/norm2_1/Reshape_output_0, %/up_blocks.1/resnets.2/norm2_1/Constant_1_output_0, %/up_blocks.1/resnets.2/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.2/norm2_1/Shape"](%/up_blocks.1/resnets.2/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_1/Reshape_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm2_1/Reshape_1"](%/up_blocks.1/resnets.2/norm2_1/InstanceNormalization_output_0, %/up_blocks.1/resnets.2/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_1/Mul_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/norm2_1/Mul"](%/up_blocks.1/resnets.2/norm2_1/Reshape_1_output_0, %onnx::Mul_10665), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_1/Add_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2/norm2_1/Add"](%/up_blocks.1/resnets.2/norm2_1/Mul_output_0, %onnx::Add_10666), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2_1/Add_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2_1/Add_1"](%/up_blocks.1/resnets.2_1/Slice_output_0, %/up_blocks.1/resnets.2_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2_1/Mul_3_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2_1/Mul_3"](%/up_blocks.1/resnets.2/norm2_1/Add_output_0, %/up_blocks.1/resnets.2_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2_1/Add_2_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2_1/Add_2"](%/up_blocks.1/resnets.2_1/Mul_3_output_0, %/up_blocks.1/resnets.2_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2_1/Sigmoid_1_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.2_1/Sigmoid_1"](%/up_blocks.1/resnets.2_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2_1/Mul_4_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2_1/Mul_4"](%/up_blocks.1/resnets.2_1/Add_2_output_0, %/up_blocks.1/resnets.2_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2/conv2_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.2/conv2_1/Conv"](%/up_blocks.1/resnets.2_1/Mul_4_output_0, %inner_unet.up_blocks.1.resnets.2.conv2.weight, %inner_unet.up_blocks.1.resnets.2.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.2/conv3_1/Conv_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/resnets.2/conv3_1/Conv"](%/up_blocks.1_1/Concat_2_output_0, %inner_unet.up_blocks.1.resnets.2.conv3.weight, %inner_unet.up_blocks.1.resnets.2.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.2_1/Add_3_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2_1/Add_3"](%/up_blocks.1/resnets.2/conv2_1/Conv_output_0, %/up_blocks.1/resnets.2/conv3_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.1_1/Cast_output_0 : Float(1, 128, 16, 8, strides=[16384, 128, 8, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1_1/Cast"](%/up_blocks.1/resnets.2_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.1_1/Constant_output_0 : Float(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1  1  2  2 [ CPUFloatType{4} ], onnx_name="/up_blocks.1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %onnx::Resize_8524 : Tensor? = prim::Constant(), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.1_1/Resize_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Resize[coordinate_transformation_mode="asymmetric", cubic_coeff_a=-0.75, mode="nearest", nearest_mode="floor", onnx_name="/up_blocks.1_1/Resize"](%/up_blocks.1_1/Cast_output_0, %onnx::Resize_8524, %/up_blocks.1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.1_1/Cast_1_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1_1/Cast_1"](%/up_blocks.1_1/Resize_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.1/resample_1/Conv_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resample_1/Conv"](%/up_blocks.1_1/Cast_1_output_0, %inner_unet.up_blocks.1.resample.weight, %inner_unet.up_blocks.1.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2_1/Concat_output_0 : Float(1, 192, 32, 16, strides=[98304, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.2_1/Concat"](%/up_blocks.1/resample_1/Conv_output_0, %/down_blocks.0/resnets.1_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.2/resnets.0/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.0/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_1/Reshape_output_0 : Float(1, 32, 3072, strides=[98304, 3072, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm1_1/Reshape"](%/up_blocks.2_1/Concat_output_0, %/up_blocks.2/resnets.0/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 3072, strides=[98304, 3072, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.0/norm1_1/InstanceNormalization"](%/up_blocks.2/resnets.0/norm1_1/Reshape_output_0, %/up_blocks.2/resnets.0/norm1_1/Constant_1_output_0, %/up_blocks.2/resnets.0/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.0/norm1_1/Shape"](%/up_blocks.2_1/Concat_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_1/Reshape_1_output_0 : Float(1, 192, 32, 16, strides=[98304, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm1_1/Reshape_1"](%/up_blocks.2/resnets.0/norm1_1/InstanceNormalization_output_0, %/up_blocks.2/resnets.0/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_1/Mul_output_0 : Float(1, 192, 32, 16, strides=[98304, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/norm1_1/Mul"](%/up_blocks.2/resnets.0/norm1_1/Reshape_1_output_0, %onnx::Mul_10668), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_1/Add_output_0 : Float(1, 192, 32, 16, strides=[98304, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0/norm1_1/Add"](%/up_blocks.2/resnets.0/norm1_1/Mul_output_0, %onnx::Add_10669), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0_1/Sigmoid_output_0 : Float(1, 192, 32, 16, strides=[98304, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.0_1/Sigmoid"](%/up_blocks.2/resnets.0/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0_1/Mul_output_0 : Float(1, 192, 32, 16, strides=[98304, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0_1/Mul"](%/up_blocks.2/resnets.0/norm1_1/Add_output_0, %/up_blocks.2/resnets.0_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0/conv1_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.0/conv1_1/Conv"](%/up_blocks.2/resnets.0_1/Mul_output_0, %inner_unet.up_blocks.2.resnets.0.conv1.weight, %inner_unet.up_blocks.2.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.0/time_layer_1/Gemm_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.2/resnets.0/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.up_blocks.2.resnets.0.time_layer.weight, %inner_unet.up_blocks.2.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.2/resnets.0_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.0_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Unsqueeze_output_0 : Float(1, 128, 1, strides=[128, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.0_1/Unsqueeze"](%/up_blocks.2/resnets.0/time_layer_1/Gemm_output_0, %/up_blocks.2/resnets.0_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.0_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Unsqueeze_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.0_1/Unsqueeze_1"](%/up_blocks.2/resnets.0_1/Unsqueeze_output_0, %/up_blocks.2/resnets.0_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.0_1/Shape"](%/up_blocks.2/resnets.0_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.2/resnets.0_1/Gather"](%/up_blocks.2/resnets.0_1/Shape_output_0, %/up_blocks.2/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.2/resnets.0_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.2/resnets.0_1/Add"](%/up_blocks.2/resnets.0_1/Gather_output_0, %/up_blocks.2/resnets.0_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.0_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.2/resnets.0_1/Div"](%/up_blocks.2/resnets.0_1/Add_output_0, %/up_blocks.2/resnets.0_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0_1/Mul_1"](%/up_blocks.2/resnets.0_1/Div_output_0, %/up_blocks.2/resnets.0_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Slice_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.0_1/Slice"](%/up_blocks.2/resnets.0_1/Unsqueeze_1_output_0, %/up_blocks.2/resnets.0_1/Constant_3_output_0, %/up_blocks.2/resnets.0_1/Mul_1_output_0, %/up_blocks.2/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.0_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0_1/Mul_2"](%/up_blocks.2/resnets.0_1/Div_output_0, %/up_blocks.2/resnets.0_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_1/Slice_1_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.0_1/Slice_1"](%/up_blocks.2/resnets.0_1/Unsqueeze_1_output_0, %/up_blocks.2/resnets.0_1/Mul_1_output_0, %/up_blocks.2/resnets.0_1/Mul_2_output_0, %/up_blocks.2/resnets.0_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.0/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_1/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm2_1/Reshape"](%/up_blocks.2/resnets.0/conv1_1/Conv_output_0, %/up_blocks.2/resnets.0/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.0/norm2_1/InstanceNormalization"](%/up_blocks.2/resnets.0/norm2_1/Reshape_output_0, %/up_blocks.2/resnets.0/norm2_1/Constant_1_output_0, %/up_blocks.2/resnets.0/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.0/norm2_1/Shape"](%/up_blocks.2/resnets.0/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_1/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm2_1/Reshape_1"](%/up_blocks.2/resnets.0/norm2_1/InstanceNormalization_output_0, %/up_blocks.2/resnets.0/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_1/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/norm2_1/Mul"](%/up_blocks.2/resnets.0/norm2_1/Reshape_1_output_0, %onnx::Mul_10670), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_1/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0/norm2_1/Add"](%/up_blocks.2/resnets.0/norm2_1/Mul_output_0, %onnx::Add_10671), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0_1/Add_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0_1/Add_1"](%/up_blocks.2/resnets.0_1/Slice_output_0, %/up_blocks.2/resnets.0_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0_1/Mul_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0_1/Mul_3"](%/up_blocks.2/resnets.0/norm2_1/Add_output_0, %/up_blocks.2/resnets.0_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0_1/Add_2_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0_1/Add_2"](%/up_blocks.2/resnets.0_1/Mul_3_output_0, %/up_blocks.2/resnets.0_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0_1/Sigmoid_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.0_1/Sigmoid_1"](%/up_blocks.2/resnets.0_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0_1/Mul_4_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0_1/Mul_4"](%/up_blocks.2/resnets.0_1/Add_2_output_0, %/up_blocks.2/resnets.0_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0/conv2_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.0/conv2_1/Conv"](%/up_blocks.2/resnets.0_1/Mul_4_output_0, %inner_unet.up_blocks.2.resnets.0.conv2.weight, %inner_unet.up_blocks.2.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.0/conv3_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.2/resnets.0/conv3_1/Conv"](%/up_blocks.2_1/Concat_output_0, %inner_unet.up_blocks.2.resnets.0.conv3.weight, %inner_unet.up_blocks.2.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.0_1/Add_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0_1/Add_3"](%/up_blocks.2/resnets.0/conv2_1/Conv_output_0, %/up_blocks.2/resnets.0/conv3_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.2_1/Concat_1_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.2_1/Concat_1"](%/up_blocks.2/resnets.0_1/Add_3_output_0, %/down_blocks.0/resnets.0_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.2/resnets.1/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.1/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_1/Reshape_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm1_1/Reshape"](%/up_blocks.2_1/Concat_1_output_0, %/up_blocks.2/resnets.1/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.1/norm1_1/InstanceNormalization"](%/up_blocks.2/resnets.1/norm1_1/Reshape_output_0, %/up_blocks.2/resnets.1/norm1_1/Constant_1_output_0, %/up_blocks.2/resnets.1/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.1/norm1_1/Shape"](%/up_blocks.2_1/Concat_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_1/Reshape_1_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm1_1/Reshape_1"](%/up_blocks.2/resnets.1/norm1_1/InstanceNormalization_output_0, %/up_blocks.2/resnets.1/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_1/Mul_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/norm1_1/Mul"](%/up_blocks.2/resnets.1/norm1_1/Reshape_1_output_0, %onnx::Mul_10672), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_1/Add_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1/norm1_1/Add"](%/up_blocks.2/resnets.1/norm1_1/Mul_output_0, %onnx::Add_10673), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1_1/Sigmoid_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.1_1/Sigmoid"](%/up_blocks.2/resnets.1/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1_1/Mul_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1_1/Mul"](%/up_blocks.2/resnets.1/norm1_1/Add_output_0, %/up_blocks.2/resnets.1_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1/conv1_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.1/conv1_1/Conv"](%/up_blocks.2/resnets.1_1/Mul_output_0, %inner_unet.up_blocks.2.resnets.1.conv1.weight, %inner_unet.up_blocks.2.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.1/time_layer_1/Gemm_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.2/resnets.1/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.up_blocks.2.resnets.1.time_layer.weight, %inner_unet.up_blocks.2.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.2/resnets.1_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Unsqueeze_output_0 : Float(1, 128, 1, strides=[128, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.1_1/Unsqueeze"](%/up_blocks.2/resnets.1/time_layer_1/Gemm_output_0, %/up_blocks.2/resnets.1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Unsqueeze_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.1_1/Unsqueeze_1"](%/up_blocks.2/resnets.1_1/Unsqueeze_output_0, %/up_blocks.2/resnets.1_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.1_1/Shape"](%/up_blocks.2/resnets.1_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.2/resnets.1_1/Gather"](%/up_blocks.2/resnets.1_1/Shape_output_0, %/up_blocks.2/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.2/resnets.1_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.2/resnets.1_1/Add"](%/up_blocks.2/resnets.1_1/Gather_output_0, %/up_blocks.2/resnets.1_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.1_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.2/resnets.1_1/Div"](%/up_blocks.2/resnets.1_1/Add_output_0, %/up_blocks.2/resnets.1_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1_1/Mul_1"](%/up_blocks.2/resnets.1_1/Div_output_0, %/up_blocks.2/resnets.1_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Slice_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.1_1/Slice"](%/up_blocks.2/resnets.1_1/Unsqueeze_1_output_0, %/up_blocks.2/resnets.1_1/Constant_3_output_0, %/up_blocks.2/resnets.1_1/Mul_1_output_0, %/up_blocks.2/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.1_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1_1/Mul_2"](%/up_blocks.2/resnets.1_1/Div_output_0, %/up_blocks.2/resnets.1_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_1/Slice_1_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.1_1/Slice_1"](%/up_blocks.2/resnets.1_1/Unsqueeze_1_output_0, %/up_blocks.2/resnets.1_1/Mul_1_output_0, %/up_blocks.2/resnets.1_1/Mul_2_output_0, %/up_blocks.2/resnets.1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.1/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_1/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm2_1/Reshape"](%/up_blocks.2/resnets.1/conv1_1/Conv_output_0, %/up_blocks.2/resnets.1/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.1/norm2_1/InstanceNormalization"](%/up_blocks.2/resnets.1/norm2_1/Reshape_output_0, %/up_blocks.2/resnets.1/norm2_1/Constant_1_output_0, %/up_blocks.2/resnets.1/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.1/norm2_1/Shape"](%/up_blocks.2/resnets.1/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_1/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm2_1/Reshape_1"](%/up_blocks.2/resnets.1/norm2_1/InstanceNormalization_output_0, %/up_blocks.2/resnets.1/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_1/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/norm2_1/Mul"](%/up_blocks.2/resnets.1/norm2_1/Reshape_1_output_0, %onnx::Mul_10674), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_1/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1/norm2_1/Add"](%/up_blocks.2/resnets.1/norm2_1/Mul_output_0, %onnx::Add_10675), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1_1/Add_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1_1/Add_1"](%/up_blocks.2/resnets.1_1/Slice_output_0, %/up_blocks.2/resnets.1_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1_1/Mul_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1_1/Mul_3"](%/up_blocks.2/resnets.1/norm2_1/Add_output_0, %/up_blocks.2/resnets.1_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1_1/Add_2_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1_1/Add_2"](%/up_blocks.2/resnets.1_1/Mul_3_output_0, %/up_blocks.2/resnets.1_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1_1/Sigmoid_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.1_1/Sigmoid_1"](%/up_blocks.2/resnets.1_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1_1/Mul_4_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1_1/Mul_4"](%/up_blocks.2/resnets.1_1/Add_2_output_0, %/up_blocks.2/resnets.1_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1/conv2_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.1/conv2_1/Conv"](%/up_blocks.2/resnets.1_1/Mul_4_output_0, %inner_unet.up_blocks.2.resnets.1.conv2.weight, %inner_unet.up_blocks.2.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.1/conv3_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.2/resnets.1/conv3_1/Conv"](%/up_blocks.2_1/Concat_1_output_0, %inner_unet.up_blocks.2.resnets.1.conv3.weight, %inner_unet.up_blocks.2.resnets.1.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.1_1/Add_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1_1/Add_3"](%/up_blocks.2/resnets.1/conv2_1/Conv_output_0, %/up_blocks.2/resnets.1/conv3_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.2_1/Concat_2_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.2_1/Concat_2"](%/up_blocks.2/resnets.1_1/Add_3_output_0, %/Add_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.2/resnets.2/norm1_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.2/norm1_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_1/Reshape_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm1_1/Reshape"](%/up_blocks.2_1/Concat_2_output_0, %/up_blocks.2/resnets.2/norm1_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm1_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm1_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_1/InstanceNormalization_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.2/norm1_1/InstanceNormalization"](%/up_blocks.2/resnets.2/norm1_1/Reshape_output_0, %/up_blocks.2/resnets.2/norm1_1/Constant_1_output_0, %/up_blocks.2/resnets.2/norm1_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.2/norm1_1/Shape"](%/up_blocks.2_1/Concat_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_1/Reshape_1_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm1_1/Reshape_1"](%/up_blocks.2/resnets.2/norm1_1/InstanceNormalization_output_0, %/up_blocks.2/resnets.2/norm1_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_1/Mul_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/norm1_1/Mul"](%/up_blocks.2/resnets.2/norm1_1/Reshape_1_output_0, %onnx::Mul_10676), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_1/Add_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2/norm1_1/Add"](%/up_blocks.2/resnets.2/norm1_1/Mul_output_0, %onnx::Add_10677), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2_1/Sigmoid_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.2_1/Sigmoid"](%/up_blocks.2/resnets.2/norm1_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2_1/Mul_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2_1/Mul"](%/up_blocks.2/resnets.2/norm1_1/Add_output_0, %/up_blocks.2/resnets.2_1/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2/conv1_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.2/conv1_1/Conv"](%/up_blocks.2/resnets.2_1/Mul_output_0, %inner_unet.up_blocks.2.resnets.2.conv1.weight, %inner_unet.up_blocks.2.resnets.2.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.2/time_layer_1/Gemm_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.2/resnets.2/time_layer_1/Gemm"](%/down_blocks.0/resnets.0_1/Mul_1_output_0, %inner_unet.up_blocks.2.resnets.2.time_layer.weight, %inner_unet.up_blocks.2.resnets.2.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.2/resnets.2_1/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Unsqueeze_output_0 : Float(1, 128, 1, strides=[128, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.2_1/Unsqueeze"](%/up_blocks.2/resnets.2/time_layer_1/Gemm_output_0, %/up_blocks.2/resnets.2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Unsqueeze_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.2_1/Unsqueeze_1"](%/up_blocks.2/resnets.2_1/Unsqueeze_output_0, %/up_blocks.2/resnets.2_1/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.2_1/Shape"](%/up_blocks.2/resnets.2_1/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.2/resnets.2_1/Gather"](%/up_blocks.2/resnets.2_1/Shape_output_0, %/up_blocks.2/resnets.2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.2/resnets.2_1/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2_1/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.2/resnets.2_1/Add"](%/up_blocks.2/resnets.2_1/Gather_output_0, %/up_blocks.2/resnets.2_1/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.2_1/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.2/resnets.2_1/Div"](%/up_blocks.2/resnets.2_1/Add_output_0, %/up_blocks.2/resnets.2_1/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2_1/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2_1/Mul_1"](%/up_blocks.2/resnets.2_1/Div_output_0, %/up_blocks.2/resnets.2_1/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Slice_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.2_1/Slice"](%/up_blocks.2/resnets.2_1/Unsqueeze_1_output_0, %/up_blocks.2/resnets.2_1/Constant_3_output_0, %/up_blocks.2/resnets.2_1/Mul_1_output_0, %/up_blocks.2/resnets.2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.2_1/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2_1/Mul_2"](%/up_blocks.2/resnets.2_1/Div_output_0, %/up_blocks.2/resnets.2_1/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_1/Slice_1_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.2_1/Slice_1"](%/up_blocks.2/resnets.2_1/Unsqueeze_1_output_0, %/up_blocks.2/resnets.2_1/Mul_1_output_0, %/up_blocks.2/resnets.2_1/Mul_2_output_0, %/up_blocks.2/resnets.2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/norm2_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.2/norm2_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_1/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm2_1/Reshape"](%/up_blocks.2/resnets.2/conv1_1/Conv_output_0, %/up_blocks.2/resnets.2/norm2_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm2_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm2_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_1/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.2/norm2_1/InstanceNormalization"](%/up_blocks.2/resnets.2/norm2_1/Reshape_output_0, %/up_blocks.2/resnets.2/norm2_1/Constant_1_output_0, %/up_blocks.2/resnets.2/norm2_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.2/norm2_1/Shape"](%/up_blocks.2/resnets.2/conv1_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_1/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm2_1/Reshape_1"](%/up_blocks.2/resnets.2/norm2_1/InstanceNormalization_output_0, %/up_blocks.2/resnets.2/norm2_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_1/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/norm2_1/Mul"](%/up_blocks.2/resnets.2/norm2_1/Reshape_1_output_0, %onnx::Mul_10678), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_1/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2/norm2_1/Add"](%/up_blocks.2/resnets.2/norm2_1/Mul_output_0, %onnx::Add_10679), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2_1/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2_1/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2_1/Add_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2_1/Add_1"](%/up_blocks.2/resnets.2_1/Slice_output_0, %/up_blocks.2/resnets.2_1/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2_1/Mul_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2_1/Mul_3"](%/up_blocks.2/resnets.2/norm2_1/Add_output_0, %/up_blocks.2/resnets.2_1/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2_1/Add_2_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2_1/Add_2"](%/up_blocks.2/resnets.2_1/Mul_3_output_0, %/up_blocks.2/resnets.2_1/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2_1/Sigmoid_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.2_1/Sigmoid_1"](%/up_blocks.2/resnets.2_1/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2_1/Mul_4_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2_1/Mul_4"](%/up_blocks.2/resnets.2_1/Add_2_output_0, %/up_blocks.2/resnets.2_1/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2/conv2_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.2/conv2_1/Conv"](%/up_blocks.2/resnets.2_1/Mul_4_output_0, %inner_unet.up_blocks.2.resnets.2.conv2.weight, %inner_unet.up_blocks.2.resnets.2.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.2/conv3_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.2/resnets.2/conv3_1/Conv"](%/up_blocks.2_1/Concat_2_output_0, %inner_unet.up_blocks.2.resnets.2.conv3.weight, %inner_unet.up_blocks.2.resnets.2.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.2_1/Add_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2_1/Add_3"](%/up_blocks.2/resnets.2/conv2_1/Conv_output_0, %/up_blocks.2/resnets.2/conv3_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/norm_out_1/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/norm_out_1/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_1/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/norm_out_1/Reshape"](%/up_blocks.2/resnets.2_1/Add_3_output_0, %/norm_out_1/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_1/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/norm_out_1/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_1/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/norm_out_1/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_1/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/norm_out_1/InstanceNormalization"](%/norm_out_1/Reshape_output_0, %/norm_out_1/Constant_1_output_0, %/norm_out_1/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_1/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/norm_out_1/Shape"](%/up_blocks.2/resnets.2_1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_1/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/norm_out_1/Reshape_1"](%/norm_out_1/InstanceNormalization_output_0, %/norm_out_1/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_1/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/norm_out_1/Mul"](%/norm_out_1/Reshape_1_output_0, %onnx::Mul_10680), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_1/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/norm_out_1/Add"](%/norm_out_1/Mul_output_0, %onnx::Add_10681), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/Sigmoid_7_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/Sigmoid_7"](%/norm_out_1/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/Mul_17_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_17"](%/norm_out_1/Add_output_0, %/Sigmoid_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %ot_2 : Float(1, 3, 32, 16, strides=[1536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/conv_out_1/Conv"](%/Mul_17_output_0, %inner_unet.conv_out.weight, %inner_unet.conv_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.conv.Conv2d::conv_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/out_adapter_1/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/out_adapter_1/Conv"](%/up_blocks.2/resnets.2_1/Add_3_output_0, %out_adapter.weight, %out_adapter.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.conv.Conv2d::out_adapter # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/Add_9_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/Add_9"](%/down_blocks.2/resnets.0/Add_3_output_0, %/out_adapter_1/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/nested_unet.py:216:0
  %/up_blocks.0_2/Concat_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.0_2/Concat"](%/Add_9_output_0, %/down_blocks.2/resnets.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.0/resnets.0/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.0/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_2/Reshape_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm1_2/Reshape"](%/up_blocks.0_2/Concat_output_0, %/up_blocks.0/resnets.0/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.0/norm1_2/InstanceNormalization"](%/up_blocks.0/resnets.0/norm1_2/Reshape_output_0, %/up_blocks.0/resnets.0/norm1_2/Constant_1_output_0, %/up_blocks.0/resnets.0/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.0/norm1_2/Shape"](%/up_blocks.0_2/Concat_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_2/Reshape_1_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm1_2/Reshape_1"](%/up_blocks.0/resnets.0/norm1_2/InstanceNormalization_output_0, %/up_blocks.0/resnets.0/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_2/Mul_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/norm1_2/Mul"](%/up_blocks.0/resnets.0/norm1_2/Reshape_1_output_0, %onnx::Mul_10682), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm1_2/Add_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0/norm1_2/Add"](%/up_blocks.0/resnets.0/norm1_2/Mul_output_0, %onnx::Add_10683), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0_2/Sigmoid_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.0_2/Sigmoid"](%/up_blocks.0/resnets.0/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0_2/Mul_output_0 : Float(1, 128, 32, 16, strides=[65536, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0_2/Mul"](%/up_blocks.0/resnets.0/norm1_2/Add_output_0, %/up_blocks.0/resnets.0_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0/conv1_2/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.0/conv1_2/Conv"](%/up_blocks.0/resnets.0_2/Mul_output_0, %up_blocks.0.resnets.0.conv1.weight, %up_blocks.0.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.0/time_layer_2/Gemm_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.0/resnets.0/time_layer_2/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %up_blocks.0.resnets.0.time_layer.weight, %up_blocks.0.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/resnets.0_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.0_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Unsqueeze_output_0 : Float(1, 128, 1, strides=[128, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.0_2/Unsqueeze"](%/up_blocks.0/resnets.0/time_layer_2/Gemm_output_0, %/up_blocks.0/resnets.0_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.0_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Unsqueeze_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.0_2/Unsqueeze_1"](%/up_blocks.0/resnets.0_2/Unsqueeze_output_0, %/up_blocks.0/resnets.0_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.0_2/Shape"](%/up_blocks.0/resnets.0_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/resnets.0_2/Gather"](%/up_blocks.0/resnets.0_2/Shape_output_0, %/up_blocks.0/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/resnets.0_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/resnets.0_2/Add"](%/up_blocks.0/resnets.0_2/Gather_output_0, %/up_blocks.0/resnets.0_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.0_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/resnets.0_2/Div"](%/up_blocks.0/resnets.0_2/Add_output_0, %/up_blocks.0/resnets.0_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0_2/Mul_1"](%/up_blocks.0/resnets.0_2/Div_output_0, %/up_blocks.0/resnets.0_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Slice_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.0_2/Slice"](%/up_blocks.0/resnets.0_2/Unsqueeze_1_output_0, %/up_blocks.0/resnets.0_2/Constant_3_output_0, %/up_blocks.0/resnets.0_2/Mul_1_output_0, %/up_blocks.0/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.0_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0_2/Mul_2"](%/up_blocks.0/resnets.0_2/Div_output_0, %/up_blocks.0/resnets.0_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0_2/Slice_1_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.0_2/Slice_1"](%/up_blocks.0/resnets.0_2/Unsqueeze_1_output_0, %/up_blocks.0/resnets.0_2/Mul_1_output_0, %/up_blocks.0/resnets.0_2/Mul_2_output_0, %/up_blocks.0/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.0/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.0/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_2/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm2_2/Reshape"](%/up_blocks.0/resnets.0/conv1_2/Conv_output_0, %/up_blocks.0/resnets.0/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.0/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.0/norm2_2/InstanceNormalization"](%/up_blocks.0/resnets.0/norm2_2/Reshape_output_0, %/up_blocks.0/resnets.0/norm2_2/Constant_1_output_0, %/up_blocks.0/resnets.0/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.0/norm2_2/Shape"](%/up_blocks.0/resnets.0/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_2/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.0/norm2_2/Reshape_1"](%/up_blocks.0/resnets.0/norm2_2/InstanceNormalization_output_0, %/up_blocks.0/resnets.0/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_2/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0/norm2_2/Mul"](%/up_blocks.0/resnets.0/norm2_2/Reshape_1_output_0, %onnx::Mul_10684), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0/norm2_2/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0/norm2_2/Add"](%/up_blocks.0/resnets.0/norm2_2/Mul_output_0, %onnx::Add_10685), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.0_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.0_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0_2/Add_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0_2/Add_1"](%/up_blocks.0/resnets.0_2/Slice_output_0, %/up_blocks.0/resnets.0_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0_2/Mul_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0_2/Mul_3"](%/up_blocks.0/resnets.0/norm2_2/Add_output_0, %/up_blocks.0/resnets.0_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0_2/Add_2_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0_2/Add_2"](%/up_blocks.0/resnets.0_2/Mul_3_output_0, %/up_blocks.0/resnets.0_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.0_2/Sigmoid_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.0_2/Sigmoid_1"](%/up_blocks.0/resnets.0_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0_2/Mul_4_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.0_2/Mul_4"](%/up_blocks.0/resnets.0_2/Add_2_output_0, %/up_blocks.0/resnets.0_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.0/conv2_2/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.0/conv2_2/Conv"](%/up_blocks.0/resnets.0_2/Mul_4_output_0, %up_blocks.0.resnets.0.conv2.weight, %up_blocks.0.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.0/conv3_2/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/resnets.0/conv3_2/Conv"](%/up_blocks.0_2/Concat_output_0, %up_blocks.0.resnets.0.conv3.weight, %up_blocks.0.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.0_2/Add_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.0_2/Add_3"](%/up_blocks.0/resnets.0/conv2_2/Conv_output_0, %/up_blocks.0/resnets.0/conv3_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.0_2/Concat_1_output_0 : Float(1, 96, 32, 16, strides=[49152, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.0_2/Concat_1"](%/up_blocks.0/resnets.0_2/Add_3_output_0, %/down_blocks.1/resample/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.0/resnets.1/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.1/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_2/Reshape_output_0 : Float(1, 32, 1536, strides=[49152, 1536, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm1_2/Reshape"](%/up_blocks.0_2/Concat_1_output_0, %/up_blocks.0/resnets.1/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 1536, strides=[49152, 1536, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.1/norm1_2/InstanceNormalization"](%/up_blocks.0/resnets.1/norm1_2/Reshape_output_0, %/up_blocks.0/resnets.1/norm1_2/Constant_1_output_0, %/up_blocks.0/resnets.1/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.1/norm1_2/Shape"](%/up_blocks.0_2/Concat_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_2/Reshape_1_output_0 : Float(1, 96, 32, 16, strides=[49152, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm1_2/Reshape_1"](%/up_blocks.0/resnets.1/norm1_2/InstanceNormalization_output_0, %/up_blocks.0/resnets.1/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_2/Mul_output_0 : Float(1, 96, 32, 16, strides=[49152, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/norm1_2/Mul"](%/up_blocks.0/resnets.1/norm1_2/Reshape_1_output_0, %onnx::Mul_10686), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm1_2/Add_output_0 : Float(1, 96, 32, 16, strides=[49152, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1/norm1_2/Add"](%/up_blocks.0/resnets.1/norm1_2/Mul_output_0, %onnx::Add_10687), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1_2/Sigmoid_output_0 : Float(1, 96, 32, 16, strides=[49152, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.1_2/Sigmoid"](%/up_blocks.0/resnets.1/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1_2/Mul_output_0 : Float(1, 96, 32, 16, strides=[49152, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1_2/Mul"](%/up_blocks.0/resnets.1/norm1_2/Add_output_0, %/up_blocks.0/resnets.1_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1/conv1_2/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.1/conv1_2/Conv"](%/up_blocks.0/resnets.1_2/Mul_output_0, %up_blocks.0.resnets.1.conv1.weight, %up_blocks.0.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.1/time_layer_2/Gemm_output_0 : Float(1, 128, strides=[128, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.0/resnets.1/time_layer_2/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %up_blocks.0.resnets.1.time_layer.weight, %up_blocks.0.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.0/resnets.1_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Unsqueeze_output_0 : Float(1, 128, 1, strides=[128, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.1_2/Unsqueeze"](%/up_blocks.0/resnets.1/time_layer_2/Gemm_output_0, %/up_blocks.0/resnets.1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.0/resnets.1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Unsqueeze_1_output_0 : Float(1, 128, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.0/resnets.1_2/Unsqueeze_1"](%/up_blocks.0/resnets.1_2/Unsqueeze_output_0, %/up_blocks.0/resnets.1_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.1_2/Shape"](%/up_blocks.0/resnets.1_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.0/resnets.1_2/Gather"](%/up_blocks.0/resnets.1_2/Shape_output_0, %/up_blocks.0/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.0/resnets.1_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.0/resnets.1_2/Add"](%/up_blocks.0/resnets.1_2/Gather_output_0, %/up_blocks.0/resnets.1_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.1_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.0/resnets.1_2/Div"](%/up_blocks.0/resnets.1_2/Add_output_0, %/up_blocks.0/resnets.1_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1_2/Mul_1"](%/up_blocks.0/resnets.1_2/Div_output_0, %/up_blocks.0/resnets.1_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Slice_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.1_2/Slice"](%/up_blocks.0/resnets.1_2/Unsqueeze_1_output_0, %/up_blocks.0/resnets.1_2/Constant_3_output_0, %/up_blocks.0/resnets.1_2/Mul_1_output_0, %/up_blocks.0/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.0/resnets.1_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1_2/Mul_2"](%/up_blocks.0/resnets.1_2/Div_output_0, %/up_blocks.0/resnets.1_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1_2/Slice_1_output_0 : Float(1, 64, 1, 1, strides=[128, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.0/resnets.1_2/Slice_1"](%/up_blocks.0/resnets.1_2/Unsqueeze_1_output_0, %/up_blocks.0/resnets.1_2/Mul_1_output_0, %/up_blocks.0/resnets.1_2/Mul_2_output_0, %/up_blocks.0/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.0/resnets.1/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.0/resnets.1/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_2/Reshape_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm2_2/Reshape"](%/up_blocks.0/resnets.1/conv1_2/Conv_output_0, %/up_blocks.0/resnets.1/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.0/resnets.1/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 1024, strides=[32768, 1024, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.0/resnets.1/norm2_2/InstanceNormalization"](%/up_blocks.0/resnets.1/norm2_2/Reshape_output_0, %/up_blocks.0/resnets.1/norm2_2/Constant_1_output_0, %/up_blocks.0/resnets.1/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.0/resnets.1/norm2_2/Shape"](%/up_blocks.0/resnets.1/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_2/Reshape_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.0/resnets.1/norm2_2/Reshape_1"](%/up_blocks.0/resnets.1/norm2_2/InstanceNormalization_output_0, %/up_blocks.0/resnets.1/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_2/Mul_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1/norm2_2/Mul"](%/up_blocks.0/resnets.1/norm2_2/Reshape_1_output_0, %onnx::Mul_10688), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1/norm2_2/Add_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1/norm2_2/Add"](%/up_blocks.0/resnets.1/norm2_2/Mul_output_0, %onnx::Add_10689), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.0/resnets.1_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.0/resnets.1_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1_2/Add_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1_2/Add_1"](%/up_blocks.0/resnets.1_2/Slice_output_0, %/up_blocks.0/resnets.1_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1_2/Mul_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1_2/Mul_3"](%/up_blocks.0/resnets.1/norm2_2/Add_output_0, %/up_blocks.0/resnets.1_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1_2/Add_2_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1_2/Add_2"](%/up_blocks.0/resnets.1_2/Mul_3_output_0, %/up_blocks.0/resnets.1_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.0/resnets.1_2/Sigmoid_1_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.0/resnets.1_2/Sigmoid_1"](%/up_blocks.0/resnets.1_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1_2/Mul_4_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.0/resnets.1_2/Mul_4"](%/up_blocks.0/resnets.1_2/Add_2_output_0, %/up_blocks.0/resnets.1_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.0/resnets.1/conv2_2/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resnets.1/conv2_2/Conv"](%/up_blocks.0/resnets.1_2/Mul_4_output_0, %up_blocks.0.resnets.1.conv2.weight, %up_blocks.0.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.1/conv3_2/Conv_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.0/resnets.1/conv3_2/Conv"](%/up_blocks.0_2/Concat_1_output_0, %up_blocks.0.resnets.1.conv3.weight, %up_blocks.0.resnets.1.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.0/resnets.1_2/Add_3_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.0/resnets.1_2/Add_3"](%/up_blocks.0/resnets.1/conv2_2/Conv_output_0, %/up_blocks.0/resnets.1/conv3_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.0_2/Cast_output_0 : Float(1, 64, 32, 16, strides=[32768, 512, 16, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0_2/Cast"](%/up_blocks.0/resnets.1_2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.0_2/Constant_output_0 : Float(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1  1  2  2 [ CPUFloatType{4} ], onnx_name="/up_blocks.0_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %onnx::Resize_8840 : Tensor? = prim::Constant(), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.0_2/Resize_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Resize[coordinate_transformation_mode="asymmetric", cubic_coeff_a=-0.75, mode="nearest", nearest_mode="floor", onnx_name="/up_blocks.0_2/Resize"](%/up_blocks.0_2/Cast_output_0, %onnx::Resize_8840, %/up_blocks.0_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.0_2/Cast_1_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.0_2/Cast_1"](%/up_blocks.0_2/Resize_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.0/resample_2/Conv_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.0/resample_2/Conv"](%/up_blocks.0_2/Cast_1_output_0, %up_blocks.0.resample.weight, %up_blocks.0.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.0/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1_2/Concat_output_0 : Float(1, 96, 64, 32, strides=[196608, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.1_2/Concat"](%/up_blocks.0/resample_2/Conv_output_0, %/down_blocks.1/resnets.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.1/resnets.0/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.0/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_2/Reshape_output_0 : Float(1, 32, 6144, strides=[196608, 6144, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm1_2/Reshape"](%/up_blocks.1_2/Concat_output_0, %/up_blocks.1/resnets.0/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 6144, strides=[196608, 6144, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.0/norm1_2/InstanceNormalization"](%/up_blocks.1/resnets.0/norm1_2/Reshape_output_0, %/up_blocks.1/resnets.0/norm1_2/Constant_1_output_0, %/up_blocks.1/resnets.0/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.0/norm1_2/Shape"](%/up_blocks.1_2/Concat_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_2/Reshape_1_output_0 : Float(1, 96, 64, 32, strides=[196608, 2048, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm1_2/Reshape_1"](%/up_blocks.1/resnets.0/norm1_2/InstanceNormalization_output_0, %/up_blocks.1/resnets.0/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_2/Mul_output_0 : Float(1, 96, 64, 32, strides=[196608, 2048, 32, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/norm1_2/Mul"](%/up_blocks.1/resnets.0/norm1_2/Reshape_1_output_0, %onnx::Mul_10691), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm1_2/Add_output_0 : Float(1, 96, 64, 32, strides=[196608, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0/norm1_2/Add"](%/up_blocks.1/resnets.0/norm1_2/Mul_output_0, %onnx::Add_10692), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0_2/Sigmoid_output_0 : Float(1, 96, 64, 32, strides=[196608, 2048, 32, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.0_2/Sigmoid"](%/up_blocks.1/resnets.0/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0_2/Mul_output_0 : Float(1, 96, 64, 32, strides=[196608, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0_2/Mul"](%/up_blocks.1/resnets.0/norm1_2/Add_output_0, %/up_blocks.1/resnets.0_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0/conv1_2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.0/conv1_2/Conv"](%/up_blocks.1/resnets.0_2/Mul_output_0, %up_blocks.1.resnets.0.conv1.weight, %up_blocks.1.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.0/time_layer_2/Gemm_output_0 : Float(1, 64, strides=[64, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.1/resnets.0/time_layer_2/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %up_blocks.1.resnets.0.time_layer.weight, %up_blocks.1.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/resnets.0_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.0_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Unsqueeze_output_0 : Float(1, 64, 1, strides=[64, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.0_2/Unsqueeze"](%/up_blocks.1/resnets.0/time_layer_2/Gemm_output_0, %/up_blocks.1/resnets.0_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.0_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Unsqueeze_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.0_2/Unsqueeze_1"](%/up_blocks.1/resnets.0_2/Unsqueeze_output_0, %/up_blocks.1/resnets.0_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.0_2/Shape"](%/up_blocks.1/resnets.0_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/resnets.0_2/Gather"](%/up_blocks.1/resnets.0_2/Shape_output_0, %/up_blocks.1/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/resnets.0_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/resnets.0_2/Add"](%/up_blocks.1/resnets.0_2/Gather_output_0, %/up_blocks.1/resnets.0_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.0_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/resnets.0_2/Div"](%/up_blocks.1/resnets.0_2/Add_output_0, %/up_blocks.1/resnets.0_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0_2/Mul_1"](%/up_blocks.1/resnets.0_2/Div_output_0, %/up_blocks.1/resnets.0_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Slice_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.0_2/Slice"](%/up_blocks.1/resnets.0_2/Unsqueeze_1_output_0, %/up_blocks.1/resnets.0_2/Constant_3_output_0, %/up_blocks.1/resnets.0_2/Mul_1_output_0, %/up_blocks.1/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.0_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0_2/Mul_2"](%/up_blocks.1/resnets.0_2/Div_output_0, %/up_blocks.1/resnets.0_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0_2/Slice_1_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.0_2/Slice_1"](%/up_blocks.1/resnets.0_2/Unsqueeze_1_output_0, %/up_blocks.1/resnets.0_2/Mul_1_output_0, %/up_blocks.1/resnets.0_2/Mul_2_output_0, %/up_blocks.1/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.0/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.0/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_2/Reshape_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm2_2/Reshape"](%/up_blocks.1/resnets.0/conv1_2/Conv_output_0, %/up_blocks.1/resnets.0/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.0/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.0/norm2_2/InstanceNormalization"](%/up_blocks.1/resnets.0/norm2_2/Reshape_output_0, %/up_blocks.1/resnets.0/norm2_2/Constant_1_output_0, %/up_blocks.1/resnets.0/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.0/norm2_2/Shape"](%/up_blocks.1/resnets.0/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_2/Reshape_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.0/norm2_2/Reshape_1"](%/up_blocks.1/resnets.0/norm2_2/InstanceNormalization_output_0, %/up_blocks.1/resnets.0/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_2/Mul_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0/norm2_2/Mul"](%/up_blocks.1/resnets.0/norm2_2/Reshape_1_output_0, %onnx::Mul_10693), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0/norm2_2/Add_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0/norm2_2/Add"](%/up_blocks.1/resnets.0/norm2_2/Mul_output_0, %onnx::Add_10694), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.0_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.0_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0_2/Add_1_output_0 : Float(1, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0_2/Add_1"](%/up_blocks.1/resnets.0_2/Slice_output_0, %/up_blocks.1/resnets.0_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0_2/Mul_3_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0_2/Mul_3"](%/up_blocks.1/resnets.0/norm2_2/Add_output_0, %/up_blocks.1/resnets.0_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0_2/Add_2_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0_2/Add_2"](%/up_blocks.1/resnets.0_2/Mul_3_output_0, %/up_blocks.1/resnets.0_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.0_2/Sigmoid_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.0_2/Sigmoid_1"](%/up_blocks.1/resnets.0_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0_2/Mul_4_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.0_2/Mul_4"](%/up_blocks.1/resnets.0_2/Add_2_output_0, %/up_blocks.1/resnets.0_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.0/conv2_2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.0/conv2_2/Conv"](%/up_blocks.1/resnets.0_2/Mul_4_output_0, %up_blocks.1.resnets.0.conv2.weight, %up_blocks.1.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.0/conv3_2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/resnets.0/conv3_2/Conv"](%/up_blocks.1_2/Concat_output_0, %up_blocks.1.resnets.0.conv3.weight, %up_blocks.1.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.0_2/Add_3_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.0_2/Add_3"](%/up_blocks.1/resnets.0/conv2_2/Conv_output_0, %/up_blocks.1/resnets.0/conv3_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.1_2/Concat_1_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.1_2/Concat_1"](%/up_blocks.1/resnets.0_2/Add_3_output_0, %/down_blocks.1/resnets.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.1/resnets.1/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.1/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_2/Reshape_output_0 : Float(1, 32, 4096, strides=[131072, 4096, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm1_2/Reshape"](%/up_blocks.1_2/Concat_1_output_0, %/up_blocks.1/resnets.1/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 4096, strides=[131072, 4096, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.1/norm1_2/InstanceNormalization"](%/up_blocks.1/resnets.1/norm1_2/Reshape_output_0, %/up_blocks.1/resnets.1/norm1_2/Constant_1_output_0, %/up_blocks.1/resnets.1/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.1/norm1_2/Shape"](%/up_blocks.1_2/Concat_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_2/Reshape_1_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm1_2/Reshape_1"](%/up_blocks.1/resnets.1/norm1_2/InstanceNormalization_output_0, %/up_blocks.1/resnets.1/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_2/Mul_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/norm1_2/Mul"](%/up_blocks.1/resnets.1/norm1_2/Reshape_1_output_0, %onnx::Mul_10695), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm1_2/Add_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1/norm1_2/Add"](%/up_blocks.1/resnets.1/norm1_2/Mul_output_0, %onnx::Add_10696), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1_2/Sigmoid_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.1_2/Sigmoid"](%/up_blocks.1/resnets.1/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1_2/Mul_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1_2/Mul"](%/up_blocks.1/resnets.1/norm1_2/Add_output_0, %/up_blocks.1/resnets.1_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1/conv1_2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.1/conv1_2/Conv"](%/up_blocks.1/resnets.1_2/Mul_output_0, %up_blocks.1.resnets.1.conv1.weight, %up_blocks.1.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.1/time_layer_2/Gemm_output_0 : Float(1, 64, strides=[64, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.1/resnets.1/time_layer_2/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %up_blocks.1.resnets.1.time_layer.weight, %up_blocks.1.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/resnets.1_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Unsqueeze_output_0 : Float(1, 64, 1, strides=[64, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.1_2/Unsqueeze"](%/up_blocks.1/resnets.1/time_layer_2/Gemm_output_0, %/up_blocks.1/resnets.1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Unsqueeze_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.1_2/Unsqueeze_1"](%/up_blocks.1/resnets.1_2/Unsqueeze_output_0, %/up_blocks.1/resnets.1_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.1_2/Shape"](%/up_blocks.1/resnets.1_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/resnets.1_2/Gather"](%/up_blocks.1/resnets.1_2/Shape_output_0, %/up_blocks.1/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/resnets.1_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/resnets.1_2/Add"](%/up_blocks.1/resnets.1_2/Gather_output_0, %/up_blocks.1/resnets.1_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.1_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/resnets.1_2/Div"](%/up_blocks.1/resnets.1_2/Add_output_0, %/up_blocks.1/resnets.1_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1_2/Mul_1"](%/up_blocks.1/resnets.1_2/Div_output_0, %/up_blocks.1/resnets.1_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Slice_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.1_2/Slice"](%/up_blocks.1/resnets.1_2/Unsqueeze_1_output_0, %/up_blocks.1/resnets.1_2/Constant_3_output_0, %/up_blocks.1/resnets.1_2/Mul_1_output_0, %/up_blocks.1/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.1_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1_2/Mul_2"](%/up_blocks.1/resnets.1_2/Div_output_0, %/up_blocks.1/resnets.1_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1_2/Slice_1_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.1_2/Slice_1"](%/up_blocks.1/resnets.1_2/Unsqueeze_1_output_0, %/up_blocks.1/resnets.1_2/Mul_1_output_0, %/up_blocks.1/resnets.1_2/Mul_2_output_0, %/up_blocks.1/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.1/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.1/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_2/Reshape_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm2_2/Reshape"](%/up_blocks.1/resnets.1/conv1_2/Conv_output_0, %/up_blocks.1/resnets.1/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.1/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.1/norm2_2/InstanceNormalization"](%/up_blocks.1/resnets.1/norm2_2/Reshape_output_0, %/up_blocks.1/resnets.1/norm2_2/Constant_1_output_0, %/up_blocks.1/resnets.1/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.1/norm2_2/Shape"](%/up_blocks.1/resnets.1/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_2/Reshape_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.1/norm2_2/Reshape_1"](%/up_blocks.1/resnets.1/norm2_2/InstanceNormalization_output_0, %/up_blocks.1/resnets.1/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_2/Mul_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1/norm2_2/Mul"](%/up_blocks.1/resnets.1/norm2_2/Reshape_1_output_0, %onnx::Mul_10697), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1/norm2_2/Add_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1/norm2_2/Add"](%/up_blocks.1/resnets.1/norm2_2/Mul_output_0, %onnx::Add_10698), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.1_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.1_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1_2/Add_1_output_0 : Float(1, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1_2/Add_1"](%/up_blocks.1/resnets.1_2/Slice_output_0, %/up_blocks.1/resnets.1_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1_2/Mul_3_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1_2/Mul_3"](%/up_blocks.1/resnets.1/norm2_2/Add_output_0, %/up_blocks.1/resnets.1_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1_2/Add_2_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1_2/Add_2"](%/up_blocks.1/resnets.1_2/Mul_3_output_0, %/up_blocks.1/resnets.1_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.1_2/Sigmoid_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.1_2/Sigmoid_1"](%/up_blocks.1/resnets.1_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1_2/Mul_4_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.1_2/Mul_4"](%/up_blocks.1/resnets.1_2/Add_2_output_0, %/up_blocks.1/resnets.1_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.1/conv2_2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.1/conv2_2/Conv"](%/up_blocks.1/resnets.1_2/Mul_4_output_0, %up_blocks.1.resnets.1.conv2.weight, %up_blocks.1.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.1/conv3_2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/resnets.1/conv3_2/Conv"](%/up_blocks.1_2/Concat_1_output_0, %up_blocks.1.resnets.1.conv3.weight, %up_blocks.1.resnets.1.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.1_2/Add_3_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.1_2/Add_3"](%/up_blocks.1/resnets.1/conv2_2/Conv_output_0, %/up_blocks.1/resnets.1/conv3_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.1_2/Concat_2_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.1_2/Concat_2"](%/up_blocks.1/resnets.1_2/Add_3_output_0, %/down_blocks.0/resample/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.1/resnets.2/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.2/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_2/Reshape_output_0 : Float(1, 32, 4096, strides=[131072, 4096, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm1_2/Reshape"](%/up_blocks.1_2/Concat_2_output_0, %/up_blocks.1/resnets.2/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 4096, strides=[131072, 4096, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.2/norm1_2/InstanceNormalization"](%/up_blocks.1/resnets.2/norm1_2/Reshape_output_0, %/up_blocks.1/resnets.2/norm1_2/Constant_1_output_0, %/up_blocks.1/resnets.2/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.2/norm1_2/Shape"](%/up_blocks.1_2/Concat_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_2/Reshape_1_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm1_2/Reshape_1"](%/up_blocks.1/resnets.2/norm1_2/InstanceNormalization_output_0, %/up_blocks.1/resnets.2/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_2/Mul_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/norm1_2/Mul"](%/up_blocks.1/resnets.2/norm1_2/Reshape_1_output_0, %onnx::Mul_10699), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm1_2/Add_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2/norm1_2/Add"](%/up_blocks.1/resnets.2/norm1_2/Mul_output_0, %onnx::Add_10700), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2_2/Sigmoid_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.2_2/Sigmoid"](%/up_blocks.1/resnets.2/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2_2/Mul_output_0 : Float(1, 64, 64, 32, strides=[131072, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2_2/Mul"](%/up_blocks.1/resnets.2/norm1_2/Add_output_0, %/up_blocks.1/resnets.2_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2/conv1_2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.2/conv1_2/Conv"](%/up_blocks.1/resnets.2_2/Mul_output_0, %up_blocks.1.resnets.2.conv1.weight, %up_blocks.1.resnets.2.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.2/time_layer_2/Gemm_output_0 : Float(1, 64, strides=[64, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.1/resnets.2/time_layer_2/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %up_blocks.1.resnets.2.time_layer.weight, %up_blocks.1.resnets.2.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.1/resnets.2_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Unsqueeze_output_0 : Float(1, 64, 1, strides=[64, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.2_2/Unsqueeze"](%/up_blocks.1/resnets.2/time_layer_2/Gemm_output_0, %/up_blocks.1/resnets.2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.1/resnets.2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Unsqueeze_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.1/resnets.2_2/Unsqueeze_1"](%/up_blocks.1/resnets.2_2/Unsqueeze_output_0, %/up_blocks.1/resnets.2_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.2_2/Shape"](%/up_blocks.1/resnets.2_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.1/resnets.2_2/Gather"](%/up_blocks.1/resnets.2_2/Shape_output_0, %/up_blocks.1/resnets.2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.1/resnets.2_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.1/resnets.2_2/Add"](%/up_blocks.1/resnets.2_2/Gather_output_0, %/up_blocks.1/resnets.2_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.2_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.1/resnets.2_2/Div"](%/up_blocks.1/resnets.2_2/Add_output_0, %/up_blocks.1/resnets.2_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2_2/Mul_1"](%/up_blocks.1/resnets.2_2/Div_output_0, %/up_blocks.1/resnets.2_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Slice_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.2_2/Slice"](%/up_blocks.1/resnets.2_2/Unsqueeze_1_output_0, %/up_blocks.1/resnets.2_2/Constant_3_output_0, %/up_blocks.1/resnets.2_2/Mul_1_output_0, %/up_blocks.1/resnets.2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.1/resnets.2_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2_2/Mul_2"](%/up_blocks.1/resnets.2_2/Div_output_0, %/up_blocks.1/resnets.2_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2_2/Slice_1_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.1/resnets.2_2/Slice_1"](%/up_blocks.1/resnets.2_2/Unsqueeze_1_output_0, %/up_blocks.1/resnets.2_2/Mul_1_output_0, %/up_blocks.1/resnets.2_2/Mul_2_output_0, %/up_blocks.1/resnets.2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.1/resnets.2/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.1/resnets.2/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_2/Reshape_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm2_2/Reshape"](%/up_blocks.1/resnets.2/conv1_2/Conv_output_0, %/up_blocks.1/resnets.2/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.1/resnets.2/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 2048, strides=[65536, 2048, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.1/resnets.2/norm2_2/InstanceNormalization"](%/up_blocks.1/resnets.2/norm2_2/Reshape_output_0, %/up_blocks.1/resnets.2/norm2_2/Constant_1_output_0, %/up_blocks.1/resnets.2/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.1/resnets.2/norm2_2/Shape"](%/up_blocks.1/resnets.2/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_2/Reshape_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.1/resnets.2/norm2_2/Reshape_1"](%/up_blocks.1/resnets.2/norm2_2/InstanceNormalization_output_0, %/up_blocks.1/resnets.2/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_2/Mul_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2/norm2_2/Mul"](%/up_blocks.1/resnets.2/norm2_2/Reshape_1_output_0, %onnx::Mul_10701), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2/norm2_2/Add_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2/norm2_2/Add"](%/up_blocks.1/resnets.2/norm2_2/Mul_output_0, %onnx::Add_10702), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.1/resnets.2_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.1/resnets.2_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2_2/Add_1_output_0 : Float(1, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2_2/Add_1"](%/up_blocks.1/resnets.2_2/Slice_output_0, %/up_blocks.1/resnets.2_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2_2/Mul_3_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2_2/Mul_3"](%/up_blocks.1/resnets.2/norm2_2/Add_output_0, %/up_blocks.1/resnets.2_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2_2/Add_2_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2_2/Add_2"](%/up_blocks.1/resnets.2_2/Mul_3_output_0, %/up_blocks.1/resnets.2_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.1/resnets.2_2/Sigmoid_1_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.1/resnets.2_2/Sigmoid_1"](%/up_blocks.1/resnets.2_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2_2/Mul_4_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.1/resnets.2_2/Mul_4"](%/up_blocks.1/resnets.2_2/Add_2_output_0, %/up_blocks.1/resnets.2_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.1/resnets.2/conv2_2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resnets.2/conv2_2/Conv"](%/up_blocks.1/resnets.2_2/Mul_4_output_0, %up_blocks.1.resnets.2.conv2.weight, %up_blocks.1.resnets.2.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.2/conv3_2/Conv_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.1/resnets.2/conv3_2/Conv"](%/up_blocks.1_2/Concat_2_output_0, %up_blocks.1.resnets.2.conv3.weight, %up_blocks.1.resnets.2.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.1/resnets.2_2/Add_3_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.1/resnets.2_2/Add_3"](%/up_blocks.1/resnets.2/conv2_2/Conv_output_0, %/up_blocks.1/resnets.2/conv3_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.1_2/Cast_output_0 : Float(1, 32, 64, 32, strides=[65536, 2048, 32, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1_2/Cast"](%/up_blocks.1/resnets.2_2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.1_2/Constant_output_0 : Float(4, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value= 1  1  2  2 [ CPUFloatType{4} ], onnx_name="/up_blocks.1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %onnx::Resize_9022 : Tensor? = prim::Constant(), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.1_2/Resize_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Resize[coordinate_transformation_mode="asymmetric", cubic_coeff_a=-0.75, mode="nearest", nearest_mode="floor", onnx_name="/up_blocks.1_2/Resize"](%/up_blocks.1_2/Cast_output_0, %onnx::Resize_9022, %/up_blocks.1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:4028:0
  %/up_blocks.1_2/Cast_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Cast[to=1, onnx_name="/up_blocks.1_2/Cast_1"](%/up_blocks.1_2/Resize_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:670:0
  %/up_blocks.1/resample_2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.1/resample_2/Conv"](%/up_blocks.1_2/Cast_1_output_0, %up_blocks.1.resample.weight, %up_blocks.1.resample.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.1/torch.nn.modules.conv.Conv2d::resample # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2_2/Concat_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.2_2/Concat"](%/up_blocks.1/resample_2/Conv_output_0, %/down_blocks.0/resnets.1/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.2/resnets.0/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.0/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_2/Reshape_output_0 : Float(1, 32, 16384, strides=[524288, 16384, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm1_2/Reshape"](%/up_blocks.2_2/Concat_output_0, %/up_blocks.2/resnets.0/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 16384, strides=[524288, 16384, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.0/norm1_2/InstanceNormalization"](%/up_blocks.2/resnets.0/norm1_2/Reshape_output_0, %/up_blocks.2/resnets.0/norm1_2/Constant_1_output_0, %/up_blocks.2/resnets.0/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.0/norm1_2/Shape"](%/up_blocks.2_2/Concat_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_2/Reshape_1_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm1_2/Reshape_1"](%/up_blocks.2/resnets.0/norm1_2/InstanceNormalization_output_0, %/up_blocks.2/resnets.0/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_2/Mul_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/norm1_2/Mul"](%/up_blocks.2/resnets.0/norm1_2/Reshape_1_output_0, %onnx::Mul_10704), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm1_2/Add_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0/norm1_2/Add"](%/up_blocks.2/resnets.0/norm1_2/Mul_output_0, %onnx::Add_10705), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0_2/Sigmoid_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.0_2/Sigmoid"](%/up_blocks.2/resnets.0/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0_2/Mul_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0_2/Mul"](%/up_blocks.2/resnets.0/norm1_2/Add_output_0, %/up_blocks.2/resnets.0_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0/conv1_2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.0/conv1_2/Conv"](%/up_blocks.2/resnets.0_2/Mul_output_0, %up_blocks.2.resnets.0.conv1.weight, %up_blocks.2.resnets.0.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.0/time_layer_2/Gemm_output_0 : Float(1, 64, strides=[64, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.2/resnets.0/time_layer_2/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %up_blocks.2.resnets.0.time_layer.weight, %up_blocks.2.resnets.0.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.2/resnets.0_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.0_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Unsqueeze_output_0 : Float(1, 64, 1, strides=[64, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.0_2/Unsqueeze"](%/up_blocks.2/resnets.0/time_layer_2/Gemm_output_0, %/up_blocks.2/resnets.0_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.0_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Unsqueeze_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.0_2/Unsqueeze_1"](%/up_blocks.2/resnets.0_2/Unsqueeze_output_0, %/up_blocks.2/resnets.0_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.0_2/Shape"](%/up_blocks.2/resnets.0_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.2/resnets.0_2/Gather"](%/up_blocks.2/resnets.0_2/Shape_output_0, %/up_blocks.2/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.2/resnets.0_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.2/resnets.0_2/Add"](%/up_blocks.2/resnets.0_2/Gather_output_0, %/up_blocks.2/resnets.0_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.0_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.2/resnets.0_2/Div"](%/up_blocks.2/resnets.0_2/Add_output_0, %/up_blocks.2/resnets.0_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0_2/Mul_1"](%/up_blocks.2/resnets.0_2/Div_output_0, %/up_blocks.2/resnets.0_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Slice_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.0_2/Slice"](%/up_blocks.2/resnets.0_2/Unsqueeze_1_output_0, %/up_blocks.2/resnets.0_2/Constant_3_output_0, %/up_blocks.2/resnets.0_2/Mul_1_output_0, %/up_blocks.2/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.0_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0_2/Mul_2"](%/up_blocks.2/resnets.0_2/Div_output_0, %/up_blocks.2/resnets.0_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0_2/Slice_1_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.0_2/Slice_1"](%/up_blocks.2/resnets.0_2/Unsqueeze_1_output_0, %/up_blocks.2/resnets.0_2/Mul_1_output_0, %/up_blocks.2/resnets.0_2/Mul_2_output_0, %/up_blocks.2/resnets.0_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.0/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.0/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_2/Reshape_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm2_2/Reshape"](%/up_blocks.2/resnets.0/conv1_2/Conv_output_0, %/up_blocks.2/resnets.0/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.0/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.0/norm2_2/InstanceNormalization"](%/up_blocks.2/resnets.0/norm2_2/Reshape_output_0, %/up_blocks.2/resnets.0/norm2_2/Constant_1_output_0, %/up_blocks.2/resnets.0/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.0/norm2_2/Shape"](%/up_blocks.2/resnets.0/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_2/Reshape_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.0/norm2_2/Reshape_1"](%/up_blocks.2/resnets.0/norm2_2/InstanceNormalization_output_0, %/up_blocks.2/resnets.0/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_2/Mul_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0/norm2_2/Mul"](%/up_blocks.2/resnets.0/norm2_2/Reshape_1_output_0, %onnx::Mul_10706), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0/norm2_2/Add_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0/norm2_2/Add"](%/up_blocks.2/resnets.0/norm2_2/Mul_output_0, %onnx::Add_10707), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.0_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.0_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0_2/Add_1_output_0 : Float(1, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0_2/Add_1"](%/up_blocks.2/resnets.0_2/Slice_output_0, %/up_blocks.2/resnets.0_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0_2/Mul_3_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0_2/Mul_3"](%/up_blocks.2/resnets.0/norm2_2/Add_output_0, %/up_blocks.2/resnets.0_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0_2/Add_2_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0_2/Add_2"](%/up_blocks.2/resnets.0_2/Mul_3_output_0, %/up_blocks.2/resnets.0_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.0_2/Sigmoid_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.0_2/Sigmoid_1"](%/up_blocks.2/resnets.0_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0_2/Mul_4_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.0_2/Mul_4"](%/up_blocks.2/resnets.0_2/Add_2_output_0, %/up_blocks.2/resnets.0_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.0/conv2_2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.0/conv2_2/Conv"](%/up_blocks.2/resnets.0_2/Mul_4_output_0, %up_blocks.2.resnets.0.conv2.weight, %up_blocks.2.resnets.0.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.0/conv3_2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.2/resnets.0/conv3_2/Conv"](%/up_blocks.2_2/Concat_output_0, %up_blocks.2.resnets.0.conv3.weight, %up_blocks.2.resnets.0.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.0_2/Add_3_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.0_2/Add_3"](%/up_blocks.2/resnets.0/conv2_2/Conv_output_0, %/up_blocks.2/resnets.0/conv3_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.0 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.2_2/Concat_1_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.2_2/Concat_1"](%/up_blocks.2/resnets.0_2/Add_3_output_0, %/down_blocks.0/resnets.0/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.2/resnets.1/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.1/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_2/Reshape_output_0 : Float(1, 32, 16384, strides=[524288, 16384, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm1_2/Reshape"](%/up_blocks.2_2/Concat_1_output_0, %/up_blocks.2/resnets.1/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 16384, strides=[524288, 16384, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.1/norm1_2/InstanceNormalization"](%/up_blocks.2/resnets.1/norm1_2/Reshape_output_0, %/up_blocks.2/resnets.1/norm1_2/Constant_1_output_0, %/up_blocks.2/resnets.1/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.1/norm1_2/Shape"](%/up_blocks.2_2/Concat_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_2/Reshape_1_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm1_2/Reshape_1"](%/up_blocks.2/resnets.1/norm1_2/InstanceNormalization_output_0, %/up_blocks.2/resnets.1/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_2/Mul_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/norm1_2/Mul"](%/up_blocks.2/resnets.1/norm1_2/Reshape_1_output_0, %onnx::Mul_10708), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm1_2/Add_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1/norm1_2/Add"](%/up_blocks.2/resnets.1/norm1_2/Mul_output_0, %onnx::Add_10709), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1_2/Sigmoid_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.1_2/Sigmoid"](%/up_blocks.2/resnets.1/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1_2/Mul_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1_2/Mul"](%/up_blocks.2/resnets.1/norm1_2/Add_output_0, %/up_blocks.2/resnets.1_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1/conv1_2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.1/conv1_2/Conv"](%/up_blocks.2/resnets.1_2/Mul_output_0, %up_blocks.2.resnets.1.conv1.weight, %up_blocks.2.resnets.1.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.1/time_layer_2/Gemm_output_0 : Float(1, 64, strides=[64, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.2/resnets.1/time_layer_2/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %up_blocks.2.resnets.1.time_layer.weight, %up_blocks.2.resnets.1.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.2/resnets.1_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Unsqueeze_output_0 : Float(1, 64, 1, strides=[64, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.1_2/Unsqueeze"](%/up_blocks.2/resnets.1/time_layer_2/Gemm_output_0, %/up_blocks.2/resnets.1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Unsqueeze_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.1_2/Unsqueeze_1"](%/up_blocks.2/resnets.1_2/Unsqueeze_output_0, %/up_blocks.2/resnets.1_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.1_2/Shape"](%/up_blocks.2/resnets.1_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.2/resnets.1_2/Gather"](%/up_blocks.2/resnets.1_2/Shape_output_0, %/up_blocks.2/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.2/resnets.1_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.2/resnets.1_2/Add"](%/up_blocks.2/resnets.1_2/Gather_output_0, %/up_blocks.2/resnets.1_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.1_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.2/resnets.1_2/Div"](%/up_blocks.2/resnets.1_2/Add_output_0, %/up_blocks.2/resnets.1_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1_2/Mul_1"](%/up_blocks.2/resnets.1_2/Div_output_0, %/up_blocks.2/resnets.1_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Slice_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.1_2/Slice"](%/up_blocks.2/resnets.1_2/Unsqueeze_1_output_0, %/up_blocks.2/resnets.1_2/Constant_3_output_0, %/up_blocks.2/resnets.1_2/Mul_1_output_0, %/up_blocks.2/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.1_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1_2/Mul_2"](%/up_blocks.2/resnets.1_2/Div_output_0, %/up_blocks.2/resnets.1_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1_2/Slice_1_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.1_2/Slice_1"](%/up_blocks.2/resnets.1_2/Unsqueeze_1_output_0, %/up_blocks.2/resnets.1_2/Mul_1_output_0, %/up_blocks.2/resnets.1_2/Mul_2_output_0, %/up_blocks.2/resnets.1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.1/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.1/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_2/Reshape_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm2_2/Reshape"](%/up_blocks.2/resnets.1/conv1_2/Conv_output_0, %/up_blocks.2/resnets.1/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.1/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.1/norm2_2/InstanceNormalization"](%/up_blocks.2/resnets.1/norm2_2/Reshape_output_0, %/up_blocks.2/resnets.1/norm2_2/Constant_1_output_0, %/up_blocks.2/resnets.1/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.1/norm2_2/Shape"](%/up_blocks.2/resnets.1/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_2/Reshape_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.1/norm2_2/Reshape_1"](%/up_blocks.2/resnets.1/norm2_2/InstanceNormalization_output_0, %/up_blocks.2/resnets.1/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_2/Mul_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1/norm2_2/Mul"](%/up_blocks.2/resnets.1/norm2_2/Reshape_1_output_0, %onnx::Mul_10710), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1/norm2_2/Add_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1/norm2_2/Add"](%/up_blocks.2/resnets.1/norm2_2/Mul_output_0, %onnx::Add_10711), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.1_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.1_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1_2/Add_1_output_0 : Float(1, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1_2/Add_1"](%/up_blocks.2/resnets.1_2/Slice_output_0, %/up_blocks.2/resnets.1_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1_2/Mul_3_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1_2/Mul_3"](%/up_blocks.2/resnets.1/norm2_2/Add_output_0, %/up_blocks.2/resnets.1_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1_2/Add_2_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1_2/Add_2"](%/up_blocks.2/resnets.1_2/Mul_3_output_0, %/up_blocks.2/resnets.1_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.1_2/Sigmoid_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.1_2/Sigmoid_1"](%/up_blocks.2/resnets.1_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1_2/Mul_4_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.1_2/Mul_4"](%/up_blocks.2/resnets.1_2/Add_2_output_0, %/up_blocks.2/resnets.1_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.1/conv2_2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.1/conv2_2/Conv"](%/up_blocks.2/resnets.1_2/Mul_4_output_0, %up_blocks.2.resnets.1.conv2.weight, %up_blocks.2.resnets.1.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.1/conv3_2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.2/resnets.1/conv3_2/Conv"](%/up_blocks.2_2/Concat_1_output_0, %up_blocks.2.resnets.1.conv3.weight, %up_blocks.2.resnets.1.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.1_2/Add_3_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.1_2/Add_3"](%/up_blocks.2/resnets.1/conv2_2/Conv_output_0, %/up_blocks.2/resnets.1/conv3_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.1 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/up_blocks.2_2/Concat_2_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Concat[axis=1, onnx_name="/up_blocks.2_2/Concat_2"](%/up_blocks.2/resnets.1_2/Add_3_output_0, %/conv_in/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:639:0
  %/up_blocks.2/resnets.2/norm1_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.2/norm1_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_2/Reshape_output_0 : Float(1, 32, 16384, strides=[524288, 16384, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm1_2/Reshape"](%/up_blocks.2_2/Concat_2_output_0, %/up_blocks.2/resnets.2/norm1_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm1_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm1_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_2/InstanceNormalization_output_0 : Float(1, 32, 16384, strides=[524288, 16384, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.2/norm1_2/InstanceNormalization"](%/up_blocks.2/resnets.2/norm1_2/Reshape_output_0, %/up_blocks.2/resnets.2/norm1_2/Constant_1_output_0, %/up_blocks.2/resnets.2/norm1_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.2/norm1_2/Shape"](%/up_blocks.2_2/Concat_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_2/Reshape_1_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm1_2/Reshape_1"](%/up_blocks.2/resnets.2/norm1_2/InstanceNormalization_output_0, %/up_blocks.2/resnets.2/norm1_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_2/Mul_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/norm1_2/Mul"](%/up_blocks.2/resnets.2/norm1_2/Reshape_1_output_0, %onnx::Mul_10712), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm1_2/Add_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2/norm1_2/Add"](%/up_blocks.2/resnets.2/norm1_2/Mul_output_0, %onnx::Add_10713), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2_2/Sigmoid_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.2_2/Sigmoid"](%/up_blocks.2/resnets.2/norm1_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2_2/Mul_output_0 : Float(1, 64, 128, 64, strides=[524288, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2_2/Mul"](%/up_blocks.2/resnets.2/norm1_2/Add_output_0, %/up_blocks.2/resnets.2_2/Sigmoid_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2/conv1_2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.2/conv1_2/Conv"](%/up_blocks.2/resnets.2_2/Mul_output_0, %up_blocks.2.resnets.2.conv1.weight, %up_blocks.2.resnets.2.conv1.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv1 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.2/time_layer_2/Gemm_output_0 : Float(1, 64, strides=[64, 1], requires_grad=0, device=cuda:0) = onnx::Gemm[alpha=1., beta=1., transB=1, onnx_name="/up_blocks.2/resnets.2/time_layer_2/Gemm"](%/down_blocks.0/resnets.0/Mul_1_output_0, %up_blocks.2.resnets.2.time_layer.weight, %up_blocks.2.resnets.2.time_layer.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.linear.Linear::time_layer # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/linear.py:116:0
  %/up_blocks.2/resnets.2_2/Constant_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Unsqueeze_output_0 : Float(1, 64, 1, strides=[64, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.2_2/Unsqueeze"](%/up_blocks.2/resnets.2/time_layer_2/Gemm_output_0, %/up_blocks.2/resnets.2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Constant_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name="/up_blocks.2/resnets.2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Unsqueeze_1_output_0 : Float(1, 64, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Unsqueeze[onnx_name="/up_blocks.2/resnets.2_2/Unsqueeze_1"](%/up_blocks.2/resnets.2_2/Unsqueeze_output_0, %/up_blocks.2/resnets.2_2/Constant_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.2_2/Shape"](%/up_blocks.2/resnets.2_2/Unsqueeze_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Constant_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Gather_output_0 : Long(1, strides=[1], device=cpu) = onnx::Gather[axis=0, onnx_name="/up_blocks.2/resnets.2_2/Gather"](%/up_blocks.2/resnets.2_2/Shape_output_0, %/up_blocks.2/resnets.2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Constant_3_output_0 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name="/up_blocks.2/resnets.2_2/Constant_3"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Constant_4_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2_2/Constant_4"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Add_output_0 : Long(1, strides=[1], device=cpu) = onnx::Add[onnx_name="/up_blocks.2/resnets.2_2/Add"](%/up_blocks.2/resnets.2_2/Gather_output_0, %/up_blocks.2/resnets.2_2/Constant_4_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Constant_5_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.2_2/Constant_5"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Div_output_0 : Long(1, strides=[1], device=cpu) = onnx::Div[onnx_name="/up_blocks.2/resnets.2_2/Div"](%/up_blocks.2/resnets.2_2/Add_output_0, %/up_blocks.2/resnets.2_2/Constant_5_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Constant_6_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2_2/Constant_6"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Mul_1_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2_2/Mul_1"](%/up_blocks.2/resnets.2_2/Div_output_0, %/up_blocks.2/resnets.2_2/Constant_6_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Slice_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.2_2/Slice"](%/up_blocks.2/resnets.2_2/Unsqueeze_1_output_0, %/up_blocks.2/resnets.2_2/Constant_3_output_0, %/up_blocks.2/resnets.2_2/Mul_1_output_0, %/up_blocks.2/resnets.2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Constant_7_output_0 : Long(1, strides=[1], requires_grad=0, device=cpu) = onnx::Constant[value={2}, onnx_name="/up_blocks.2/resnets.2_2/Constant_7"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Mul_2_output_0 : Long(1, strides=[1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2_2/Mul_2"](%/up_blocks.2/resnets.2_2/Div_output_0, %/up_blocks.2/resnets.2_2/Constant_7_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2_2/Slice_1_output_0 : Float(1, 32, 1, 1, strides=[64, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Slice[onnx_name="/up_blocks.2/resnets.2_2/Slice_1"](%/up_blocks.2/resnets.2_2/Unsqueeze_1_output_0, %/up_blocks.2/resnets.2_2/Mul_1_output_0, %/up_blocks.2/resnets.2_2/Mul_2_output_0, %/up_blocks.2/resnets.2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:229:0
  %/up_blocks.2/resnets.2/norm2_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/up_blocks.2/resnets.2/norm2_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_2/Reshape_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm2_2/Reshape"](%/up_blocks.2/resnets.2/conv1_2/Conv_output_0, %/up_blocks.2/resnets.2/norm2_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm2_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/up_blocks.2/resnets.2/norm2_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_2/InstanceNormalization_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/up_blocks.2/resnets.2/norm2_2/InstanceNormalization"](%/up_blocks.2/resnets.2/norm2_2/Reshape_output_0, %/up_blocks.2/resnets.2/norm2_2/Constant_1_output_0, %/up_blocks.2/resnets.2/norm2_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/up_blocks.2/resnets.2/norm2_2/Shape"](%/up_blocks.2/resnets.2/conv1_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_2/Reshape_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/up_blocks.2/resnets.2/norm2_2/Reshape_1"](%/up_blocks.2/resnets.2/norm2_2/InstanceNormalization_output_0, %/up_blocks.2/resnets.2/norm2_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_2/Mul_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2/norm2_2/Mul"](%/up_blocks.2/resnets.2/norm2_2/Reshape_1_output_0, %onnx::Mul_10714), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2/norm2_2/Add_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2/norm2_2/Add"](%/up_blocks.2/resnets.2/norm2_2/Mul_output_0, %onnx::Add_10715), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.normalization.GroupNorm::norm2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/up_blocks.2/resnets.2_2/Constant_8_output_0 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={1}, onnx_name="/up_blocks.2/resnets.2_2/Constant_8"](), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2_2/Add_1_output_0 : Float(1, 32, 1, 1, strides=[32, 1, 1, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2_2/Add_1"](%/up_blocks.2/resnets.2_2/Slice_output_0, %/up_blocks.2/resnets.2_2/Constant_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2_2/Mul_3_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2_2/Mul_3"](%/up_blocks.2/resnets.2/norm2_2/Add_output_0, %/up_blocks.2/resnets.2_2/Add_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2_2/Add_2_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2_2/Add_2"](%/up_blocks.2/resnets.2_2/Mul_3_output_0, %/up_blocks.2/resnets.2_2/Slice_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:244:0
  %/up_blocks.2/resnets.2_2/Sigmoid_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/up_blocks.2/resnets.2_2/Sigmoid_1"](%/up_blocks.2/resnets.2_2/Add_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2_2/Mul_4_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/up_blocks.2/resnets.2_2/Mul_4"](%/up_blocks.2/resnets.2_2/Add_2_output_0, %/up_blocks.2/resnets.2_2/Sigmoid_1_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/up_blocks.2/resnets.2/conv2_2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/up_blocks.2/resnets.2/conv2_2/Conv"](%/up_blocks.2/resnets.2_2/Mul_4_output_0, %up_blocks.2.resnets.2.conv2.weight, %up_blocks.2.resnets.2.conv2.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv2 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.2/conv3_2/Conv_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[1, 1], pads=[0, 0, 0, 0], strides=[1, 1], onnx_name="/up_blocks.2/resnets.2/conv3_2/Conv"](%/up_blocks.2_2/Concat_2_output_0, %up_blocks.2.resnets.2.conv3.weight, %up_blocks.2.resnets.2.conv3.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2/torch.nn.modules.conv.Conv2d::conv3 # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  %/up_blocks.2/resnets.2_2/Add_3_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/up_blocks.2/resnets.2_2/Add_3"](%/up_blocks.2/resnets.2/conv2_2/Conv_output_0, %/up_blocks.2/resnets.2/conv3_2/Conv_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/ml_mdm.models.unet.ResNetBlock::up_blocks.2/ml_mdm.models.unet.ResNet::resnets.2 # /data/juicefs_sharing_data/public_data/11065391/work/temp/reflection-removal/ml_mdm/models/unet.py:254:0
  %/norm_out_2/Constant_output_0 : Long(3, strides=[1], device=cpu) = onnx::Constant[value=  0  32  -1 [ CPULongType{3} ], onnx_name="/norm_out_2/Constant"](), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_2/Reshape_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/norm_out_2/Reshape"](%/up_blocks.2/resnets.2_2/Add_3_output_0, %/norm_out_2/Constant_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_2/Constant_1_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/norm_out_2/Constant_1"](), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_2/Constant_2_output_0 : Float(32, strides=[1], device=cpu) = onnx::Constant[value=<Tensor>, onnx_name="/norm_out_2/Constant_2"](), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_2/InstanceNormalization_output_0 : Float(1, 32, 8192, strides=[262144, 8192, 1], device=cpu) = onnx::InstanceNormalization[epsilon=1.0000000000000001e-05, onnx_name="/norm_out_2/InstanceNormalization"](%/norm_out_2/Reshape_output_0, %/norm_out_2/Constant_1_output_0, %/norm_out_2/Constant_2_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_2/Shape_output_0 : Long(4, strides=[1], device=cpu) = onnx::Shape[onnx_name="/norm_out_2/Shape"](%/up_blocks.2/resnets.2_2/Add_3_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_2/Reshape_1_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Reshape[allowzero=0, onnx_name="/norm_out_2/Reshape_1"](%/norm_out_2/InstanceNormalization_output_0, %/norm_out_2/Shape_output_0), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_2/Mul_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Mul[onnx_name="/norm_out_2/Mul"](%/norm_out_2/Reshape_1_output_0, %onnx::Mul_10716), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/norm_out_2/Add_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Add[onnx_name="/norm_out_2/Add"](%/norm_out_2/Mul_output_0, %onnx::Add_10717), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.normalization.GroupNorm::norm_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2588:0
  %/Sigmoid_8_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], device=cpu) = onnx::Sigmoid[onnx_name="/Sigmoid_8"](%/norm_out_2/Add_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %/Mul_18_output_0 : Float(1, 32, 128, 64, strides=[262144, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Mul[onnx_name="/Mul_18"](%/norm_out_2/Add_output_0, %/Sigmoid_8_output_0), scope: ml_mdm.models.nested_unet.NestedUNet:: # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/functional.py:2102:0
  %ot_1 : Float(1, 3, 128, 64, strides=[24576, 8192, 64, 1], requires_grad=0, device=cuda:0) = onnx::Conv[dilations=[1, 1], group=1, kernel_shape=[3, 3], pads=[1, 1, 1, 1], strides=[1, 1], onnx_name="/conv_out_2/Conv"](%/Mul_18_output_0, %conv_out.weight, %conv_out.bias), scope: ml_mdm.models.nested_unet.NestedUNet::/torch.nn.modules.conv.Conv2d::conv_out # /opt/conda/envs/rfl_rm/lib/python3.10/site-packages/torch/nn/modules/conv.py:456:0
  return (%ot_1, %ot_2, %ot_3)
